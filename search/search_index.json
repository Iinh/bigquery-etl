{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"About BigQuery ETL is Mozilla's framework for creating derived datasets and UDFs in BigQuery. At present, this site contains documentation for the UDFs available in BigQuery. See mozfun for details.","title":"About"},{"location":"#about","text":"BigQuery ETL is Mozilla's framework for creating derived datasets and UDFs in BigQuery. At present, this site contains documentation for the UDFs available in BigQuery. See mozfun for details.","title":"About"},{"location":"moz-fx-data-marketing-prod/apple_app_store/","text":"metrics_by_campaign metrics_by_source metrics_by_web_referrer metrics_by_platform_version metrics_total metrics_by_app_referrer metrics_by_region metrics_by_platform metrics_by_storefront metrics_by_app_version","title":"apple_app_store"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_campaign","text":"","title":"metrics_by_campaign"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_source","text":"","title":"metrics_by_source"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_web_referrer","text":"","title":"metrics_by_web_referrer"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_platform_version","text":"","title":"metrics_by_platform_version"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_total","text":"","title":"metrics_total"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_app_referrer","text":"","title":"metrics_by_app_referrer"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_region","text":"","title":"metrics_by_region"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_platform","text":"","title":"metrics_by_platform"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_storefront","text":"","title":"metrics_by_storefront"},{"location":"moz-fx-data-marketing-prod/apple_app_store/#metrics_by_app_version","text":"","title":"metrics_by_app_version"},{"location":"moz-fx-data-marketing-prod/fetch/","text":"latest_metric View CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.latest_metric` AS SELECT int64_field_0 AS fetch_id, * EXCEPT (int64_field_0), FROM `moz-fx-data-marketing-prod.fetch.metric_*` WHERE _TABLE_SUFFIX = (SELECT MAX(_TABLE_SUFFIX) FROM `moz-fx-data-marketing-prod.fetch.metric_*`) latest_spending View CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.latest_spending` AS SELECT *, FROM `moz-fx-data-marketing-prod.fetch.latest_trafficking` LEFT JOIN `moz-fx-data-marketing-prod.fetch.latest_metric` USING (fetch_id, AdName) fetch_deduped View CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.fetch_deduped` AS WITH metrics_ingestion_date_per_ad AS ( SELECT _table_suffix AS ingestionDate, MAX(_table_suffix) OVER (PARTITION BY date, Adname) AS IngestionDateMax, *, FROM `moz-fx-data-marketing-prod.fetch.metric_*` ), latest_ingested_metrics AS ( SELECT *, FROM metrics_ingestion_date_per_ad WHERE ingestionDate = IngestionDateMax ) SELECT Created, AdName AS AdNameTrafficking, TrackingLink, Product, Campaign, Vendor, Country, OperatingSystem, Device, Channel, CreativeType, Targeting, Creative, CreativeSize, CreativeConcept, CreativeLanguage, TrafficType, Tracking, Goal, MediaType, Placement, SocialString, metric.*, FROM `moz-fx-data-marketing-prod.fetch.latest_trafficking` AS trafficking LEFT JOIN -- Join metric / spend data to campaign information data latest_ingested_metrics AS metric USING (AdName) spend_alignment_by_month_v1 Metadata Description : Compare spend data by month between summary tables and detailed tables Friendly name : Monthly Spend Alignment Schedule : weekly Owners : bewu@mozilla.com DAG name : bqetl_marketing_fetch latest_trafficking View CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.latest_trafficking` AS SELECT int64_field_0 AS fetch_id, * EXCEPT (int64_field_0), FROM `moz-fx-data-marketing-prod.fetch.trafficking_*` WHERE _TABLE_SUFFIX = (SELECT MAX(_TABLE_SUFFIX) FROM `moz-fx-data-marketing-prod.fetch.trafficking_*`) spend_alignment_by_campaign_v1 Metadata Description : Compare spend data by campaign between summary tables and detailed tables Friendly name : Campaign Spend Alignment Schedule : weekly Owners : bewu@mozilla.com DAG name : bqetl_marketing_fetch","title":"fetch"},{"location":"moz-fx-data-marketing-prod/fetch/#latest_metric","text":"","title":"latest_metric"},{"location":"moz-fx-data-marketing-prod/fetch/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.latest_metric` AS SELECT int64_field_0 AS fetch_id, * EXCEPT (int64_field_0), FROM `moz-fx-data-marketing-prod.fetch.metric_*` WHERE _TABLE_SUFFIX = (SELECT MAX(_TABLE_SUFFIX) FROM `moz-fx-data-marketing-prod.fetch.metric_*`)","title":"View"},{"location":"moz-fx-data-marketing-prod/fetch/#latest_spending","text":"","title":"latest_spending"},{"location":"moz-fx-data-marketing-prod/fetch/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.latest_spending` AS SELECT *, FROM `moz-fx-data-marketing-prod.fetch.latest_trafficking` LEFT JOIN `moz-fx-data-marketing-prod.fetch.latest_metric` USING (fetch_id, AdName)","title":"View"},{"location":"moz-fx-data-marketing-prod/fetch/#fetch_deduped","text":"","title":"fetch_deduped"},{"location":"moz-fx-data-marketing-prod/fetch/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.fetch_deduped` AS WITH metrics_ingestion_date_per_ad AS ( SELECT _table_suffix AS ingestionDate, MAX(_table_suffix) OVER (PARTITION BY date, Adname) AS IngestionDateMax, *, FROM `moz-fx-data-marketing-prod.fetch.metric_*` ), latest_ingested_metrics AS ( SELECT *, FROM metrics_ingestion_date_per_ad WHERE ingestionDate = IngestionDateMax ) SELECT Created, AdName AS AdNameTrafficking, TrackingLink, Product, Campaign, Vendor, Country, OperatingSystem, Device, Channel, CreativeType, Targeting, Creative, CreativeSize, CreativeConcept, CreativeLanguage, TrafficType, Tracking, Goal, MediaType, Placement, SocialString, metric.*, FROM `moz-fx-data-marketing-prod.fetch.latest_trafficking` AS trafficking LEFT JOIN -- Join metric / spend data to campaign information data latest_ingested_metrics AS metric USING (AdName)","title":"View"},{"location":"moz-fx-data-marketing-prod/fetch/#spend_alignment_by_month_v1","text":"","title":"spend_alignment_by_month_v1"},{"location":"moz-fx-data-marketing-prod/fetch/#metadata","text":"Description : Compare spend data by month between summary tables and detailed tables Friendly name : Monthly Spend Alignment Schedule : weekly Owners : bewu@mozilla.com DAG name : bqetl_marketing_fetch","title":"Metadata"},{"location":"moz-fx-data-marketing-prod/fetch/#latest_trafficking","text":"","title":"latest_trafficking"},{"location":"moz-fx-data-marketing-prod/fetch/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-marketing-prod.fetch.latest_trafficking` AS SELECT int64_field_0 AS fetch_id, * EXCEPT (int64_field_0), FROM `moz-fx-data-marketing-prod.fetch.trafficking_*` WHERE _TABLE_SUFFIX = (SELECT MAX(_TABLE_SUFFIX) FROM `moz-fx-data-marketing-prod.fetch.trafficking_*`)","title":"View"},{"location":"moz-fx-data-marketing-prod/fetch/#spend_alignment_by_campaign_v1","text":"","title":"spend_alignment_by_campaign_v1"},{"location":"moz-fx-data-marketing-prod/fetch/#metadata_1","text":"Description : Compare spend data by campaign between summary tables and detailed tables Friendly name : Campaign Spend Alignment Schedule : weekly Owners : bewu@mozilla.com DAG name : bqetl_marketing_fetch","title":"Metadata"},{"location":"moz-fx-data-shared-prod/account_ecosystem/","text":"aet_clients_daily Metadata Friendly name : AET Clients Daily Description : One row per user per service per day, showing metrics across services. The user_id and client_id are directly related to the ecosystem_user_id and ecosystem_client_id primitive identifiers for Account Ecosystem Telemetry, but are abstracted to prevent fingerprinting and to provide continuity across user password reset events. In this view, we are guaranteed that a logical user is represented by a consistent user_id over time. For rows representing client telemetry, this view looks up user_id at runtime based on client_id so that we can have user_id values present for any client that has ever logged in to FxA, even for older rows before the first login. View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.account_ecosystem.aet_clients_daily` AS WITH desktop AS ( SELECT submission_date, CAST(NULL AS string) AS canonical_id, ecosystem_client_id_hash, 'desktop' AS service, CAST(NULL AS int64) AS event_count, duration_sum, active_hours_sum, scalar_parent_browser_engagement_total_uri_count_sum, visited_5_uri, visited_10_uri, normalized_channel AS channel, normalized_os AS os, normalized_country_code AS country, FROM `moz-fx-data-shared-prod.account_ecosystem_derived.desktop_clients_daily_v1` ), fxa_logging AS ( SELECT submission_date, canonical_id, CAST(NULL AS string) AS ecosystem_client_id_hash, -- We likely want to replace oauth_client_id with a human-readable service name. FORMAT('fxa - %s', oauth_client_id) AS service, event_count, CAST(NULL AS INT64) AS duration_sum, CAST(NULL AS INT64) AS active_hours_sum, CAST(NULL AS INT64) AS scalar_parent_browser_engagement_total_uri_count_sum, CAST(NULL AS BOOLEAN) AS visited_5_uri, CAST(NULL AS BOOLEAN) AS visited_10_uri, CAST(NULL AS STRING) AS channel, CAST(NULL AS STRING) AS os, country_code AS country, FROM `moz-fx-data-shared-prod.account_ecosystem_derived.fxa_logging_users_daily_v1` ), unioned AS ( SELECT * FROM desktop UNION ALL SELECT * FROM fxa_logging ) SELECT coalesce(unioned.canonical_id, ecil.canonical_id) AS user_id, ecosystem_client_id_hash AS client_id, unioned.* EXCEPT (canonical_id, ecosystem_client_id_hash) FROM unioned LEFT JOIN `moz-fx-data-shared-prod.account_ecosystem_derived.ecosystem_client_id_lookup_v1` AS ecil USING (ecosystem_client_id_hash)","title":"account_ecosystem"},{"location":"moz-fx-data-shared-prod/account_ecosystem/#aet_clients_daily","text":"","title":"aet_clients_daily"},{"location":"moz-fx-data-shared-prod/account_ecosystem/#metadata","text":"Friendly name : AET Clients Daily Description : One row per user per service per day, showing metrics across services. The user_id and client_id are directly related to the ecosystem_user_id and ecosystem_client_id primitive identifiers for Account Ecosystem Telemetry, but are abstracted to prevent fingerprinting and to provide continuity across user password reset events. In this view, we are guaranteed that a logical user is represented by a consistent user_id over time. For rows representing client telemetry, this view looks up user_id at runtime based on client_id so that we can have user_id values present for any client that has ever logged in to FxA, even for older rows before the first login.","title":"Metadata"},{"location":"moz-fx-data-shared-prod/account_ecosystem/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.account_ecosystem.aet_clients_daily` AS WITH desktop AS ( SELECT submission_date, CAST(NULL AS string) AS canonical_id, ecosystem_client_id_hash, 'desktop' AS service, CAST(NULL AS int64) AS event_count, duration_sum, active_hours_sum, scalar_parent_browser_engagement_total_uri_count_sum, visited_5_uri, visited_10_uri, normalized_channel AS channel, normalized_os AS os, normalized_country_code AS country, FROM `moz-fx-data-shared-prod.account_ecosystem_derived.desktop_clients_daily_v1` ), fxa_logging AS ( SELECT submission_date, canonical_id, CAST(NULL AS string) AS ecosystem_client_id_hash, -- We likely want to replace oauth_client_id with a human-readable service name. FORMAT('fxa - %s', oauth_client_id) AS service, event_count, CAST(NULL AS INT64) AS duration_sum, CAST(NULL AS INT64) AS active_hours_sum, CAST(NULL AS INT64) AS scalar_parent_browser_engagement_total_uri_count_sum, CAST(NULL AS BOOLEAN) AS visited_5_uri, CAST(NULL AS BOOLEAN) AS visited_10_uri, CAST(NULL AS STRING) AS channel, CAST(NULL AS STRING) AS os, country_code AS country, FROM `moz-fx-data-shared-prod.account_ecosystem_derived.fxa_logging_users_daily_v1` ), unioned AS ( SELECT * FROM desktop UNION ALL SELECT * FROM fxa_logging ) SELECT coalesce(unioned.canonical_id, ecil.canonical_id) AS user_id, ecosystem_client_id_hash AS client_id, unioned.* EXCEPT (canonical_id, ecosystem_client_id_hash) FROM unioned LEFT JOIN `moz-fx-data-shared-prod.account_ecosystem_derived.ecosystem_client_id_lookup_v1` AS ecil USING (ecosystem_client_id_hash)","title":"View"},{"location":"moz-fx-data-shared-prod/account_ecosystem_restricted/","text":"ecosystem_client_id_deletion_v1 Metadata Friendly name : Ecosystem Client ID Deletion Description : Provides ecosystem_client_id values that have appeared in a deletion-request ping. Also includes the hashed version of the ID to enable deletion of rows in derived tables containing the hash. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_account_ecosystem","title":"account_ecosystem_restricted"},{"location":"moz-fx-data-shared-prod/account_ecosystem_restricted/#ecosystem_client_id_deletion_v1","text":"","title":"ecosystem_client_id_deletion_v1"},{"location":"moz-fx-data-shared-prod/account_ecosystem_restricted/#metadata","text":"Friendly name : Ecosystem Client ID Deletion Description : Provides ecosystem_client_id values that have appeared in a deletion-request ping. Also includes the hashed version of the ID to enable deletion of rows in derived tables containing the hash. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_account_ecosystem","title":"Metadata"},{"location":"moz-fx-data-shared-prod/activity_stream/","text":"impression_stats_by_experiment View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.activity_stream.impression_stats_by_experiment` AS SELECT tile_id, tile_id_types.type AS tile_type, stats.* EXCEPT (tile_id) FROM `moz-fx-data-shared-prod.activity_stream_bi.impression_stats_by_experiment_v1` AS stats LEFT JOIN `moz-fx-data-shared-prod.activity_stream.tile_id_types` AS tile_id_types USING (tile_id) tile_id_types View -- This is an authorized view that allows us to read specific data from -- a project owned by the Pocket team; if the definition here changes, -- it may need to be manually redeployed by Data Ops. CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.activity_stream.tile_id_types` AS SELECT * FROM `pocket-tiles.pocket_tiles_data.tile_id_types` impression_stats_flat View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.activity_stream.impression_stats_flat` AS SELECT tile_id, tile_id_types.type AS tile_type, stats.* EXCEPT (tile_id) FROM `moz-fx-data-shared-prod.activity_stream_bi.impression_stats_flat_v1` AS stats LEFT JOIN `moz-fx-data-shared-prod.activity_stream.tile_id_types` AS tile_id_types USING (tile_id)","title":"activity_stream"},{"location":"moz-fx-data-shared-prod/activity_stream/#impression_stats_by_experiment","text":"","title":"impression_stats_by_experiment"},{"location":"moz-fx-data-shared-prod/activity_stream/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.activity_stream.impression_stats_by_experiment` AS SELECT tile_id, tile_id_types.type AS tile_type, stats.* EXCEPT (tile_id) FROM `moz-fx-data-shared-prod.activity_stream_bi.impression_stats_by_experiment_v1` AS stats LEFT JOIN `moz-fx-data-shared-prod.activity_stream.tile_id_types` AS tile_id_types USING (tile_id)","title":"View"},{"location":"moz-fx-data-shared-prod/activity_stream/#tile_id_types","text":"","title":"tile_id_types"},{"location":"moz-fx-data-shared-prod/activity_stream/#view_1","text":"-- This is an authorized view that allows us to read specific data from -- a project owned by the Pocket team; if the definition here changes, -- it may need to be manually redeployed by Data Ops. CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.activity_stream.tile_id_types` AS SELECT * FROM `pocket-tiles.pocket_tiles_data.tile_id_types`","title":"View"},{"location":"moz-fx-data-shared-prod/activity_stream/#impression_stats_flat","text":"","title":"impression_stats_flat"},{"location":"moz-fx-data-shared-prod/activity_stream/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.activity_stream.impression_stats_flat` AS SELECT tile_id, tile_id_types.type AS tile_type, stats.* EXCEPT (tile_id) FROM `moz-fx-data-shared-prod.activity_stream_bi.impression_stats_flat_v1` AS stats LEFT JOIN `moz-fx-data-shared-prod.activity_stream.tile_id_types` AS tile_id_types USING (tile_id)","title":"View"},{"location":"moz-fx-data-shared-prod/activity_stream_bi/","text":"impression_stats_flat_v1 Metadata Friendly name : Impression Stats Flat Description : Unnested representation of tile impression statistics Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_activity_stream impression_stats_by_experiment_v1 Metadata Friendly name : Impression Stats By Experiment Description : Representation of tile impression statistics, clustered by experiment_id to allow efficient analysis of individual experiments Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_activity_stream","title":"activity_stream_bi"},{"location":"moz-fx-data-shared-prod/activity_stream_bi/#impression_stats_flat_v1","text":"","title":"impression_stats_flat_v1"},{"location":"moz-fx-data-shared-prod/activity_stream_bi/#metadata","text":"Friendly name : Impression Stats Flat Description : Unnested representation of tile impression statistics Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_activity_stream","title":"Metadata"},{"location":"moz-fx-data-shared-prod/activity_stream_bi/#impression_stats_by_experiment_v1","text":"","title":"impression_stats_by_experiment_v1"},{"location":"moz-fx-data-shared-prod/activity_stream_bi/#metadata_1","text":"Friendly name : Impression Stats By Experiment Description : Representation of tile impression statistics, clustered by experiment_id to allow efficient analysis of individual experiments Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_activity_stream","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_dev/","text":"amo_stats_dau View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_dev.amo_stats_dau` AS SELECT submission_date, addon_id, dau, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_addon_version) ) AS dau_by_addon_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_os) ) AS dau_by_app_os, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_version) ) AS dau_by_app_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_fenix_build) ) AS dau_by_fenix_build, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_country) ) AS dau_by_country, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_locale) ) AS dau_by_locale, FROM `moz-fx-data-shared-prod.amo_dev.amo_stats_dau_v2` amo_stats_dau_v2 Metadata Friendly name : AMO Stats DAU dev/stage Description : Reduced stats table for dev and stage versions of the AMO service. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats amo_stats_installs_v3 Metadata Friendly name : AMO Installs dev/stage Description : Reduced daily installs table for dev and stage versions of the AMO service. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats amo_stats_installs View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_dev.amo_stats_installs` AS SELECT submission_date, hashed_addon_id, total_downloads, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_campaign) ) AS downloads_per_campaign, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_content) ) AS downloads_per_content, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_source) ) AS downloads_per_source, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_medium) ) AS downloads_per_medium, FROM `moz-fx-data-shared-prod.amo_dev.amo_stats_installs_v3`","title":"amo_dev"},{"location":"moz-fx-data-shared-prod/amo_dev/#amo_stats_dau","text":"","title":"amo_stats_dau"},{"location":"moz-fx-data-shared-prod/amo_dev/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_dev.amo_stats_dau` AS SELECT submission_date, addon_id, dau, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_addon_version) ) AS dau_by_addon_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_os) ) AS dau_by_app_os, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_version) ) AS dau_by_app_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_fenix_build) ) AS dau_by_fenix_build, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_country) ) AS dau_by_country, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_locale) ) AS dau_by_locale, FROM `moz-fx-data-shared-prod.amo_dev.amo_stats_dau_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/amo_dev/#amo_stats_dau_v2","text":"","title":"amo_stats_dau_v2"},{"location":"moz-fx-data-shared-prod/amo_dev/#metadata","text":"Friendly name : AMO Stats DAU dev/stage Description : Reduced stats table for dev and stage versions of the AMO service. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_dev/#amo_stats_installs_v3","text":"","title":"amo_stats_installs_v3"},{"location":"moz-fx-data-shared-prod/amo_dev/#metadata_1","text":"Friendly name : AMO Installs dev/stage Description : Reduced daily installs table for dev and stage versions of the AMO service. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_dev/#amo_stats_installs","text":"","title":"amo_stats_installs"},{"location":"moz-fx-data-shared-prod/amo_dev/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_dev.amo_stats_installs` AS SELECT submission_date, hashed_addon_id, total_downloads, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_campaign) ) AS downloads_per_campaign, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_content) ) AS downloads_per_content, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_source) ) AS downloads_per_source, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_medium) ) AS downloads_per_medium, FROM `moz-fx-data-shared-prod.amo_dev.amo_stats_installs_v3`","title":"View"},{"location":"moz-fx-data-shared-prod/amo_prod/","text":"amo_stats_dau View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_prod.amo_stats_dau` AS SELECT submission_date, addon_id, dau, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_addon_version) ) AS dau_by_addon_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_os) ) AS dau_by_app_os, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_version) ) AS dau_by_app_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_fenix_build) ) AS dau_by_fenix_build, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_country) ) AS dau_by_country, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_locale) ) AS dau_by_locale, FROM `moz-fx-data-shared-prod.amo_prod.amo_stats_dau_v2` fenix_addons_by_client_v1 Metadata Friendly name : Fenix addons by client Description : Clients_daily-like table on top of the various Firefox for Android channels that records only the dimensions and addon info necessary to power the daily amo_stats_dau_v2 query. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats amo_stats_dau_v2 Metadata Friendly name : AMO Stats DAU Description : Daily user statistics to power addons.mozilla.org stats pages. See bug 1572873. Each row in this table represents a particular addon on a particular day and provides all the information needed to populate the various \"Daily Users\" plots for the AMO stats dashboard. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats desktop_addons_by_client_v1 Metadata Friendly name : Desktop addons by client Description : Clients_daily-like table that records only the dimensions and addon info necessary to power daily the amo_stats_dau_v2 query. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats amo_stats_installs_v3 Metadata Friendly name : AMO Stats DAU Description : Daily install statistics to power addons.mozilla.org stats pages. See bug 1654330. Note that this table uses a hashed_addon_id defined as TO_HEX(SHA256(addon_id)) because the underlying event pings have limitations on length of properties attached to events and addon_id values are sometimes too long. The AMO stats application looks up records in this table based on the hashed_addon_id. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats amo_stats_installs View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_prod.amo_stats_installs` AS SELECT submission_date, hashed_addon_id, total_downloads, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_campaign) ) AS downloads_per_campaign, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_content) ) AS downloads_per_content, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_source) ) AS downloads_per_source, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_medium) ) AS downloads_per_medium, FROM `moz-fx-data-shared-prod.amo_prod.amo_stats_installs_v3`","title":"amo_prod"},{"location":"moz-fx-data-shared-prod/amo_prod/#amo_stats_dau","text":"","title":"amo_stats_dau"},{"location":"moz-fx-data-shared-prod/amo_prod/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_prod.amo_stats_dau` AS SELECT submission_date, addon_id, dau, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_addon_version) ) AS dau_by_addon_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_os) ) AS dau_by_app_os, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_app_version) ) AS dau_by_app_version, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_fenix_build) ) AS dau_by_fenix_build, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_country) ) AS dau_by_country, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(dau_by_locale) ) AS dau_by_locale, FROM `moz-fx-data-shared-prod.amo_prod.amo_stats_dau_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/amo_prod/#fenix_addons_by_client_v1","text":"","title":"fenix_addons_by_client_v1"},{"location":"moz-fx-data-shared-prod/amo_prod/#metadata","text":"Friendly name : Fenix addons by client Description : Clients_daily-like table on top of the various Firefox for Android channels that records only the dimensions and addon info necessary to power the daily amo_stats_dau_v2 query. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_prod/#amo_stats_dau_v2","text":"","title":"amo_stats_dau_v2"},{"location":"moz-fx-data-shared-prod/amo_prod/#metadata_1","text":"Friendly name : AMO Stats DAU Description : Daily user statistics to power addons.mozilla.org stats pages. See bug 1572873. Each row in this table represents a particular addon on a particular day and provides all the information needed to populate the various \"Daily Users\" plots for the AMO stats dashboard. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_prod/#desktop_addons_by_client_v1","text":"","title":"desktop_addons_by_client_v1"},{"location":"moz-fx-data-shared-prod/amo_prod/#metadata_2","text":"Friendly name : Desktop addons by client Description : Clients_daily-like table that records only the dimensions and addon info necessary to power daily the amo_stats_dau_v2 query. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_prod/#amo_stats_installs_v3","text":"","title":"amo_stats_installs_v3"},{"location":"moz-fx-data-shared-prod/amo_prod/#metadata_3","text":"Friendly name : AMO Stats DAU Description : Daily install statistics to power addons.mozilla.org stats pages. See bug 1654330. Note that this table uses a hashed_addon_id defined as TO_HEX(SHA256(addon_id)) because the underlying event pings have limitations on length of properties attached to events and addon_id values are sometimes too long. The AMO stats application looks up records in this table based on the hashed_addon_id. Owners : jklukas@mozilla.com Schedule : daily DAG name : bqetl_amo_stats","title":"Metadata"},{"location":"moz-fx-data-shared-prod/amo_prod/#amo_stats_installs","text":"","title":"amo_stats_installs"},{"location":"moz-fx-data-shared-prod/amo_prod/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.amo_prod.amo_stats_installs` AS SELECT submission_date, hashed_addon_id, total_downloads, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_campaign) ) AS downloads_per_campaign, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_content) ) AS downloads_per_content, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_source) ) AS downloads_per_source, ARRAY( SELECT AS STRUCT IFNULL(key, 'Unknown') AS key, value FROM UNNEST(downloads_per_medium) ) AS downloads_per_medium, FROM `moz-fx-data-shared-prod.amo_prod.amo_stats_installs_v3`","title":"View"},{"location":"moz-fx-data-shared-prod/default_browser_agent/","text":"default_browser View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.default_browser_agent.default_browser` AS SELECT * EXCEPT ( client_id -- This field is deprecated and was never actually sent. ) REPLACE(`moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata) FROM `moz-fx-data-shared-prod.default_browser_agent_stable.default_browser_v1`","title":"default_browser_agent"},{"location":"moz-fx-data-shared-prod/default_browser_agent/#default_browser","text":"","title":"default_browser"},{"location":"moz-fx-data-shared-prod/default_browser_agent/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.default_browser_agent.default_browser` AS SELECT * EXCEPT ( client_id -- This field is deprecated and was never actually sent. ) REPLACE(`moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata) FROM `moz-fx-data-shared-prod.default_browser_agent_stable.default_browser_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/","text":"fxa_log_performance_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_performance_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_content_events_v1` WHERE STARTS_WITH(event, 'flow.performance') fxa_amplitude_email_clicks View /* See https://bugzilla.mozilla.org/show_bug.cgi?id=1633918 Due to permissions issues, this view is published via the fxa_export_to_amplitude DAG rather than the schema deployment pipeline. */ CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_amplitude_email_clicks` AS WITH hmac_key AS ( SELECT AEAD.DECRYPT_BYTES( (SELECT keyset FROM `moz-fx-dataops-secrets.airflow_query_keys.fxa_prod`), ciphertext, CAST(key_id AS BYTES) ) AS value FROM `moz-fx-data-shared-prod.firefox_accounts_derived.encrypted_keys_v1` WHERE key_id = 'fxa_hmac_prod' ), -- sendjobs.EmailName is parsed via regex; -- see format definition in https://docs.google.com/spreadsheets/d/1mHpXSoDcfYK8XSX4bf-CHSfdn8XY5svDAw8ik5FhPrs/edit#gid=1626564614 -- and original regex in https://github.com/mozilla/fxa-amplitude-send/blob/89bfaef20a1d978fce2dccddc0155699a17ac172/marketing.js#L109 email_name_regex AS ( SELECT AS VALUE r\"^\\w*(MoCo|MoFo|PKT)_([A-Z]+)_([A-Za-z-]+)_(20[0-9][0-9])(?:_([A-Za-z-]+))?_(?:HTML|TEXT)_([^_]+)(?:_(ALL|[A-Z]{2}))?_([A-Za-z-]+)_EML(?:_(.*))?\" ), -- The sendjobs table is tiny (< 1 GB) and a given sendjob can appear in -- multiple snapshots, so we deduplicate over all history, taking the newest. sendjobs_numbered AS ( SELECT *, SPLIT( REGEXP_REPLACE(EmailName, (SELECT * FROM email_name_regex), r\"\\1;\\2;\\3;\\4;\\5;\\6;\\7;\\8;\\9\"), ';' ) AS parsed, ROW_NUMBER() OVER (PARTITION BY SendID ORDER BY snapshot_date DESC) AS _n FROM `mozilla-cdp-prod.sfmc.sendjobs` WHERE REGEXP_CONTAINS(EmailName, (SELECT * FROM email_name_regex)) ), sendjobs AS ( SELECT * EXCEPT (_n, parsed), parsed[ORDINAL(1)] AS email_sender, parsed[ORDINAL(2)] AS email_region, parsed[ORDINAL(3)] AS email_audience, parsed[ORDINAL(4)] AS email_year, parsed[ORDINAL(5)] AS email_category, parsed[ORDINAL(6)] AS email_id, parsed[ORDINAL(7)] AS email_country, parsed[ORDINAL(8)] AS email_language, parsed[ORDINAL(9)] AS email_push_number, FROM sendjobs_numbered WHERE _n = 1 ), -- Likewise, the customer_record table is fairly small (~10 GB), so it is feasible -- to deduplicate over all history on the fly. customers_numbered AS ( SELECT *, ROW_NUMBER() OVER (PARTITION BY email ORDER BY fxa_ts DESC) AS _n FROM `mozilla-cdp-prod.fxa.customer_record` ), customers_deduped AS ( SELECT * EXCEPT (_n), IF( NET.PUBLIC_SUFFIX(email) IS NULL, NULL, -- We construct an \"email_provider\" field that is a simple name like \"gmail\", \"outlook\", etc. -- We use some BQ NET functions and string munging to get the hostname and -- remove common suffixes \".com\", \".net\", \".co.uk\", etc. RTRIM( SUBSTR(NET.HOST(email), 1, LENGTH(NET.HOST(email)) - LENGTH(NET.PUBLIC_SUFFIX(email))), '.' ) ) AS email_provider FROM customers_numbered WHERE _n = 1 ), -- We filter out email providers with fewer than 10k customers in this dataset, -- roughly similar to how we filter out cities with fewer than 10k residents for -- GeoIP lookups in the data pipeline. email_providers_over_10k AS ( SELECT email_provider FROM customers_deduped GROUP BY 1 HAVING count(*) > 10000 ), customers AS ( SELECT * EXCEPT (email_provider), TO_HEX( `moz-fx-data-shared-prod`.udf.hmac_sha256((SELECT * FROM hmac_key), CAST(fxa_id AS BYTES)) ) AS user_id, email_providers_over_10k.email_provider, FROM customers_deduped LEFT JOIN email_providers_over_10k USING (email_provider) ) SELECT TIMESTAMP(clicks.snapshot_date) AS submission_timestamp, UNIX_MILLIS(clicks.EventDate) AS `time`, customers.user_id, ARRAY_TO_STRING([customers.user_id, clicks.SendId, string(clicks.EventDate)], '-') AS insert_id, 'mktg - email_click' AS event_type, FORMAT( -- We use CONCAT here to avoid '{' directly followed by '%' which will be -- interpreted as opening a Jinja statement when run via Airflow's BigQueryOperator. CONCAT('{', '%t', '}'), ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST( [ STRUCT('email_provider' AS key, customers.email_provider AS value), STRUCT( 'utm_source' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_source=([^&]+)\") AS value ), STRUCT( 'utm_medium' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_medium=([^&]+)\") AS value ), STRUCT( 'utm_campaign' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_campaign=([^&]+)\") AS value ), STRUCT( 'utm_content' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_content=([^&]+)\") AS value ), STRUCT( 'utm_term' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_term=([^&]+)\") AS value ) ] ) WHERE value IS NOT NULL ), ',' ) ) AS user_properties, FORMAT( CONCAT('{', '%t', '}'), ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST( [ STRUCT('service' AS key, customers.service AS value), STRUCT('email_alias' AS key, clicks.alias AS value), STRUCT('email_type' AS key, clicks.EventType AS value), STRUCT('email_sender' AS key, email_sender AS value), STRUCT('email_region' AS key, email_region AS value), STRUCT('email_audience' AS key, email_audience AS value), STRUCT('email_year' AS key, email_year AS value), STRUCT('email_category' AS key, email_category AS value), STRUCT('email_id' AS key, email_id AS value), STRUCT('email_country' AS key, email_country AS value), STRUCT('email_language' AS key, email_language AS value), STRUCT('email_push_number' AS key, email_push_number AS value) ] ) WHERE value IS NOT NULL AND value != '' ), ',' ) ) AS event_properties, FROM `mozilla-cdp-prod.sfmc.clicks` AS clicks LEFT JOIN customers ON (clicks.EmailAddress = customers.email) LEFT JOIN sendjobs USING (SendID) WHERE user_id IS NOT NULL fxa_log_content_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_content_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_content_events_v1` WHERE NOT STARTS_WITH(event, 'flow.performance') sync_send_tab_export View -- Sampled view on send tab metrics intended for sending to Amplitude; -- see https://bugzilla.mozilla.org/show_bug.cgi?id=1628740 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.sync_send_tab_export` AS WITH events AS ( SELECT *, `moz-fx-data-shared-prod`.udf.deanonymize_event(event).* FROM `moz-fx-data-shared-prod.telemetry.sync` CROSS JOIN UNNEST(payload.events) AS event ), cleaned AS ( SELECT *, payload.device_id, `moz-fx-data-shared-prod`.udf.get_key(event_map_values, 'serverTime') AS server_time, `moz-fx-data-shared-prod`.udf.normalize_os(payload.os.name) AS os_name, CASE event_object WHEN 'processcommand' THEN 'sync - tab_received' WHEN 'sendcommand' THEN 'sync - tab_sent' END AS event_type, `moz-fx-data-shared-prod`.udf.get_key(event_map_values, 'flowID') AS flow_id, FROM events WHERE event_method = 'displayURI' ) SELECT cleaned.submission_timestamp, ids.user_id, device_id, ARRAY_TO_STRING( [device_id, event_category, event_method, event_object, server_time, flow_id], '-' ) AS insert_id, -- Amplitude expects a `time` field in milliseconds since UNIX epoch. COALESCE( -- server_time is in seconds, but with one digit after the decimal place, so we -- have to cast to float, multiply to get milliseconds, then cast to int. SAFE_CAST(SAFE_CAST(server_time AS FLOAT64) * 1000 AS INT64), -- server_time is sometimes null, so we fall back to submission_timestamp UNIX_MILLIS(cleaned.submission_timestamp) ) AS time, event_type, metadata.geo.country, metadata.geo.city, os_name, payload.os.version AS os_version, payload.os.locale AS `language`, FORMAT( '{%t}', ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST( [ STRUCT('fxa_uid' AS key, ids.user_id AS value), STRUCT('ua_browser', metadata.user_agent.browser), STRUCT('ua_version', metadata.user_agent.version) ] ) WHERE value IS NOT NULL ), ',' ) ) AS user_properties, FORMAT( '{%t}', ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST([STRUCT('flow_id' AS key, flow_id AS value)]) WHERE value IS NOT NULL ), ',' ) ) AS event_properties, FROM cleaned -- We need this join because sync pings contain a truncated ID that is just the -- first 32 characters of the 64-character hash sent to Amplitude by other producers; -- we join based on the prefix to recover the full 64-character hash. LEFT JOIN `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_amplitude_user_ids_v1` AS ids ON cleaned.payload.uid = SUBSTR(ids.user_id, 1, 32) WHERE -- To save on Amplitude budget, we take a 10% sample based on user ID. MOD(ABS(FARM_FINGERPRINT(payload.uid)), 100) < 10 fxa_content_auth_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_content_auth_events` AS -- WITH content AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_content_events_v1` ), -- auth AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_events_v1` ), -- unioned AS ( SELECT * FROM auth UNION ALL SELECT * FROM content ) -- SELECT * EXCEPT (user_properties, event_properties), REPLACE(JSON_EXTRACT(user_properties, '$.utm_term'), \"\\\"\", \"\") AS utm_term, REPLACE(JSON_EXTRACT(user_properties, '$.utm_source'), \"\\\"\", \"\") AS utm_source, REPLACE(JSON_EXTRACT(user_properties, '$.utm_medium'), \"\\\"\", \"\") AS utm_medium, REPLACE(JSON_EXTRACT(user_properties, '$.utm_campaign'), \"\\\"\", \"\") AS utm_campaign, REPLACE(JSON_EXTRACT(user_properties, '$.ua_version'), \"\\\"\", \"\") AS ua_version, REPLACE(JSON_EXTRACT(user_properties, '$.ua_browser'), \"\\\"\", \"\") AS ua_browser, REPLACE(JSON_EXTRACT(user_properties, '$.entrypoint'), \"\\\"\", \"\") AS entrypoint, REPLACE(JSON_EXTRACT(user_properties, '$.flow_id'), \"\\\"\", \"\") AS flow_id, REPLACE(JSON_EXTRACT(event_properties, '$.service'), \"\\\"\", \"\") AS service, REPLACE(JSON_EXTRACT(event_properties, '$.email_type'), \"\\\"\", \"\") AS email_type, REPLACE(JSON_EXTRACT(event_properties, '$.email_provider'), \"\\\"\", \"\") AS email_provider, REPLACE(JSON_EXTRACT(event_properties, '$.oauth_client_id'), \"\\\"\", \"\") AS oauth_client_id, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_flow'), \"\\\"\", \"\") AS connect_device_flow, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_os'), \"\\\"\", \"\") AS connect_device_os, REPLACE(JSON_EXTRACT(user_properties, '$.sync_device_count'), \"\\\"\", \"\") AS sync_device_count, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_day'), \"\\\"\", \"\" ) AS sync_active_devices_day, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_week'), \"\\\"\", \"\" ) AS sync_active_devices_week, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_month'), \"\\\"\", \"\" ) AS sync_active_devices_month, REPLACE(JSON_EXTRACT(event_properties, '$.email_sender'), \"\\\"\", \"\") AS email_sender, REPLACE(JSON_EXTRACT(event_properties, '$.email_service'), \"\\\"\", \"\") AS email_service, REPLACE(JSON_EXTRACT(event_properties, '$.email_template'), \"\\\"\", \"\") AS email_template, REPLACE(JSON_EXTRACT(event_properties, '$.email_version'), \"\\\"\", \"\") AS email_version FROM unioned fxa_users_services_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_users_services_daily` AS SELECT * REPLACE (cn.code AS country), fxa.country AS country_name FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_users_services_daily_v1` AS fxa LEFT JOIN `moz-fx-data-shared-prod.static.country_names_v1` AS cn ON cn.name = fxa.country fxa_users_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_users_last_seen` AS SELECT mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen( days_seen_in_tier1_country_bits ) AS days_since_seen_in_tier1_country, mozfun.bits28.days_since_seen(days_registered_bits) AS days_since_registered, mozfun.bits28.days_since_seen(days_seen_no_monitor_bits) AS days_since_seen_no_monitor, * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_users_last_seen_v1` fxa_all_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_all_events` AS WITH fxa_auth_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_events_v1` ), -- This table doesn't include any user events that are considered \"active\", -- but should always be included for a complete raw event log. fxa_auth_bounce_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, CAST( NULL AS STRING ) AS country, -- No country field in auth_bounces jsonPayload.fields.language, jsonPayload.fields.app_version, CAST(NULL AS STRING), CAST(NULL AS STRING), jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_bounce_events_v1` ), fxa_content_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_content_events_v1` ), fxa_oauth_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, CAST(NULL AS STRING) AS country, CAST(NULL AS STRING) AS language, jsonPayload.fields.app_version, CAST(NULL AS STRING) AS os_name, CAST(NULL AS STRING) AS os_version, jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_oauth_events_v1` ) SELECT * FROM fxa_auth_events UNION ALL SELECT * FROM fxa_auth_bounce_events UNION ALL SELECT * FROM fxa_content_events UNION ALL SELECT * FROM fxa_oauth_events fxa_log_device_command_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_device_command_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_device_command_events_v1` fxa_amplitude_export View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_amplitude_export` AS WITH active_users AS ( SELECT TIMESTAMP(submission_date_pacific, \"America/Los_Angeles\") AS submission_timestamp, `moz-fx-data-shared-prod`.udf.active_values_from_days_seen_map( os_used_month, 0, 1 ) AS os_used_day, `moz-fx-data-shared-prod`.udf.active_values_from_days_seen_map( os_used_month, -6, 7 ) AS os_used_week, `moz-fx-data-shared-prod`.udf.active_values_from_days_seen_map( os_used_month, -27, 28 ) AS os_used_month, * EXCEPT (days_seen_bits, os_used_month, submission_date_pacific) REPLACE( TIMESTAMP(submission_date_pacific, \"America/Los_Angeles\") AS timestamp ) FROM `moz-fx-data-shared-prod`.firefox_accounts_derived.fxa_amplitude_export_v1 WHERE `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit(days_seen_bits) = 0 ), active_events AS ( SELECT submission_timestamp, user_id, insert_id, 'fxa_activity - active' AS event_type, timestamp, TO_JSON_STRING( STRUCT(services AS service, oauth_client_ids, rollup_events) ) AS event_properties, region, country, `LANGUAGE`, app_version AS version, TO_JSON_STRING(os_used_day) AS os, '' AS user_properties FROM active_users ), user_properties AS ( SELECT submission_timestamp, user_id, '' AS insert_id, '$identify' AS event_type, timestamp, '' AS event_properties, -- Some Amplitude properties are top level region, country, `LANGUAGE`, app_version AS version, TO_JSON_STRING(os_used_day) AS os, -- We don't want to include user_properties if they are null, so we need -- to list them out explicitly and filter with WHERE CONCAT( \"{\", ARRAY_TO_STRING( ARRAY( SELECT CONCAT(TO_JSON_STRING(key), \":\", value) FROM ( SELECT AS STRUCT \"os_used_day\" AS key, TO_JSON_STRING(os_used_day) AS value, UNION ALL SELECT AS STRUCT \"os_used_week\" AS key, TO_JSON_STRING(os_used_week) AS value, UNION ALL SELECT AS STRUCT \"os_used_month\" AS key, TO_JSON_STRING(os_used_month) AS value, UNION ALL SELECT AS STRUCT \"sync_device_count\" AS key, TO_JSON_STRING(sync_device_count) AS value, UNION ALL SELECT AS STRUCT \"sync_active_devices_day\" AS key, TO_JSON_STRING(sync_active_devices_day) AS value, UNION ALL SELECT AS STRUCT \"sync_active_devices_week\" AS key, TO_JSON_STRING(sync_active_devices_week) AS value, UNION ALL SELECT AS STRUCT \"sync_active_devices_month\" AS key, TO_JSON_STRING(sync_active_devices_month) AS value, UNION ALL SELECT AS STRUCT \"ua_version\" AS key, TO_JSON_STRING(ua_version) AS value, UNION ALL SELECT AS STRUCT \"ua_browser\" AS key, TO_JSON_STRING(ua_browser) AS value, UNION ALL SELECT AS STRUCT \"$postInsert\", TO_JSON_STRING(STRUCT(fxa_services_used)) AS value ) WHERE value != \"null\" AND value != \"[]\" ), \",\" ), \"}\" ) AS user_properties FROM active_users ), all_events AS ( SELECT * FROM active_events UNION ALL SELECT * FROM user_properties ) SELECT * FROM all_events fxa_log_auth_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_auth_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_auth_events_v1` fxa_content_auth_oauth_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_content_auth_oauth_events` AS -- WITH content AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_content_events_v1` ), -- auth AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_events_v1` ), -- oauth AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, CAST(NULL AS STRING) AS os_name, CAST(NULL AS STRING) AS os_version, CAST(NULL AS STRING) AS country, CAST(NULL AS STRING) AS language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_oauth_events_v1` ), -- unioned AS ( SELECT * FROM auth UNION ALL SELECT * FROM content UNION ALL SELECT * FROM oauth ) -- SELECT * EXCEPT (user_properties, event_properties), REPLACE(JSON_EXTRACT(user_properties, '$.utm_term'), \"\\\"\", \"\") AS utm_term, REPLACE(JSON_EXTRACT(user_properties, '$.utm_source'), \"\\\"\", \"\") AS utm_source, REPLACE(JSON_EXTRACT(user_properties, '$.utm_medium'), \"\\\"\", \"\") AS utm_medium, REPLACE(JSON_EXTRACT(user_properties, '$.utm_campaign'), \"\\\"\", \"\") AS utm_campaign, REPLACE(JSON_EXTRACT(user_properties, '$.ua_version'), \"\\\"\", \"\") AS ua_version, REPLACE(JSON_EXTRACT(user_properties, '$.ua_browser'), \"\\\"\", \"\") AS ua_browser, REPLACE(JSON_EXTRACT(user_properties, '$.entrypoint'), \"\\\"\", \"\") AS entrypoint, REPLACE(JSON_EXTRACT(user_properties, '$.flow_id'), \"\\\"\", \"\") AS flow_id, REPLACE(JSON_EXTRACT(event_properties, '$.service'), \"\\\"\", \"\") AS service, REPLACE(JSON_EXTRACT(event_properties, '$.email_type'), \"\\\"\", \"\") AS email_type, REPLACE(JSON_EXTRACT(event_properties, '$.email_provider'), \"\\\"\", \"\") AS email_provider, REPLACE(JSON_EXTRACT(event_properties, '$.oauth_client_id'), \"\\\"\", \"\") AS oauth_client_id, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_flow'), \"\\\"\", \"\") AS connect_device_flow, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_os'), \"\\\"\", \"\") AS connect_device_os, REPLACE(JSON_EXTRACT(user_properties, '$.sync_device_count'), \"\\\"\", \"\") AS sync_device_count, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_day'), \"\\\"\", \"\" ) AS sync_active_devices_day, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_week'), \"\\\"\", \"\" ) AS sync_active_devices_week, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_month'), \"\\\"\", \"\" ) AS sync_active_devices_month, REPLACE(JSON_EXTRACT(event_properties, '$.email_sender'), \"\\\"\", \"\") AS email_sender, REPLACE(JSON_EXTRACT(event_properties, '$.email_service'), \"\\\"\", \"\") AS email_service, REPLACE(JSON_EXTRACT(event_properties, '$.email_template'), \"\\\"\", \"\") AS email_template, REPLACE(JSON_EXTRACT(event_properties, '$.email_version'), \"\\\"\", \"\") AS email_version FROM unioned","title":"firefox_accounts"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_log_performance_events","text":"","title":"fxa_log_performance_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_performance_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_content_events_v1` WHERE STARTS_WITH(event, 'flow.performance')","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_amplitude_email_clicks","text":"","title":"fxa_amplitude_email_clicks"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_1","text":"/* See https://bugzilla.mozilla.org/show_bug.cgi?id=1633918 Due to permissions issues, this view is published via the fxa_export_to_amplitude DAG rather than the schema deployment pipeline. */ CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_amplitude_email_clicks` AS WITH hmac_key AS ( SELECT AEAD.DECRYPT_BYTES( (SELECT keyset FROM `moz-fx-dataops-secrets.airflow_query_keys.fxa_prod`), ciphertext, CAST(key_id AS BYTES) ) AS value FROM `moz-fx-data-shared-prod.firefox_accounts_derived.encrypted_keys_v1` WHERE key_id = 'fxa_hmac_prod' ), -- sendjobs.EmailName is parsed via regex; -- see format definition in https://docs.google.com/spreadsheets/d/1mHpXSoDcfYK8XSX4bf-CHSfdn8XY5svDAw8ik5FhPrs/edit#gid=1626564614 -- and original regex in https://github.com/mozilla/fxa-amplitude-send/blob/89bfaef20a1d978fce2dccddc0155699a17ac172/marketing.js#L109 email_name_regex AS ( SELECT AS VALUE r\"^\\w*(MoCo|MoFo|PKT)_([A-Z]+)_([A-Za-z-]+)_(20[0-9][0-9])(?:_([A-Za-z-]+))?_(?:HTML|TEXT)_([^_]+)(?:_(ALL|[A-Z]{2}))?_([A-Za-z-]+)_EML(?:_(.*))?\" ), -- The sendjobs table is tiny (< 1 GB) and a given sendjob can appear in -- multiple snapshots, so we deduplicate over all history, taking the newest. sendjobs_numbered AS ( SELECT *, SPLIT( REGEXP_REPLACE(EmailName, (SELECT * FROM email_name_regex), r\"\\1;\\2;\\3;\\4;\\5;\\6;\\7;\\8;\\9\"), ';' ) AS parsed, ROW_NUMBER() OVER (PARTITION BY SendID ORDER BY snapshot_date DESC) AS _n FROM `mozilla-cdp-prod.sfmc.sendjobs` WHERE REGEXP_CONTAINS(EmailName, (SELECT * FROM email_name_regex)) ), sendjobs AS ( SELECT * EXCEPT (_n, parsed), parsed[ORDINAL(1)] AS email_sender, parsed[ORDINAL(2)] AS email_region, parsed[ORDINAL(3)] AS email_audience, parsed[ORDINAL(4)] AS email_year, parsed[ORDINAL(5)] AS email_category, parsed[ORDINAL(6)] AS email_id, parsed[ORDINAL(7)] AS email_country, parsed[ORDINAL(8)] AS email_language, parsed[ORDINAL(9)] AS email_push_number, FROM sendjobs_numbered WHERE _n = 1 ), -- Likewise, the customer_record table is fairly small (~10 GB), so it is feasible -- to deduplicate over all history on the fly. customers_numbered AS ( SELECT *, ROW_NUMBER() OVER (PARTITION BY email ORDER BY fxa_ts DESC) AS _n FROM `mozilla-cdp-prod.fxa.customer_record` ), customers_deduped AS ( SELECT * EXCEPT (_n), IF( NET.PUBLIC_SUFFIX(email) IS NULL, NULL, -- We construct an \"email_provider\" field that is a simple name like \"gmail\", \"outlook\", etc. -- We use some BQ NET functions and string munging to get the hostname and -- remove common suffixes \".com\", \".net\", \".co.uk\", etc. RTRIM( SUBSTR(NET.HOST(email), 1, LENGTH(NET.HOST(email)) - LENGTH(NET.PUBLIC_SUFFIX(email))), '.' ) ) AS email_provider FROM customers_numbered WHERE _n = 1 ), -- We filter out email providers with fewer than 10k customers in this dataset, -- roughly similar to how we filter out cities with fewer than 10k residents for -- GeoIP lookups in the data pipeline. email_providers_over_10k AS ( SELECT email_provider FROM customers_deduped GROUP BY 1 HAVING count(*) > 10000 ), customers AS ( SELECT * EXCEPT (email_provider), TO_HEX( `moz-fx-data-shared-prod`.udf.hmac_sha256((SELECT * FROM hmac_key), CAST(fxa_id AS BYTES)) ) AS user_id, email_providers_over_10k.email_provider, FROM customers_deduped LEFT JOIN email_providers_over_10k USING (email_provider) ) SELECT TIMESTAMP(clicks.snapshot_date) AS submission_timestamp, UNIX_MILLIS(clicks.EventDate) AS `time`, customers.user_id, ARRAY_TO_STRING([customers.user_id, clicks.SendId, string(clicks.EventDate)], '-') AS insert_id, 'mktg - email_click' AS event_type, FORMAT( -- We use CONCAT here to avoid '{' directly followed by '%' which will be -- interpreted as opening a Jinja statement when run via Airflow's BigQueryOperator. CONCAT('{', '%t', '}'), ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST( [ STRUCT('email_provider' AS key, customers.email_provider AS value), STRUCT( 'utm_source' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_source=([^&]+)\") AS value ), STRUCT( 'utm_medium' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_medium=([^&]+)\") AS value ), STRUCT( 'utm_campaign' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_campaign=([^&]+)\") AS value ), STRUCT( 'utm_content' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_content=([^&]+)\") AS value ), STRUCT( 'utm_term' AS key, REGEXP_EXTRACT(clicks.URL, r\"[?&]utm_term=([^&]+)\") AS value ) ] ) WHERE value IS NOT NULL ), ',' ) ) AS user_properties, FORMAT( CONCAT('{', '%t', '}'), ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST( [ STRUCT('service' AS key, customers.service AS value), STRUCT('email_alias' AS key, clicks.alias AS value), STRUCT('email_type' AS key, clicks.EventType AS value), STRUCT('email_sender' AS key, email_sender AS value), STRUCT('email_region' AS key, email_region AS value), STRUCT('email_audience' AS key, email_audience AS value), STRUCT('email_year' AS key, email_year AS value), STRUCT('email_category' AS key, email_category AS value), STRUCT('email_id' AS key, email_id AS value), STRUCT('email_country' AS key, email_country AS value), STRUCT('email_language' AS key, email_language AS value), STRUCT('email_push_number' AS key, email_push_number AS value) ] ) WHERE value IS NOT NULL AND value != '' ), ',' ) ) AS event_properties, FROM `mozilla-cdp-prod.sfmc.clicks` AS clicks LEFT JOIN customers ON (clicks.EmailAddress = customers.email) LEFT JOIN sendjobs USING (SendID) WHERE user_id IS NOT NULL","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_log_content_events","text":"","title":"fxa_log_content_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_content_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_content_events_v1` WHERE NOT STARTS_WITH(event, 'flow.performance')","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#sync_send_tab_export","text":"","title":"sync_send_tab_export"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_3","text":"-- Sampled view on send tab metrics intended for sending to Amplitude; -- see https://bugzilla.mozilla.org/show_bug.cgi?id=1628740 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.sync_send_tab_export` AS WITH events AS ( SELECT *, `moz-fx-data-shared-prod`.udf.deanonymize_event(event).* FROM `moz-fx-data-shared-prod.telemetry.sync` CROSS JOIN UNNEST(payload.events) AS event ), cleaned AS ( SELECT *, payload.device_id, `moz-fx-data-shared-prod`.udf.get_key(event_map_values, 'serverTime') AS server_time, `moz-fx-data-shared-prod`.udf.normalize_os(payload.os.name) AS os_name, CASE event_object WHEN 'processcommand' THEN 'sync - tab_received' WHEN 'sendcommand' THEN 'sync - tab_sent' END AS event_type, `moz-fx-data-shared-prod`.udf.get_key(event_map_values, 'flowID') AS flow_id, FROM events WHERE event_method = 'displayURI' ) SELECT cleaned.submission_timestamp, ids.user_id, device_id, ARRAY_TO_STRING( [device_id, event_category, event_method, event_object, server_time, flow_id], '-' ) AS insert_id, -- Amplitude expects a `time` field in milliseconds since UNIX epoch. COALESCE( -- server_time is in seconds, but with one digit after the decimal place, so we -- have to cast to float, multiply to get milliseconds, then cast to int. SAFE_CAST(SAFE_CAST(server_time AS FLOAT64) * 1000 AS INT64), -- server_time is sometimes null, so we fall back to submission_timestamp UNIX_MILLIS(cleaned.submission_timestamp) ) AS time, event_type, metadata.geo.country, metadata.geo.city, os_name, payload.os.version AS os_version, payload.os.locale AS `language`, FORMAT( '{%t}', ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST( [ STRUCT('fxa_uid' AS key, ids.user_id AS value), STRUCT('ua_browser', metadata.user_agent.browser), STRUCT('ua_version', metadata.user_agent.version) ] ) WHERE value IS NOT NULL ), ',' ) ) AS user_properties, FORMAT( '{%t}', ARRAY_TO_STRING( ARRAY( SELECT FORMAT('\"%t\":\"%t\"', key, value) FROM UNNEST([STRUCT('flow_id' AS key, flow_id AS value)]) WHERE value IS NOT NULL ), ',' ) ) AS event_properties, FROM cleaned -- We need this join because sync pings contain a truncated ID that is just the -- first 32 characters of the 64-character hash sent to Amplitude by other producers; -- we join based on the prefix to recover the full 64-character hash. LEFT JOIN `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_amplitude_user_ids_v1` AS ids ON cleaned.payload.uid = SUBSTR(ids.user_id, 1, 32) WHERE -- To save on Amplitude budget, we take a 10% sample based on user ID. MOD(ABS(FARM_FINGERPRINT(payload.uid)), 100) < 10","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_content_auth_events","text":"","title":"fxa_content_auth_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_4","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_content_auth_events` AS -- WITH content AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_content_events_v1` ), -- auth AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_events_v1` ), -- unioned AS ( SELECT * FROM auth UNION ALL SELECT * FROM content ) -- SELECT * EXCEPT (user_properties, event_properties), REPLACE(JSON_EXTRACT(user_properties, '$.utm_term'), \"\\\"\", \"\") AS utm_term, REPLACE(JSON_EXTRACT(user_properties, '$.utm_source'), \"\\\"\", \"\") AS utm_source, REPLACE(JSON_EXTRACT(user_properties, '$.utm_medium'), \"\\\"\", \"\") AS utm_medium, REPLACE(JSON_EXTRACT(user_properties, '$.utm_campaign'), \"\\\"\", \"\") AS utm_campaign, REPLACE(JSON_EXTRACT(user_properties, '$.ua_version'), \"\\\"\", \"\") AS ua_version, REPLACE(JSON_EXTRACT(user_properties, '$.ua_browser'), \"\\\"\", \"\") AS ua_browser, REPLACE(JSON_EXTRACT(user_properties, '$.entrypoint'), \"\\\"\", \"\") AS entrypoint, REPLACE(JSON_EXTRACT(user_properties, '$.flow_id'), \"\\\"\", \"\") AS flow_id, REPLACE(JSON_EXTRACT(event_properties, '$.service'), \"\\\"\", \"\") AS service, REPLACE(JSON_EXTRACT(event_properties, '$.email_type'), \"\\\"\", \"\") AS email_type, REPLACE(JSON_EXTRACT(event_properties, '$.email_provider'), \"\\\"\", \"\") AS email_provider, REPLACE(JSON_EXTRACT(event_properties, '$.oauth_client_id'), \"\\\"\", \"\") AS oauth_client_id, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_flow'), \"\\\"\", \"\") AS connect_device_flow, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_os'), \"\\\"\", \"\") AS connect_device_os, REPLACE(JSON_EXTRACT(user_properties, '$.sync_device_count'), \"\\\"\", \"\") AS sync_device_count, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_day'), \"\\\"\", \"\" ) AS sync_active_devices_day, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_week'), \"\\\"\", \"\" ) AS sync_active_devices_week, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_month'), \"\\\"\", \"\" ) AS sync_active_devices_month, REPLACE(JSON_EXTRACT(event_properties, '$.email_sender'), \"\\\"\", \"\") AS email_sender, REPLACE(JSON_EXTRACT(event_properties, '$.email_service'), \"\\\"\", \"\") AS email_service, REPLACE(JSON_EXTRACT(event_properties, '$.email_template'), \"\\\"\", \"\") AS email_template, REPLACE(JSON_EXTRACT(event_properties, '$.email_version'), \"\\\"\", \"\") AS email_version FROM unioned","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_users_services_daily","text":"","title":"fxa_users_services_daily"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_5","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_users_services_daily` AS SELECT * REPLACE (cn.code AS country), fxa.country AS country_name FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_users_services_daily_v1` AS fxa LEFT JOIN `moz-fx-data-shared-prod.static.country_names_v1` AS cn ON cn.name = fxa.country","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_users_last_seen","text":"","title":"fxa_users_last_seen"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_6","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_users_last_seen` AS SELECT mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen( days_seen_in_tier1_country_bits ) AS days_since_seen_in_tier1_country, mozfun.bits28.days_since_seen(days_registered_bits) AS days_since_registered, mozfun.bits28.days_since_seen(days_seen_no_monitor_bits) AS days_since_seen_no_monitor, * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_users_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_all_events","text":"","title":"fxa_all_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_7","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_all_events` AS WITH fxa_auth_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_events_v1` ), -- This table doesn't include any user events that are considered \"active\", -- but should always be included for a complete raw event log. fxa_auth_bounce_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, CAST( NULL AS STRING ) AS country, -- No country field in auth_bounces jsonPayload.fields.language, jsonPayload.fields.app_version, CAST(NULL AS STRING), CAST(NULL AS STRING), jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_bounce_events_v1` ), fxa_content_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_content_events_v1` ), fxa_oauth_events AS ( SELECT timestamp AS submission_timestamp, jsonPayload.fields.user_id, CAST(NULL AS STRING) AS country, CAST(NULL AS STRING) AS language, jsonPayload.fields.app_version, CAST(NULL AS STRING) AS os_name, CAST(NULL AS STRING) AS os_version, jsonPayload.fields.event_type, JSON_EXTRACT_SCALAR(jsonPayload.fields.event_properties, '$.service') AS service FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_oauth_events_v1` ) SELECT * FROM fxa_auth_events UNION ALL SELECT * FROM fxa_auth_bounce_events UNION ALL SELECT * FROM fxa_content_events UNION ALL SELECT * FROM fxa_oauth_events","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_log_device_command_events","text":"","title":"fxa_log_device_command_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_8","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_device_command_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_device_command_events_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_amplitude_export","text":"","title":"fxa_amplitude_export"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_9","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_amplitude_export` AS WITH active_users AS ( SELECT TIMESTAMP(submission_date_pacific, \"America/Los_Angeles\") AS submission_timestamp, `moz-fx-data-shared-prod`.udf.active_values_from_days_seen_map( os_used_month, 0, 1 ) AS os_used_day, `moz-fx-data-shared-prod`.udf.active_values_from_days_seen_map( os_used_month, -6, 7 ) AS os_used_week, `moz-fx-data-shared-prod`.udf.active_values_from_days_seen_map( os_used_month, -27, 28 ) AS os_used_month, * EXCEPT (days_seen_bits, os_used_month, submission_date_pacific) REPLACE( TIMESTAMP(submission_date_pacific, \"America/Los_Angeles\") AS timestamp ) FROM `moz-fx-data-shared-prod`.firefox_accounts_derived.fxa_amplitude_export_v1 WHERE `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit(days_seen_bits) = 0 ), active_events AS ( SELECT submission_timestamp, user_id, insert_id, 'fxa_activity - active' AS event_type, timestamp, TO_JSON_STRING( STRUCT(services AS service, oauth_client_ids, rollup_events) ) AS event_properties, region, country, `LANGUAGE`, app_version AS version, TO_JSON_STRING(os_used_day) AS os, '' AS user_properties FROM active_users ), user_properties AS ( SELECT submission_timestamp, user_id, '' AS insert_id, '$identify' AS event_type, timestamp, '' AS event_properties, -- Some Amplitude properties are top level region, country, `LANGUAGE`, app_version AS version, TO_JSON_STRING(os_used_day) AS os, -- We don't want to include user_properties if they are null, so we need -- to list them out explicitly and filter with WHERE CONCAT( \"{\", ARRAY_TO_STRING( ARRAY( SELECT CONCAT(TO_JSON_STRING(key), \":\", value) FROM ( SELECT AS STRUCT \"os_used_day\" AS key, TO_JSON_STRING(os_used_day) AS value, UNION ALL SELECT AS STRUCT \"os_used_week\" AS key, TO_JSON_STRING(os_used_week) AS value, UNION ALL SELECT AS STRUCT \"os_used_month\" AS key, TO_JSON_STRING(os_used_month) AS value, UNION ALL SELECT AS STRUCT \"sync_device_count\" AS key, TO_JSON_STRING(sync_device_count) AS value, UNION ALL SELECT AS STRUCT \"sync_active_devices_day\" AS key, TO_JSON_STRING(sync_active_devices_day) AS value, UNION ALL SELECT AS STRUCT \"sync_active_devices_week\" AS key, TO_JSON_STRING(sync_active_devices_week) AS value, UNION ALL SELECT AS STRUCT \"sync_active_devices_month\" AS key, TO_JSON_STRING(sync_active_devices_month) AS value, UNION ALL SELECT AS STRUCT \"ua_version\" AS key, TO_JSON_STRING(ua_version) AS value, UNION ALL SELECT AS STRUCT \"ua_browser\" AS key, TO_JSON_STRING(ua_browser) AS value, UNION ALL SELECT AS STRUCT \"$postInsert\", TO_JSON_STRING(STRUCT(fxa_services_used)) AS value ) WHERE value != \"null\" AND value != \"[]\" ), \",\" ), \"}\" ) AS user_properties FROM active_users ), all_events AS ( SELECT * FROM active_events UNION ALL SELECT * FROM user_properties ) SELECT * FROM all_events","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_log_auth_events","text":"","title":"fxa_log_auth_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_10","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_log_auth_events` AS SELECT * FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_log_auth_events_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#fxa_content_auth_oauth_events","text":"","title":"fxa_content_auth_oauth_events"},{"location":"moz-fx-data-shared-prod/firefox_accounts/#view_11","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.firefox_accounts.fxa_content_auth_oauth_events` AS -- WITH content AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_content_events_v1` ), -- auth AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, jsonPayload.fields.os_name, jsonPayload.fields.os_version, jsonPayload.fields.country, jsonPayload.fields.language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_auth_events_v1` ), -- oauth AS ( SELECT jsonPayload.logger, jsonPayload.fields.event_type, jsonPayload.fields.app_version, CAST(NULL AS STRING) AS os_name, CAST(NULL AS STRING) AS os_version, CAST(NULL AS STRING) AS country, CAST(NULL AS STRING) AS language, jsonPayload.fields.user_id, jsonPayload.fields.user_properties, jsonPayload.fields.event_properties, `timestamp`, receiveTimestamp FROM `moz-fx-data-shared-prod.firefox_accounts_derived.fxa_oauth_events_v1` ), -- unioned AS ( SELECT * FROM auth UNION ALL SELECT * FROM content UNION ALL SELECT * FROM oauth ) -- SELECT * EXCEPT (user_properties, event_properties), REPLACE(JSON_EXTRACT(user_properties, '$.utm_term'), \"\\\"\", \"\") AS utm_term, REPLACE(JSON_EXTRACT(user_properties, '$.utm_source'), \"\\\"\", \"\") AS utm_source, REPLACE(JSON_EXTRACT(user_properties, '$.utm_medium'), \"\\\"\", \"\") AS utm_medium, REPLACE(JSON_EXTRACT(user_properties, '$.utm_campaign'), \"\\\"\", \"\") AS utm_campaign, REPLACE(JSON_EXTRACT(user_properties, '$.ua_version'), \"\\\"\", \"\") AS ua_version, REPLACE(JSON_EXTRACT(user_properties, '$.ua_browser'), \"\\\"\", \"\") AS ua_browser, REPLACE(JSON_EXTRACT(user_properties, '$.entrypoint'), \"\\\"\", \"\") AS entrypoint, REPLACE(JSON_EXTRACT(user_properties, '$.flow_id'), \"\\\"\", \"\") AS flow_id, REPLACE(JSON_EXTRACT(event_properties, '$.service'), \"\\\"\", \"\") AS service, REPLACE(JSON_EXTRACT(event_properties, '$.email_type'), \"\\\"\", \"\") AS email_type, REPLACE(JSON_EXTRACT(event_properties, '$.email_provider'), \"\\\"\", \"\") AS email_provider, REPLACE(JSON_EXTRACT(event_properties, '$.oauth_client_id'), \"\\\"\", \"\") AS oauth_client_id, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_flow'), \"\\\"\", \"\") AS connect_device_flow, REPLACE(JSON_EXTRACT(event_properties, '$.connect_device_os'), \"\\\"\", \"\") AS connect_device_os, REPLACE(JSON_EXTRACT(user_properties, '$.sync_device_count'), \"\\\"\", \"\") AS sync_device_count, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_day'), \"\\\"\", \"\" ) AS sync_active_devices_day, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_week'), \"\\\"\", \"\" ) AS sync_active_devices_week, REPLACE( JSON_EXTRACT(user_properties, '$.sync_active_devices_month'), \"\\\"\", \"\" ) AS sync_active_devices_month, REPLACE(JSON_EXTRACT(event_properties, '$.email_sender'), \"\\\"\", \"\") AS email_sender, REPLACE(JSON_EXTRACT(event_properties, '$.email_service'), \"\\\"\", \"\") AS email_service, REPLACE(JSON_EXTRACT(event_properties, '$.email_template'), \"\\\"\", \"\") AS email_template, REPLACE(JSON_EXTRACT(event_properties, '$.email_version'), \"\\\"\", \"\") AS email_version FROM unioned","title":"View"},{"location":"moz-fx-data-shared-prod/internet_outages/","text":"global_outages_v1 Metadata Friendly name : Internet Outages Description : This contains a set aggregated metrics that correlate to internet outages for different countries in the world. The dataset contains the following fields: - country : the Country code of the client. - city : the City name (only for cities with a population >= 15000, 'unknown' otherwise). - datetime : the date and the time (truncated to hour) the data was submitted by the client. - proportion_undefined : the proportion of users who failed to send telemetry for a reason that was not listed in the other cases. - proportion_timeout : the proportion of users that had their connection timeout while uploading telemetry ( after 90s, in Firefox Desktop ). - proportion_abort : the proportion of users that had their connection terminated by the client (for example, terminating open connections before shutting down). - proportion_unreachable : the proportion of users that failed to upload telemetry because the server was not reachable (e.g. because the host was not reachable, proxy problems or OS waking up after a suspension). - proportion_terminated : the proportion of users that had their connection terminated internally by the networking code. - proportion_channel_open : the proportion of users for which the upload request was terminated immediately, by the client, because of a Necko internal error. - avg_dns_success_time : the average time it takes for a successful DNS resolution, in milliseconds. - missing_dns_success : counts how many sessions did not report the DNS_LOOKUP_TIME histogram. - avg_dns_failure_time : the average time it takes for an unsuccessful DNS resolution, in milliseconds. - missing_dns_failure : counts how many sessions did not report the DNS_FAILED_LOOKUP_TIME histogram. - count_dns_failure : the average count of unsuccessful DNS resolutions reported. - ssl_error_prop : the proportion of users that reported an error through the SSL_CERT_VERIFICATION_ERRORS histogram. - avg_tls_handshake_time : the average time after the TCP SYN to ready for HTTP, in milliseconds. Caveats with the data: As with any observational data, there are many caveats and interpretation must be done carefully. Below is a list of issues we have considered, but it is not exhaustive. - Firefox users are not representative of the general population in their region. - Users can experience multiple types of failures and so the proportions are not summable. For example, if 2.4% of clients had a timeout and 2.6% of clients had eUnreachable that doesn't necessarily mean that 5.0% of clients had a timeout or a eUnreachable - Geographical data is based on IPGeo databases. These databases are imperfect, so some activity may be attributed to the wrong location. Further, proxy and VPN usage can create geo-attribution errors. Owners : aplacitelli@mozilla.com , sguha@mozilla.com DAG name : bqetl_internet_outages","title":"internet_outages"},{"location":"moz-fx-data-shared-prod/internet_outages/#global_outages_v1","text":"","title":"global_outages_v1"},{"location":"moz-fx-data-shared-prod/internet_outages/#metadata","text":"Friendly name : Internet Outages Description : This contains a set aggregated metrics that correlate to internet outages for different countries in the world. The dataset contains the following fields: - country : the Country code of the client. - city : the City name (only for cities with a population >= 15000, 'unknown' otherwise). - datetime : the date and the time (truncated to hour) the data was submitted by the client. - proportion_undefined : the proportion of users who failed to send telemetry for a reason that was not listed in the other cases. - proportion_timeout : the proportion of users that had their connection timeout while uploading telemetry ( after 90s, in Firefox Desktop ). - proportion_abort : the proportion of users that had their connection terminated by the client (for example, terminating open connections before shutting down). - proportion_unreachable : the proportion of users that failed to upload telemetry because the server was not reachable (e.g. because the host was not reachable, proxy problems or OS waking up after a suspension). - proportion_terminated : the proportion of users that had their connection terminated internally by the networking code. - proportion_channel_open : the proportion of users for which the upload request was terminated immediately, by the client, because of a Necko internal error. - avg_dns_success_time : the average time it takes for a successful DNS resolution, in milliseconds. - missing_dns_success : counts how many sessions did not report the DNS_LOOKUP_TIME histogram. - avg_dns_failure_time : the average time it takes for an unsuccessful DNS resolution, in milliseconds. - missing_dns_failure : counts how many sessions did not report the DNS_FAILED_LOOKUP_TIME histogram. - count_dns_failure : the average count of unsuccessful DNS resolutions reported. - ssl_error_prop : the proportion of users that reported an error through the SSL_CERT_VERIFICATION_ERRORS histogram. - avg_tls_handshake_time : the average time after the TCP SYN to ready for HTTP, in milliseconds. Caveats with the data: As with any observational data, there are many caveats and interpretation must be done carefully. Below is a list of issues we have considered, but it is not exhaustive. - Firefox users are not representative of the general population in their region. - Users can experience multiple types of failures and so the proportions are not summable. For example, if 2.4% of clients had a timeout and 2.6% of clients had eUnreachable that doesn't necessarily mean that 5.0% of clients had a timeout or a eUnreachable - Geographical data is based on IPGeo databases. These databases are imperfect, so some activity may be attributed to the wrong location. Further, proxy and VPN usage can create geo-attribution errors. Owners : aplacitelli@mozilla.com , sguha@mozilla.com DAG name : bqetl_internet_outages","title":"Metadata"},{"location":"moz-fx-data-shared-prod/messaging_system/","text":"onboarding_exact_mau28_by_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.onboarding_exact_mau28_by_dimensions_v1` onboarding_retention_events_amplitude View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_retention_events_amplitude` AS SELECT TIMESTAMP(submission_date) AS submission_timestamp, client_id AS device_id, CONCAT(client_id, submission_date) AS insert_id, \"RETENTION\" AS event_type, TIMESTAMP(submission_date) AS timestamp, app_version, REGEXP_EXTRACT(os, '^\\\\w+') AS platform, os AS os_name, os_version, cd.country AS country, geo_subdivision1 AS region, city, -- No `event_properties` for this event TO_JSON_STRING( STRUCT( cd.locale AS locale, channel AS release_channel, ARRAY(SELECT CONCAT(key, \" - \", value) FROM UNNEST(experiments)) AS experiments ) ) AS user_properties FROM `moz-fx-data-shared-prod.messaging_system.onboarding_users_last_seen` JOIN `moz-fx-data-shared-prod.telemetry.clients_daily` cd USING (client_id, submission_date) snippets_users_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.snippets_users_daily` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.snippets_users_daily_v1` onboarding_events_amplitude View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_events_amplitude` AS SELECT submission_timestamp, client_id AS device_id, document_id AS insert_id, event AS event_type, submission_timestamp AS timestamp, version AS app_version, REGEXP_EXTRACT(metadata.user_agent.os, '^\\\\w+') AS platform, metadata.user_agent.os AS os_name, normalized_os_version AS os_version, metadata.geo.country AS country, metadata.geo.subdivision1 AS region, metadata.geo.city AS city, ( `moz-fx-data-shared-prod.udf.kv_array_append_to_json_string`( event_context, [STRUCT(\"message_id\" AS key, message_id AS value)] ) ) AS event_properties, TO_JSON_STRING( STRUCT( locale, release_channel, ARRAY(SELECT CONCAT(key, \" - \", value.branch) FROM UNNEST(experiments)) AS experiments, attribution.source AS attribution_source, attribution.ua AS attribution_ua ) ) AS user_properties FROM `moz-fx-data-shared-prod.messaging_system_stable.onboarding_v1` WHERE -- Fetch events on about:welcome only to minimize the event volume event_context LIKE \"%about:welcome%\" cfr_users_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.cfr_users_last_seen` AS SELECT `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`(days_seen_bits) AS days_since_seen, `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`( days_seen_whats_new_bits ) AS days_since_seen_whats_new, * FROM `moz-fx-data-shared-prod.messaging_system_derived.cfr_users_last_seen_v1` cfr_users_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.cfr_users_daily` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.cfr_users_daily_v1` onboarding_users_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_users_last_seen` AS SELECT `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`(days_seen_bits) AS days_since_seen, * FROM `moz-fx-data-shared-prod.messaging_system_derived.onboarding_users_last_seen_v1` snippets_users_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.snippets_users_last_seen` AS SELECT `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`(days_seen_bits) AS days_since_seen, * FROM `moz-fx-data-shared-prod.messaging_system_derived.snippets_users_last_seen_v1` snippets_exact_mau28_by_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.snippets_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.snippets_exact_mau28_by_dimensions_v1` cfr_exact_mau28_by_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.cfr_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.cfr_exact_mau28_by_dimensions_v1` onboarding_users_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_users_daily` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.onboarding_users_daily_v1`","title":"messaging_system"},{"location":"moz-fx-data-shared-prod/messaging_system/#onboarding_exact_mau28_by_dimensions","text":"","title":"onboarding_exact_mau28_by_dimensions"},{"location":"moz-fx-data-shared-prod/messaging_system/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.onboarding_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#onboarding_retention_events_amplitude","text":"","title":"onboarding_retention_events_amplitude"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_retention_events_amplitude` AS SELECT TIMESTAMP(submission_date) AS submission_timestamp, client_id AS device_id, CONCAT(client_id, submission_date) AS insert_id, \"RETENTION\" AS event_type, TIMESTAMP(submission_date) AS timestamp, app_version, REGEXP_EXTRACT(os, '^\\\\w+') AS platform, os AS os_name, os_version, cd.country AS country, geo_subdivision1 AS region, city, -- No `event_properties` for this event TO_JSON_STRING( STRUCT( cd.locale AS locale, channel AS release_channel, ARRAY(SELECT CONCAT(key, \" - \", value) FROM UNNEST(experiments)) AS experiments ) ) AS user_properties FROM `moz-fx-data-shared-prod.messaging_system.onboarding_users_last_seen` JOIN `moz-fx-data-shared-prod.telemetry.clients_daily` cd USING (client_id, submission_date)","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#snippets_users_daily","text":"","title":"snippets_users_daily"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.snippets_users_daily` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.snippets_users_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#onboarding_events_amplitude","text":"","title":"onboarding_events_amplitude"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_events_amplitude` AS SELECT submission_timestamp, client_id AS device_id, document_id AS insert_id, event AS event_type, submission_timestamp AS timestamp, version AS app_version, REGEXP_EXTRACT(metadata.user_agent.os, '^\\\\w+') AS platform, metadata.user_agent.os AS os_name, normalized_os_version AS os_version, metadata.geo.country AS country, metadata.geo.subdivision1 AS region, metadata.geo.city AS city, ( `moz-fx-data-shared-prod.udf.kv_array_append_to_json_string`( event_context, [STRUCT(\"message_id\" AS key, message_id AS value)] ) ) AS event_properties, TO_JSON_STRING( STRUCT( locale, release_channel, ARRAY(SELECT CONCAT(key, \" - \", value.branch) FROM UNNEST(experiments)) AS experiments, attribution.source AS attribution_source, attribution.ua AS attribution_ua ) ) AS user_properties FROM `moz-fx-data-shared-prod.messaging_system_stable.onboarding_v1` WHERE -- Fetch events on about:welcome only to minimize the event volume event_context LIKE \"%about:welcome%\"","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#cfr_users_last_seen","text":"","title":"cfr_users_last_seen"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_4","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.cfr_users_last_seen` AS SELECT `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`(days_seen_bits) AS days_since_seen, `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`( days_seen_whats_new_bits ) AS days_since_seen_whats_new, * FROM `moz-fx-data-shared-prod.messaging_system_derived.cfr_users_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#cfr_users_daily","text":"","title":"cfr_users_daily"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_5","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.cfr_users_daily` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.cfr_users_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#onboarding_users_last_seen","text":"","title":"onboarding_users_last_seen"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_6","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_users_last_seen` AS SELECT `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`(days_seen_bits) AS days_since_seen, * FROM `moz-fx-data-shared-prod.messaging_system_derived.onboarding_users_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#snippets_users_last_seen","text":"","title":"snippets_users_last_seen"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_7","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.snippets_users_last_seen` AS SELECT `moz-fx-data-shared-prod.udf.pos_of_trailing_set_bit`(days_seen_bits) AS days_since_seen, * FROM `moz-fx-data-shared-prod.messaging_system_derived.snippets_users_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#snippets_exact_mau28_by_dimensions","text":"","title":"snippets_exact_mau28_by_dimensions"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_8","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.snippets_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.snippets_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#cfr_exact_mau28_by_dimensions","text":"","title":"cfr_exact_mau28_by_dimensions"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_9","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.cfr_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.cfr_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/messaging_system/#onboarding_users_daily","text":"","title":"onboarding_users_daily"},{"location":"moz-fx-data-shared-prod/messaging_system/#view_10","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.messaging_system.onboarding_users_daily` AS SELECT * FROM `moz-fx-data-shared-prod.messaging_system_derived.onboarding_users_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/","text":"deletion_request_volume View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.deletion_request_volume` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.deletion_request_volume_v1` structured_distinct_docids View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_distinct_docids` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_distinct_docids_v1` shredder_progress View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.shredder_progress` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.shredder_progress_v1` structured_missing_columns View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_missing_columns` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_missing_columns_v1` bigquery_etl_scheduled_query_usage View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.bigquery_etl_scheduled_query_usage` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.bigquery_etl_scheduled_query_usage_v1` column_size View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.column_size` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.column_size_v1` average_ping_sizes View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.average_ping_sizes` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.average_ping_sizes_v1` telemetry_missing_columns View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.telemetry_missing_columns` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.telemetry_missing_columns_v3` telemetry_distinct_docids View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.telemetry_distinct_docids` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.telemetry_distinct_docids_v1` schema_error_counts View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.schema_error_counts` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.schema_error_counts_v2` stable_table_sizes View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.stable_table_sizes` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.stable_table_sizes_v1` structured_error_counts View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_error_counts` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_error_counts_v1` bigquery_etl_scheduled_queries_cost View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.bigquery_etl_scheduled_queries_cost` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.bigquery_etl_scheduled_queries_cost_v1` structured_detailed_error_counts View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_detailed_error_counts` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_detailed_error_counts_v1` document_sample_nonprod View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.document_sample_nonprod` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.document_sample_nonprod_v1`","title":"monitoring"},{"location":"moz-fx-data-shared-prod/monitoring/#deletion_request_volume","text":"","title":"deletion_request_volume"},{"location":"moz-fx-data-shared-prod/monitoring/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.deletion_request_volume` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.deletion_request_volume_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#structured_distinct_docids","text":"","title":"structured_distinct_docids"},{"location":"moz-fx-data-shared-prod/monitoring/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_distinct_docids` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_distinct_docids_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#shredder_progress","text":"","title":"shredder_progress"},{"location":"moz-fx-data-shared-prod/monitoring/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.shredder_progress` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.shredder_progress_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#structured_missing_columns","text":"","title":"structured_missing_columns"},{"location":"moz-fx-data-shared-prod/monitoring/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_missing_columns` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_missing_columns_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#bigquery_etl_scheduled_query_usage","text":"","title":"bigquery_etl_scheduled_query_usage"},{"location":"moz-fx-data-shared-prod/monitoring/#view_4","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.bigquery_etl_scheduled_query_usage` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.bigquery_etl_scheduled_query_usage_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#column_size","text":"","title":"column_size"},{"location":"moz-fx-data-shared-prod/monitoring/#view_5","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.column_size` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.column_size_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#average_ping_sizes","text":"","title":"average_ping_sizes"},{"location":"moz-fx-data-shared-prod/monitoring/#view_6","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.average_ping_sizes` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.average_ping_sizes_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#telemetry_missing_columns","text":"","title":"telemetry_missing_columns"},{"location":"moz-fx-data-shared-prod/monitoring/#view_7","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.telemetry_missing_columns` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.telemetry_missing_columns_v3`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#telemetry_distinct_docids","text":"","title":"telemetry_distinct_docids"},{"location":"moz-fx-data-shared-prod/monitoring/#view_8","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.telemetry_distinct_docids` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.telemetry_distinct_docids_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#schema_error_counts","text":"","title":"schema_error_counts"},{"location":"moz-fx-data-shared-prod/monitoring/#view_9","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.schema_error_counts` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.schema_error_counts_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#stable_table_sizes","text":"","title":"stable_table_sizes"},{"location":"moz-fx-data-shared-prod/monitoring/#view_10","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.stable_table_sizes` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.stable_table_sizes_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#structured_error_counts","text":"","title":"structured_error_counts"},{"location":"moz-fx-data-shared-prod/monitoring/#view_11","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_error_counts` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_error_counts_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#bigquery_etl_scheduled_queries_cost","text":"","title":"bigquery_etl_scheduled_queries_cost"},{"location":"moz-fx-data-shared-prod/monitoring/#view_12","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.bigquery_etl_scheduled_queries_cost` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.bigquery_etl_scheduled_queries_cost_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#structured_detailed_error_counts","text":"","title":"structured_detailed_error_counts"},{"location":"moz-fx-data-shared-prod/monitoring/#view_13","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.structured_detailed_error_counts` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.structured_detailed_error_counts_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/monitoring/#document_sample_nonprod","text":"","title":"document_sample_nonprod"},{"location":"moz-fx-data-shared-prod/monitoring/#view_14","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.monitoring.document_sample_nonprod` AS SELECT * FROM `moz-fx-data-shared-prod.monitoring_derived.document_sample_nonprod_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/","text":"add_device_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.add_device_events` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.add_device_events_v1 waitlist View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.waitlist` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.waitlist_v1 survey_market_fit View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_market_fit` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_market_fit_v1 survey_product_quality View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_product_quality` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_product_quality_v1 survey_intercept_q3 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_intercept_q3` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_intercept_q3_v1 users View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.users` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.users_v1 survey_recommend View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_recommend` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_recommend_v1 login_flows View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.login_flows` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.login_flows_v1 protected View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.protected` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.protected_v1 survey_cancellation_of_service View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_cancellation_of_service` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_cancellation_of_service_v1","title":"mozilla_vpn"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#add_device_events","text":"","title":"add_device_events"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.add_device_events` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.add_device_events_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#waitlist","text":"","title":"waitlist"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.waitlist` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.waitlist_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#survey_market_fit","text":"","title":"survey_market_fit"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_market_fit` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_market_fit_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#survey_product_quality","text":"","title":"survey_product_quality"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_product_quality` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_product_quality_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#survey_intercept_q3","text":"","title":"survey_intercept_q3"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_4","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_intercept_q3` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_intercept_q3_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#users","text":"","title":"users"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_5","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.users` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.users_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#survey_recommend","text":"","title":"survey_recommend"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_6","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_recommend` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_recommend_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#login_flows","text":"","title":"login_flows"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_7","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.login_flows` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.login_flows_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#protected","text":"","title":"protected"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_8","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.protected` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.protected_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#survey_cancellation_of_service","text":"","title":"survey_cancellation_of_service"},{"location":"moz-fx-data-shared-prod/mozilla_vpn/#view_9","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.mozilla_vpn.survey_cancellation_of_service` AS SELECT * FROM `moz-fx-data-shared-prod`.mozilla_vpn_derived.survey_cancellation_of_service_v1","title":"View"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/","text":"devices_v1 Metadata Friendly name : Mozilla VPN Devices Description : A mirror of the devices table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn users_v1 Metadata Friendly name : Mozilla VPN Users Description : A mirror of the users table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn waitlist_v1 Metadata Friendly name : Mozilla VPN Waitlist Description : A mirror of the waitlist table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn subscriptions_v1 Metadata Friendly name : Mozilla VPN Subscriptions Description : A mirror of the subscriptions table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn","title":"mozilla_vpn_external"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#devices_v1","text":"","title":"devices_v1"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#metadata","text":"Friendly name : Mozilla VPN Devices Description : A mirror of the devices table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn","title":"Metadata"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#users_v1","text":"","title":"users_v1"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#metadata_1","text":"Friendly name : Mozilla VPN Users Description : A mirror of the users table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn","title":"Metadata"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#waitlist_v1","text":"","title":"waitlist_v1"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#metadata_2","text":"Friendly name : Mozilla VPN Waitlist Description : A mirror of the waitlist table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn","title":"Metadata"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#subscriptions_v1","text":"","title":"subscriptions_v1"},{"location":"moz-fx-data-shared-prod/mozilla_vpn_external/#metadata_3","text":"Friendly name : Mozilla VPN Subscriptions Description : A mirror of the subscriptions table from the Mozilla VPN (Guardian) CloudSQL database, updated daily to match the current state of the table. The table history is not needed, because changes made are not destructive, except in the case of self-serve data deletion. Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_mozilla_vpn","title":"Metadata"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix/","text":"geckoview_version View -- Return the most likely version over many windows of the estimated major -- version CREATE OR REPLACE VIEW `moz-fx-data-shared-prod`.org_mozilla_fenix.geckoview_version AS WITH agg AS ( SELECT array_agg(t ORDER BY geckoview_major_version DESC, n_pings DESC LIMIT 1)[offset(0)] AS top_row FROM `moz-fx-data-shared-prod`.org_mozilla_fenix_derived.geckoview_version_v1 t GROUP BY build_hour ) SELECT top_row.* FROM agg","title":"org_mozilla_fenix"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix/#geckoview_version","text":"","title":"geckoview_version"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix/#view","text":"-- Return the most likely version over many windows of the estimated major -- version CREATE OR REPLACE VIEW `moz-fx-data-shared-prod`.org_mozilla_fenix.geckoview_version AS WITH agg AS ( SELECT array_agg(t ORDER BY geckoview_major_version DESC, n_pings DESC LIMIT 1)[offset(0)] AS top_row FROM `moz-fx-data-shared-prod`.org_mozilla_fenix_derived.geckoview_version_v1 t GROUP BY build_hour ) SELECT top_row.* FROM agg","title":"View"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix_nightly/","text":"baseline_clients_daily View -- Generated via bigquery_etl.glean_usage CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.baseline_clients_daily` AS SELECT * FROM `moz-fx-data-shared-prod.org_mozilla_fenix_nightly_derived.baseline_clients_daily_v1` baseline_clients_last_seen View -- Generated via bigquery_etl.glean_usage CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.baseline_clients_last_seen` AS SELECT `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit(days_seen_bits) AS days_since_seen, `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit( days_created_profile_bits ) AS days_since_created_profile, `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit( days_seen_session_start_bits ) AS days_since_seen_session_start, `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit( days_seen_session_end_bits ) AS days_since_seen_session_end, * FROM `moz-fx-data-shared-prod.org_mozilla_fenix_nightly_derived.baseline_clients_last_seen_v1`","title":"org_mozilla_fenix_nightly"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix_nightly/#baseline_clients_daily","text":"","title":"baseline_clients_daily"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix_nightly/#view","text":"-- Generated via bigquery_etl.glean_usage CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.baseline_clients_daily` AS SELECT * FROM `moz-fx-data-shared-prod.org_mozilla_fenix_nightly_derived.baseline_clients_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix_nightly/#baseline_clients_last_seen","text":"","title":"baseline_clients_last_seen"},{"location":"moz-fx-data-shared-prod/org_mozilla_fenix_nightly/#view_1","text":"-- Generated via bigquery_etl.glean_usage CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.baseline_clients_last_seen` AS SELECT `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit(days_seen_bits) AS days_since_seen, `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit( days_created_profile_bits ) AS days_since_created_profile, `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit( days_seen_session_start_bits ) AS days_since_seen_session_start, `moz-fx-data-shared-prod`.udf.pos_of_trailing_set_bit( days_seen_session_end_bits ) AS days_since_seen_session_end, * FROM `moz-fx-data-shared-prod.org_mozilla_fenix_nightly_derived.baseline_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/","text":"event_types_v1 Metadata Friendly name : Firefox Android Release Event Types Description : Recreate a view on the most recent data from event_types_v1 Owners : frank@mozilla.com Schedule : daily DAG name : bqetl_fenix_event_rollup migrated_clients View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_firefox.migrated_clients` AS SELECT * FROM `moz-fx-data-shared-prod.org_mozilla_firefox_derived.migrated_clients_v1` migration View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_firefox.migration` AS --Fennec Nightly SELECT DATE(submission_timestamp) AS submission_date, * REPLACE ('nightly' AS normalized_channel) FROM `moz-fx-data-shared-prod.org_mozilla_fennec_aurora_stable.migration_v1` UNION ALL --Fennec Beta SELECT DATE(submission_timestamp) AS submission_date, * REPLACE ('beta' AS normalized_channel) FROM `moz-fx-data-shared-prod.org_mozilla_firefox_beta_stable.migration_v1` UNION ALL --Fennec Release SELECT DATE(submission_timestamp) AS submission_date, * REPLACE ('release' AS normalized_channel) FROM `moz-fx-data-shared-prod.org_mozilla_firefox_stable.migration_v1` events_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_firefox.events_daily` AS SELECT * FROM `moz-fx-data-shared-prod.org_mozilla_firefox_derived.events_daily_v1`","title":"org_mozilla_firefox"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#event_types_v1","text":"","title":"event_types_v1"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#metadata","text":"Friendly name : Firefox Android Release Event Types Description : Recreate a view on the most recent data from event_types_v1 Owners : frank@mozilla.com Schedule : daily DAG name : bqetl_fenix_event_rollup","title":"Metadata"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#migrated_clients","text":"","title":"migrated_clients"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_firefox.migrated_clients` AS SELECT * FROM `moz-fx-data-shared-prod.org_mozilla_firefox_derived.migrated_clients_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#migration","text":"","title":"migration"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_firefox.migration` AS --Fennec Nightly SELECT DATE(submission_timestamp) AS submission_date, * REPLACE ('nightly' AS normalized_channel) FROM `moz-fx-data-shared-prod.org_mozilla_fennec_aurora_stable.migration_v1` UNION ALL --Fennec Beta SELECT DATE(submission_timestamp) AS submission_date, * REPLACE ('beta' AS normalized_channel) FROM `moz-fx-data-shared-prod.org_mozilla_firefox_beta_stable.migration_v1` UNION ALL --Fennec Release SELECT DATE(submission_timestamp) AS submission_date, * REPLACE ('release' AS normalized_channel) FROM `moz-fx-data-shared-prod.org_mozilla_firefox_stable.migration_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#events_daily","text":"","title":"events_daily"},{"location":"moz-fx-data-shared-prod/org_mozilla_firefox/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_firefox.events_daily` AS SELECT * FROM `moz-fx-data-shared-prod.org_mozilla_firefox_derived.events_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/org_mozilla_vrbrowser/","text":"clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_vrbrowser.clients_last_seen` AS WITH with_days_since AS ( SELECT mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen(days_created_profile_bits) AS days_since_created_profile, * FROM `moz-fx-data-shared-prod.org_mozilla_vrbrowser_derived.clients_last_seen_v1` ) -- SELECT -- Include date_last_seen for compatibility with existing queries. DATE_SUB(submission_date, INTERVAL days_since_seen DAY) AS date_last_seen, * FROM with_days_since","title":"org_mozilla_vrbrowser"},{"location":"moz-fx-data-shared-prod/org_mozilla_vrbrowser/#clients_last_seen","text":"","title":"clients_last_seen"},{"location":"moz-fx-data-shared-prod/org_mozilla_vrbrowser/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.org_mozilla_vrbrowser.clients_last_seen` AS WITH with_days_since AS ( SELECT mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen(days_created_profile_bits) AS days_since_created_profile, * FROM `moz-fx-data-shared-prod.org_mozilla_vrbrowser_derived.clients_last_seen_v1` ) -- SELECT -- Include date_last_seen for compatibility with existing queries. DATE_SUB(submission_date, INTERVAL days_since_seen DAY) AS date_last_seen, * FROM with_days_since","title":"View"},{"location":"moz-fx-data-shared-prod/pocket/","text":"pocket_reach_mau View -- This is an authorized view that allows us to read specific data from -- a project owned by the Pocket team; if the definition here changes, -- it may need to be manually redeployed by Data Ops. CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.pocket.pocket_reach_mau` AS SELECT * FROM `pocket-airflow-prod.data_from_pocket.pocket_reach_mau`","title":"pocket"},{"location":"moz-fx-data-shared-prod/pocket/#pocket_reach_mau","text":"","title":"pocket_reach_mau"},{"location":"moz-fx-data-shared-prod/pocket/#view","text":"-- This is an authorized view that allows us to read specific data from -- a project owned by the Pocket team; if the definition here changes, -- it may need to be manually redeployed by Data Ops. CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.pocket.pocket_reach_mau` AS SELECT * FROM `pocket-airflow-prod.data_from_pocket.pocket_reach_mau`","title":"View"},{"location":"moz-fx-data-shared-prod/regrets_reporter/","text":"regrets_reporter_update View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.regrets_reporter.regrets_reporter_update` AS SELECT * REPLACE ( ( SELECT AS STRUCT metadata.* REPLACE ( ( SELECT AS STRUCT metadata.header.*, SAFE.PARSE_TIMESTAMP( '%a, %d %b %Y %T %Z', -- Even though it's not part of the spec, many clients append -- '+00:00' to their Date headers, so we strip that suffix. REPLACE(metadata.header.`date`, 'GMT+00:00', 'GMT') ) AS parsed_date, ARRAY( SELECT TRIM(t) FROM UNNEST(SPLIT(metadata.header.x_source_tags, ',')) t ) AS parsed_x_source_tags ) AS header, -- Limit the geo info we present to the country level; -- https://bugzilla.mozilla.org/show_bug.cgi?id=1654078#c45 (SELECT AS STRUCT metadata.geo.country) AS geo ) ) AS metadata ) FROM `moz-fx-data-shared-prod.regrets_reporter_stable.regrets_reporter_update_v1`","title":"regrets_reporter"},{"location":"moz-fx-data-shared-prod/regrets_reporter/#regrets_reporter_update","text":"","title":"regrets_reporter_update"},{"location":"moz-fx-data-shared-prod/regrets_reporter/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.regrets_reporter.regrets_reporter_update` AS SELECT * REPLACE ( ( SELECT AS STRUCT metadata.* REPLACE ( ( SELECT AS STRUCT metadata.header.*, SAFE.PARSE_TIMESTAMP( '%a, %d %b %Y %T %Z', -- Even though it's not part of the spec, many clients append -- '+00:00' to their Date headers, so we strip that suffix. REPLACE(metadata.header.`date`, 'GMT+00:00', 'GMT') ) AS parsed_date, ARRAY( SELECT TRIM(t) FROM UNNEST(SPLIT(metadata.header.x_source_tags, ',')) t ) AS parsed_x_source_tags ) AS header, -- Limit the geo info we present to the country level; -- https://bugzilla.mozilla.org/show_bug.cgi?id=1654078#c45 (SELECT AS STRUCT metadata.geo.country) AS geo ) ) AS metadata ) FROM `moz-fx-data-shared-prod.regrets_reporter_stable.regrets_reporter_update_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/","text":"mobile_search_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_aggregates` AS SELECT * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, search_count AS sap, FROM `moz-fx-data-shared-prod.search_derived.mobile_search_aggregates_v1` mobile_search_clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_clients_last_seen` AS SELECT * EXCEPT (engine_searches, total_searches), `moz-fx-data-shared-prod`.udf.normalize_monthly_searches(engine_searches) AS engine_searches, FROM `moz-fx-data-shared-prod.search_derived.mobile_search_clients_last_seen_v1` desktop_search_aggregates_for_searchreport View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.desktop_search_aggregates_for_searchreport` AS SELECT * FROM `moz-fx-data-shared-prod.search_derived.desktop_search_aggregates_for_searchreport_v1` search_rfm View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_rfm` AS SELECT `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`(days_seen_bytes) AS days_seen, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`(days_searched_bytes) AS days_searched, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`( days_tagged_searched_bytes ) AS days_tagged_searched, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`( days_searched_with_ads_bytes ) AS days_searched_with_ads, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`(days_clicked_ads_bytes) AS days_clicked_ads, `moz-fx-data-shared-prod.udf.bits_to_days_since_first_seen`( days_created_profile_bytes ) AS days_since_created_profile, * EXCEPT ( days_seen_bytes, days_searched_bytes, days_tagged_searched_bytes, days_searched_with_ads_bytes, days_clicked_ads_bytes, days_created_profile_bytes ) FROM `moz-fx-data-shared-prod.search_derived.search_clients_last_seen_v1` mobile_search_aggregates_for_searchreport View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_aggregates_for_searchreport` AS SELECT * FROM `moz-fx-data-shared-prod.search_derived.mobile_search_aggregates_for_searchreport_v1` search_clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.search.search_clients_last_seen_v1` mobile_search_clients_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_clients_daily` AS SELECT * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, search_count AS sap, FROM `moz-fx-data-shared-prod.search_derived.mobile_search_clients_daily_v1` desktop_search_aggregates_by_userstate View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.desktop_search_aggregates_by_userstate` AS SELECT * FROM `moz-fx-data-shared-prod.search_derived.desktop_search_aggregates_by_userstate_v1` search_clients_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_clients_daily` AS SELECT submission_date AS submission_date_s3, * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, FROM `moz-fx-data-shared-prod.search_derived.search_clients_daily_v8` search_clients_last_seen_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_clients_last_seen_v1` AS SELECT * EXCEPT (total_searches), `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen(days_seen_bytes) AS days_since_seen, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen(days_searched_bytes) AS days_since_searched, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen( days_tagged_searched_bytes ) AS days_since_tagged_searched, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen( days_searched_with_ads_bytes ) AS days_since_searched_with_ads, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen( days_clicked_ads_bytes ) AS days_since_clicked_ad, `moz-fx-data-shared-prod`.udf.bits_to_days_since_first_seen( days_created_profile_bytes ) AS days_since_created_profile FROM `moz-fx-data-shared-prod.search_derived.search_clients_last_seen_v1` search_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_aggregates` AS SELECT submission_date AS submission_date_s3, * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, FROM `moz-fx-data-shared-prod.search_derived.search_aggregates_v8`","title":"search"},{"location":"moz-fx-data-shared-prod/search/#mobile_search_aggregates","text":"","title":"mobile_search_aggregates"},{"location":"moz-fx-data-shared-prod/search/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_aggregates` AS SELECT * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, search_count AS sap, FROM `moz-fx-data-shared-prod.search_derived.mobile_search_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#mobile_search_clients_last_seen","text":"","title":"mobile_search_clients_last_seen"},{"location":"moz-fx-data-shared-prod/search/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_clients_last_seen` AS SELECT * EXCEPT (engine_searches, total_searches), `moz-fx-data-shared-prod`.udf.normalize_monthly_searches(engine_searches) AS engine_searches, FROM `moz-fx-data-shared-prod.search_derived.mobile_search_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#desktop_search_aggregates_for_searchreport","text":"","title":"desktop_search_aggregates_for_searchreport"},{"location":"moz-fx-data-shared-prod/search/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.desktop_search_aggregates_for_searchreport` AS SELECT * FROM `moz-fx-data-shared-prod.search_derived.desktop_search_aggregates_for_searchreport_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#search_rfm","text":"","title":"search_rfm"},{"location":"moz-fx-data-shared-prod/search/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_rfm` AS SELECT `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`(days_seen_bytes) AS days_seen, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`(days_searched_bytes) AS days_searched, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`( days_tagged_searched_bytes ) AS days_tagged_searched, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`( days_searched_with_ads_bytes ) AS days_searched_with_ads, `moz-fx-data-shared-prod.udf.days_seen_bytes_to_rfm`(days_clicked_ads_bytes) AS days_clicked_ads, `moz-fx-data-shared-prod.udf.bits_to_days_since_first_seen`( days_created_profile_bytes ) AS days_since_created_profile, * EXCEPT ( days_seen_bytes, days_searched_bytes, days_tagged_searched_bytes, days_searched_with_ads_bytes, days_clicked_ads_bytes, days_created_profile_bytes ) FROM `moz-fx-data-shared-prod.search_derived.search_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#mobile_search_aggregates_for_searchreport","text":"","title":"mobile_search_aggregates_for_searchreport"},{"location":"moz-fx-data-shared-prod/search/#view_4","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_aggregates_for_searchreport` AS SELECT * FROM `moz-fx-data-shared-prod.search_derived.mobile_search_aggregates_for_searchreport_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#search_clients_last_seen","text":"","title":"search_clients_last_seen"},{"location":"moz-fx-data-shared-prod/search/#view_5","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.search.search_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#mobile_search_clients_daily","text":"","title":"mobile_search_clients_daily"},{"location":"moz-fx-data-shared-prod/search/#view_6","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.mobile_search_clients_daily` AS SELECT * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, search_count AS sap, FROM `moz-fx-data-shared-prod.search_derived.mobile_search_clients_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#desktop_search_aggregates_by_userstate","text":"","title":"desktop_search_aggregates_by_userstate"},{"location":"moz-fx-data-shared-prod/search/#view_7","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.desktop_search_aggregates_by_userstate` AS SELECT * FROM `moz-fx-data-shared-prod.search_derived.desktop_search_aggregates_by_userstate_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#search_clients_daily","text":"","title":"search_clients_daily"},{"location":"moz-fx-data-shared-prod/search/#view_8","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_clients_daily` AS SELECT submission_date AS submission_date_s3, * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, FROM `moz-fx-data-shared-prod.search_derived.search_clients_daily_v8`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#search_clients_last_seen_v1","text":"","title":"search_clients_last_seen_v1"},{"location":"moz-fx-data-shared-prod/search/#view_9","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_clients_last_seen_v1` AS SELECT * EXCEPT (total_searches), `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen(days_seen_bytes) AS days_since_seen, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen(days_searched_bytes) AS days_since_searched, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen( days_tagged_searched_bytes ) AS days_since_tagged_searched, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen( days_searched_with_ads_bytes ) AS days_since_searched_with_ads, `moz-fx-data-shared-prod`.udf.bits_to_days_since_seen( days_clicked_ads_bytes ) AS days_since_clicked_ad, `moz-fx-data-shared-prod`.udf.bits_to_days_since_first_seen( days_created_profile_bytes ) AS days_since_created_profile FROM `moz-fx-data-shared-prod.search_derived.search_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/search/#search_aggregates","text":"","title":"search_aggregates"},{"location":"moz-fx-data-shared-prod/search/#view_10","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.search.search_aggregates` AS SELECT submission_date AS submission_date_s3, * EXCEPT (normalized_engine), `moz-fx-data-shared-prod`.udf.normalize_search_engine(engine) AS normalized_engine, FROM `moz-fx-data-shared-prod.search_derived.search_aggregates_v8`","title":"View"},{"location":"moz-fx-data-shared-prod/static/","text":"normal_distribution country_names_v1 third_party_standardized_country_names normalized_os_name country_codes_v1 normalized_os_version fxa_amplitude_export_users_daily fxa_amplitude_export_users_last_seen","title":"static"},{"location":"moz-fx-data-shared-prod/static/#normal_distribution","text":"","title":"normal_distribution"},{"location":"moz-fx-data-shared-prod/static/#country_names_v1","text":"","title":"country_names_v1"},{"location":"moz-fx-data-shared-prod/static/#third_party_standardized_country_names","text":"","title":"third_party_standardized_country_names"},{"location":"moz-fx-data-shared-prod/static/#normalized_os_name","text":"","title":"normalized_os_name"},{"location":"moz-fx-data-shared-prod/static/#country_codes_v1","text":"","title":"country_codes_v1"},{"location":"moz-fx-data-shared-prod/static/#normalized_os_version","text":"","title":"normalized_os_version"},{"location":"moz-fx-data-shared-prod/static/#fxa_amplitude_export_users_daily","text":"","title":"fxa_amplitude_export_users_daily"},{"location":"moz-fx-data-shared-prod/static/#fxa_amplitude_export_users_last_seen","text":"","title":"fxa_amplitude_export_users_last_seen"},{"location":"moz-fx-data-shared-prod/stripe/","text":"customers View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.customers` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.customers_v1 plan View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.plans` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.plans_v1 product View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.products` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.products_v1 subscription View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.subscriptions` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.subscriptions_v1","title":"stripe"},{"location":"moz-fx-data-shared-prod/stripe/#customers","text":"","title":"customers"},{"location":"moz-fx-data-shared-prod/stripe/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.customers` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.customers_v1","title":"View"},{"location":"moz-fx-data-shared-prod/stripe/#plan","text":"","title":"plan"},{"location":"moz-fx-data-shared-prod/stripe/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.plans` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.plans_v1","title":"View"},{"location":"moz-fx-data-shared-prod/stripe/#product","text":"","title":"product"},{"location":"moz-fx-data-shared-prod/stripe/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.products` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.products_v1","title":"View"},{"location":"moz-fx-data-shared-prod/stripe/#subscription","text":"","title":"subscription"},{"location":"moz-fx-data-shared-prod/stripe/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.stripe.subscriptions` AS SELECT * FROM `moz-fx-data-shared-prod`.stripe_derived.subscriptions_v1","title":"View"},{"location":"moz-fx-data-shared-prod/stripe_external/","text":"plans_v1 Metadata Friendly name : Stripe Plans Description : Stripe Plans as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe invoices_v1 Metadata Friendly name : Stripe Invoices Description : Stripe Invoices as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe customers_v1 Metadata Friendly name : Stripe Customers Description : Stripe Customers as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe setup_intents_v1 Metadata Friendly name : Stripe Setup Intents Description : Stripe Setup Intents as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe prices_v1 Metadata Friendly name : Stripe Prices Description : Stripe Prices as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe credit_notes_v1 Metadata Friendly name : Stripe Credit Notes Description : Stripe Credit Notes as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe disputes_v1 Metadata Friendly name : Stripe Disputes Description : Stripe Disputes as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe products_v1 Metadata Friendly name : Stripe Products Description : Stripe Products as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe payment_intents_v1 Metadata Friendly name : Stripe Payment Intents Description : Stripe Payment Intents as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe charges_v1 Metadata Friendly name : Stripe Charges Description : Stripe Charges as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe subscriptions_v1 Metadata Friendly name : Stripe Subscriptions Description : Stripe Subscriptions as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe payouts_v1 Metadata Friendly name : Stripe Payouts Description : Stripe Payouts as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"stripe_external"},{"location":"moz-fx-data-shared-prod/stripe_external/#plans_v1","text":"","title":"plans_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata","text":"Friendly name : Stripe Plans Description : Stripe Plans as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#invoices_v1","text":"","title":"invoices_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_1","text":"Friendly name : Stripe Invoices Description : Stripe Invoices as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#customers_v1","text":"","title":"customers_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_2","text":"Friendly name : Stripe Customers Description : Stripe Customers as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#setup_intents_v1","text":"","title":"setup_intents_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_3","text":"Friendly name : Stripe Setup Intents Description : Stripe Setup Intents as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#prices_v1","text":"","title":"prices_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_4","text":"Friendly name : Stripe Prices Description : Stripe Prices as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#credit_notes_v1","text":"","title":"credit_notes_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_5","text":"Friendly name : Stripe Credit Notes Description : Stripe Credit Notes as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#disputes_v1","text":"","title":"disputes_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_6","text":"Friendly name : Stripe Disputes Description : Stripe Disputes as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#products_v1","text":"","title":"products_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_7","text":"Friendly name : Stripe Products Description : Stripe Products as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#payment_intents_v1","text":"","title":"payment_intents_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_8","text":"Friendly name : Stripe Payment Intents Description : Stripe Payment Intents as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#charges_v1","text":"","title":"charges_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_9","text":"Friendly name : Stripe Charges Description : Stripe Charges as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#subscriptions_v1","text":"","title":"subscriptions_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_10","text":"Friendly name : Stripe Subscriptions Description : Stripe Subscriptions as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/stripe_external/#payouts_v1","text":"","title":"payouts_v1"},{"location":"moz-fx-data-shared-prod/stripe_external/#metadata_11","text":"Friendly name : Stripe Payouts Description : Stripe Payouts as of UTC midnight Owners : dthorn@mozilla.com Schedule : daily DAG name : bqetl_stripe","title":"Metadata"},{"location":"moz-fx-data-shared-prod/telemetry/","text":"firefox_nondesktop_exact_mau28_by_dimensions_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` AS SELECT raw.*, COALESCE(cc.name, raw.country) AS country_name FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_nondesktop_exact_mau28_v1` AS raw LEFT JOIN `moz-fx-data-shared-prod.static.country_codes_v1` cc ON (raw.country = cc.code) experiment_error_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_error_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_error_aggregates_v1` nondesktop_clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.nondesktop_clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.nondesktop_clients_last_seen_v1` experiment_enrollment_daily_active_population View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_daily_active_population` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_daily_active_population_v1` clients_probe_processes View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.client_probe_processes` AS SELECT metric, os, channel, ARRAY_AGG(DISTINCT(process)) AS processes, FROM `moz-fx-data-shared-prod.telemetry_derived.client_probe_counts_v1` GROUP BY metric, os, channel ORDER BY metric, os addon_names View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addon_names` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.addon_names_v1` addons_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addons_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.addons_daily_v1` lockwise_mobile_events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.lockwise_mobile_events` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.lockwise_mobile_events_v1` firefox_nondesktop_exact_mau28_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_v1` AS SELECT submission_date, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), mau, 0)) AS tier1_mau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), wau, 0)) AS tier1_wau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), dau, 0)) AS tier1_dau FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` GROUP BY submission_date crash_aggregates_v1 View -- Query generated by: templates/unnest_parquet_view.sql.py crash_aggregates_v1 telemetry_derived.crash_aggregates_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_aggregates_v1` AS SELECT * REPLACE (dimensions.key_value AS dimensions, stats.key_value AS stats) FROM `moz-fx-data-shared-prod.telemetry_derived.crash_aggregates_v1` clients_first_seen Metadata Friendly name : Clients first seen Description : Identical in schema to clients_daily except that each client appears only once over all time; includes fields first_seen_date and second_seen_date for determining user \"activation\" Owners : jklukas@mozilla.com View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_first_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_first_seen_v1` telemetry_ip_privacy_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_ip_privacy_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_ip_privacy_parquet_v1` telemetry_downgrade_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_downgrade_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_downgrade_parquet_v1` firefox_nondesktop_exact_mau28 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_v1` firefox_nondesktop_exact_mau28_by_client_count_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_client_count_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_nondesktop_exact_mau28_by_client_count_dimensions_v1` clients_histogram_aggregates_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_histogram_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_histogram_aggregates_v1` telemetry_ip_privacy View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_ip_privacy` AS SELECT DATE(submission_timestamp) AS submission_date, * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_ip_privacy_v2` core View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core` AS WITH unioned AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v3` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v4` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v5` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v6` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v7` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v8` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v9` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v10` ) -- SELECT * REPLACE ( -- The pipeline ensures lowercase client_id since 2020-01-10, but we apply -- LOWER here to provide continuity for older data that still contains -- some uppercase IDs; see https://github.com/mozilla/gcp-ingestion/pull/1069 LOWER(client_id) AS client_id, `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata ) FROM unioned firefox_nondesktop_exact_mau28_by_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` crash_summary View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_summary` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.crash_summary_v2` smoot_usage_day_0 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.smoot_usage_day_0` AS WITH unioned AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_desktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_nondesktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_fxa_v2` ) -- SELECT submission_date AS `date`, usage, metrics.day_0.*, * EXCEPT (submission_date, usage, metrics) FROM unioned UNION ALL SELECT DATE_SUB(submission_date, INTERVAL 6 DAY) AS `date`, usage, new_profiles AS dau, NULL AS wau, NULL AS mau, NULL AS active_days_in_week, * EXCEPT (submission_date, usage, new_profiles) FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_new_profiles_v2` crash_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.crash_aggregates_v1` focus_event View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.focus_event` AS SELECT * REPLACE ( -- The pipeline ensures lowercase client_id since 2020-01-10, but we apply -- LOWER here to provide continuity for older data that still contains -- some uppercase IDs; see https://github.com/mozilla/gcp-ingestion/pull/1069 LOWER(client_id) AS client_id, `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata ) FROM `moz-fx-data-shared-prod.telemetry_stable.focus_event_v1` experiment_cumulative_search_with_ads_count View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_cumulative_search_with_ads_count` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_cumulative_search_with_ads_count_v1` clients_daily_scalar_aggregates_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily_scalar_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_daily_scalar_aggregates_v1` experiment_search_aggregates_hourly View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_search_aggregates_hourly` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_search_aggregates_hourly_v1` telemetry_shield_study_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_shield_study_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_shield_study_parquet_v1` experiments_v1 View -- Query generated by: templates/unnest_parquet_view.sql.py experiments_v1 telemetry_derived.experiments_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments_v1` AS SELECT submission_date AS submission_date_s3, * REPLACE ( ARRAY(SELECT * FROM UNNEST(active_addons.list)) AS active_addons, ARRAY(SELECT * FROM UNNEST(antispyware.list)) AS antispyware, ARRAY(SELECT * FROM UNNEST(antivirus.list)) AS antivirus, boolean_addon_scalars.key_value AS boolean_addon_scalars, ARRAY(SELECT * FROM UNNEST(disabled_addons_ids.list)) AS disabled_addons_ids, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_accept_languages.list) ) AS environment_settings_intl_accept_languages, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_app_locales.list) ) AS environment_settings_intl_app_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_available_locales.list) ) AS environment_settings_intl_available_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_regional_prefs_locales.list) ) AS environment_settings_intl_regional_prefs_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_requested_locales.list) ) AS environment_settings_intl_requested_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_system_locales.list) ) AS environment_settings_intl_system_locales, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (_0.element.map_values.key_value AS map_values) FROM UNNEST(events.list) AS _0 ) AS events, experiments.key_value AS experiments, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(experiments_details.key_value) AS _0 ) AS experiments_details, ARRAY(SELECT * FROM UNNEST(firewall.list)) AS firewall, histogram_content_cert_validation_success_by_ca.key_value AS histogram_content_cert_validation_success_by_ca, histogram_content_checkerboard_severity.key_value AS histogram_content_checkerboard_severity, histogram_content_composite_time.key_value AS histogram_content_composite_time, histogram_content_content_paint_time.key_value AS histogram_content_content_paint_time, histogram_content_cycle_collector_max_pause.key_value AS histogram_content_cycle_collector_max_pause, histogram_content_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_content_devtools_accessibility_picker_time_active_seconds, histogram_content_devtools_accessibility_service_time_active_seconds.key_value AS histogram_content_devtools_accessibility_service_time_active_seconds, histogram_content_devtools_accessibility_time_active_seconds.key_value AS histogram_content_devtools_accessibility_time_active_seconds, histogram_content_devtools_toolbox_time_active_seconds.key_value AS histogram_content_devtools_toolbox_time_active_seconds, histogram_content_fx_new_window_ms.key_value AS histogram_content_fx_new_window_ms, histogram_content_fx_page_load_ms_2.key_value AS histogram_content_fx_page_load_ms_2, histogram_content_fx_searchbar_selected_result_method.key_value AS histogram_content_fx_searchbar_selected_result_method, histogram_content_fx_session_restore_restore_window_ms.key_value AS histogram_content_fx_session_restore_restore_window_ms, histogram_content_fx_session_restore_startup_init_session_ms.key_value AS histogram_content_fx_session_restore_startup_init_session_ms, histogram_content_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_content_fx_session_restore_startup_onload_initial_window_ms, histogram_content_fx_tab_close_time_anim_ms.key_value AS histogram_content_fx_tab_close_time_anim_ms, histogram_content_fx_tab_switch_update_ms.key_value AS histogram_content_fx_tab_switch_update_ms, histogram_content_fx_urlbar_selected_result_index.key_value AS histogram_content_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_content_fx_urlbar_selected_result_index_by_type, histogram_content_fx_urlbar_selected_result_method.key_value AS histogram_content_fx_urlbar_selected_result_method, histogram_content_fx_urlbar_selected_result_type.key_value AS histogram_content_fx_urlbar_selected_result_type, histogram_content_gc_animation_ms.key_value AS histogram_content_gc_animation_ms, histogram_content_gc_max_pause_ms.key_value AS histogram_content_gc_max_pause_ms, histogram_content_gc_max_pause_ms_2.key_value AS histogram_content_gc_max_pause_ms_2, histogram_content_geolocation_request_granted.key_value AS histogram_content_geolocation_request_granted, histogram_content_ghost_windows.key_value AS histogram_content_ghost_windows, histogram_content_gpu_process_initialization_time_ms.key_value AS histogram_content_gpu_process_initialization_time_ms, histogram_content_gpu_process_launch_time_ms_2.key_value AS histogram_content_gpu_process_launch_time_ms_2, histogram_content_http_channel_disposition.key_value AS histogram_content_http_channel_disposition, histogram_content_http_pageload_is_ssl.key_value AS histogram_content_http_pageload_is_ssl, histogram_content_http_transaction_is_ssl.key_value AS histogram_content_http_transaction_is_ssl, histogram_content_input_event_response_coalesced_ms.key_value AS histogram_content_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_content_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_memory_distribution_among_content.key_value) AS _0 ) AS histogram_content_memory_distribution_among_content, histogram_content_memory_heap_allocated.key_value AS histogram_content_memory_heap_allocated, histogram_content_memory_resident_fast.key_value AS histogram_content_memory_resident_fast, histogram_content_memory_total.key_value AS histogram_content_memory_total, histogram_content_memory_unique.key_value AS histogram_content_memory_unique, histogram_content_memory_unique_content_startup.key_value AS histogram_content_memory_unique_content_startup, histogram_content_memory_vsize.key_value AS histogram_content_memory_vsize, histogram_content_memory_vsize_max_contiguous.key_value AS histogram_content_memory_vsize_max_contiguous, histogram_content_network_cache_metadata_first_read_time_ms.key_value AS histogram_content_network_cache_metadata_first_read_time_ms, histogram_content_network_cache_v2_hit_time_ms.key_value AS histogram_content_network_cache_v2_hit_time_ms, histogram_content_network_cache_v2_miss_time_ms.key_value AS histogram_content_network_cache_v2_miss_time_ms, histogram_content_places_autocomplete_6_first_results_time_ms.key_value AS histogram_content_places_autocomplete_6_first_results_time_ms, histogram_content_plugin_shutdown_ms.key_value AS histogram_content_plugin_shutdown_ms, histogram_content_pwmgr_form_autofill_result.key_value AS histogram_content_pwmgr_form_autofill_result, histogram_content_pwmgr_login_page_safety.key_value AS histogram_content_pwmgr_login_page_safety, histogram_content_sandbox_rejected_syscalls.key_value AS histogram_content_sandbox_rejected_syscalls, histogram_content_search_reset_result.key_value AS histogram_content_search_reset_result, histogram_content_search_service_init_ms.key_value AS histogram_content_search_service_init_ms, histogram_content_ssl_handshake_result.key_value AS histogram_content_ssl_handshake_result, histogram_content_ssl_handshake_version.key_value AS histogram_content_ssl_handshake_version, histogram_content_ssl_tls12_intolerance_reason_pre.key_value AS histogram_content_ssl_tls12_intolerance_reason_pre, histogram_content_ssl_tls13_intolerance_reason_pre.key_value AS histogram_content_ssl_tls13_intolerance_reason_pre, histogram_content_time_to_dom_complete_ms.key_value AS histogram_content_time_to_dom_complete_ms, histogram_content_time_to_dom_content_loaded_end_ms.key_value AS histogram_content_time_to_dom_content_loaded_end_ms, histogram_content_time_to_dom_content_loaded_start_ms.key_value AS histogram_content_time_to_dom_content_loaded_start_ms, histogram_content_time_to_dom_interactive_ms.key_value AS histogram_content_time_to_dom_interactive_ms, histogram_content_time_to_dom_loading_ms.key_value AS histogram_content_time_to_dom_loading_ms, histogram_content_time_to_first_click_ms.key_value AS histogram_content_time_to_first_click_ms, histogram_content_time_to_first_interaction_ms.key_value AS histogram_content_time_to_first_interaction_ms, histogram_content_time_to_first_key_input_ms.key_value AS histogram_content_time_to_first_key_input_ms, histogram_content_time_to_first_mouse_move_ms.key_value AS histogram_content_time_to_first_mouse_move_ms, histogram_content_time_to_first_scroll_ms.key_value AS histogram_content_time_to_first_scroll_ms, histogram_content_time_to_load_event_end_ms.key_value AS histogram_content_time_to_load_event_end_ms, histogram_content_time_to_load_event_start_ms.key_value AS histogram_content_time_to_load_event_start_ms, histogram_content_time_to_non_blank_paint_ms.key_value AS histogram_content_time_to_non_blank_paint_ms, histogram_content_time_to_response_start_ms.key_value AS histogram_content_time_to_response_start_ms, histogram_content_tracking_protection_enabled.key_value AS histogram_content_tracking_protection_enabled, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_content_uptake_remote_content_result_1, histogram_content_webext_content_script_injection_ms.key_value AS histogram_content_webext_content_script_injection_ms, histogram_content_webext_storage_local_get_ms.key_value AS histogram_content_webext_storage_local_get_ms, histogram_content_webext_storage_local_set_ms.key_value AS histogram_content_webext_storage_local_set_ms, histogram_content_webvr_time_spent_viewing_in_2d.key_value AS histogram_content_webvr_time_spent_viewing_in_2d, histogram_content_webvr_users_view_in.key_value AS histogram_content_webvr_users_view_in, histogram_gpu_checkerboard_severity.key_value AS histogram_gpu_checkerboard_severity, histogram_gpu_composite_time.key_value AS histogram_gpu_composite_time, histogram_gpu_content_frame_time.key_value AS histogram_gpu_content_frame_time, histogram_gpu_gpu_process_initialization_time_ms.key_value AS histogram_gpu_gpu_process_initialization_time_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_gpu_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_gpu_uptake_remote_content_result_1, histogram_gpu_webvr_time_spent_viewing_in_oculus.key_value AS histogram_gpu_webvr_time_spent_viewing_in_oculus, histogram_gpu_webvr_time_spent_viewing_in_openvr.key_value AS histogram_gpu_webvr_time_spent_viewing_in_openvr, histogram_gpu_webvr_users_view_in.key_value AS histogram_gpu_webvr_users_view_in, histogram_parent_a11y_consumers.key_value AS histogram_parent_a11y_consumers, histogram_parent_a11y_instantiated_flag.key_value AS histogram_parent_a11y_instantiated_flag, histogram_parent_cert_validation_success_by_ca.key_value AS histogram_parent_cert_validation_success_by_ca, histogram_parent_checkerboard_severity.key_value AS histogram_parent_checkerboard_severity, histogram_parent_composite_time.key_value AS histogram_parent_composite_time, histogram_parent_content_frame_time.key_value AS histogram_parent_content_frame_time, histogram_parent_content_paint_time.key_value AS histogram_parent_content_paint_time, histogram_parent_cookie_behavior.key_value AS histogram_parent_cookie_behavior, histogram_parent_cycle_collector_max_pause.key_value AS histogram_parent_cycle_collector_max_pause, histogram_parent_devtools_about_devtools_opened_key.key_value AS histogram_parent_devtools_about_devtools_opened_key, histogram_parent_devtools_about_devtools_opened_reason.key_value AS histogram_parent_devtools_about_devtools_opened_reason, histogram_parent_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_picker_time_active_seconds, histogram_parent_devtools_accessibility_service_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_service_time_active_seconds, histogram_parent_devtools_accessibility_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_time_active_seconds, histogram_parent_devtools_entry_point.key_value AS histogram_parent_devtools_entry_point, histogram_parent_devtools_fonteditor_font_type_displayed.key_value AS histogram_parent_devtools_fonteditor_font_type_displayed, histogram_parent_devtools_fonteditor_n_font_axes.key_value AS histogram_parent_devtools_fonteditor_n_font_axes, histogram_parent_devtools_fonteditor_n_fonts_rendered.key_value AS histogram_parent_devtools_fonteditor_n_fonts_rendered, histogram_parent_devtools_toolbox_time_active_seconds.key_value AS histogram_parent_devtools_toolbox_time_active_seconds, histogram_parent_dns_failed_lookup_time.key_value AS histogram_parent_dns_failed_lookup_time, histogram_parent_dns_lookup_time.key_value AS histogram_parent_dns_lookup_time, histogram_parent_fx_new_window_ms.key_value AS histogram_parent_fx_new_window_ms, histogram_parent_fx_page_load_ms_2.key_value AS histogram_parent_fx_page_load_ms_2, histogram_parent_fx_searchbar_selected_result_method.key_value AS histogram_parent_fx_searchbar_selected_result_method, histogram_parent_fx_session_restore_restore_window_ms.key_value AS histogram_parent_fx_session_restore_restore_window_ms, histogram_parent_fx_session_restore_startup_init_session_ms.key_value AS histogram_parent_fx_session_restore_startup_init_session_ms, histogram_parent_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_parent_fx_session_restore_startup_onload_initial_window_ms, histogram_parent_fx_tab_close_time_anim_ms.key_value AS histogram_parent_fx_tab_close_time_anim_ms, histogram_parent_fx_tab_switch_total_e10s_ms.key_value AS histogram_parent_fx_tab_switch_total_e10s_ms, histogram_parent_fx_tab_switch_update_ms.key_value AS histogram_parent_fx_tab_switch_update_ms, histogram_parent_fx_urlbar_selected_result_index.key_value AS histogram_parent_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_parent_fx_urlbar_selected_result_index_by_type, histogram_parent_fx_urlbar_selected_result_method.key_value AS histogram_parent_fx_urlbar_selected_result_method, histogram_parent_fx_urlbar_selected_result_type.key_value AS histogram_parent_fx_urlbar_selected_result_type, histogram_parent_gc_animation_ms.key_value AS histogram_parent_gc_animation_ms, histogram_parent_gc_max_pause_ms.key_value AS histogram_parent_gc_max_pause_ms, histogram_parent_gc_max_pause_ms_2.key_value AS histogram_parent_gc_max_pause_ms_2, histogram_parent_geolocation_request_granted.key_value AS histogram_parent_geolocation_request_granted, histogram_parent_ghost_windows.key_value AS histogram_parent_ghost_windows, histogram_parent_gpu_process_initialization_time_ms.key_value AS histogram_parent_gpu_process_initialization_time_ms, histogram_parent_gpu_process_launch_time_ms_2.key_value AS histogram_parent_gpu_process_launch_time_ms_2, histogram_parent_http_channel_disposition.key_value AS histogram_parent_http_channel_disposition, histogram_parent_http_pageload_is_ssl.key_value AS histogram_parent_http_pageload_is_ssl, histogram_parent_http_transaction_is_ssl.key_value AS histogram_parent_http_transaction_is_ssl, histogram_parent_input_event_response_coalesced_ms.key_value AS histogram_parent_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_parent_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_memory_distribution_among_content.key_value) AS _0 ) AS histogram_parent_memory_distribution_among_content, histogram_parent_memory_heap_allocated.key_value AS histogram_parent_memory_heap_allocated, histogram_parent_memory_resident_fast.key_value AS histogram_parent_memory_resident_fast, histogram_parent_memory_total.key_value AS histogram_parent_memory_total, histogram_parent_memory_unique.key_value AS histogram_parent_memory_unique, histogram_parent_memory_vsize.key_value AS histogram_parent_memory_vsize, histogram_parent_memory_vsize_max_contiguous.key_value AS histogram_parent_memory_vsize_max_contiguous, histogram_parent_network_cache_metadata_first_read_time_ms.key_value AS histogram_parent_network_cache_metadata_first_read_time_ms, histogram_parent_network_cache_v2_hit_time_ms.key_value AS histogram_parent_network_cache_v2_hit_time_ms, histogram_parent_network_cache_v2_miss_time_ms.key_value AS histogram_parent_network_cache_v2_miss_time_ms, histogram_parent_places_autocomplete_6_first_results_time_ms.key_value AS histogram_parent_places_autocomplete_6_first_results_time_ms, histogram_parent_plugin_shutdown_ms.key_value AS histogram_parent_plugin_shutdown_ms, histogram_parent_pwmgr_blocklist_num_sites.key_value AS histogram_parent_pwmgr_blocklist_num_sites, histogram_parent_pwmgr_form_autofill_result.key_value AS histogram_parent_pwmgr_form_autofill_result, histogram_parent_pwmgr_login_last_used_days.key_value AS histogram_parent_pwmgr_login_last_used_days, histogram_parent_pwmgr_login_page_safety.key_value AS histogram_parent_pwmgr_login_page_safety, histogram_parent_pwmgr_manage_opened.key_value AS histogram_parent_pwmgr_manage_opened, histogram_parent_pwmgr_manage_visibility_toggled.key_value AS histogram_parent_pwmgr_manage_visibility_toggled, histogram_parent_pwmgr_num_passwords_per_hostname.key_value AS histogram_parent_pwmgr_num_passwords_per_hostname, histogram_parent_pwmgr_num_saved_passwords.key_value AS histogram_parent_pwmgr_num_saved_passwords, histogram_parent_pwmgr_prompt_remember_action.key_value AS histogram_parent_pwmgr_prompt_remember_action, histogram_parent_pwmgr_prompt_update_action.key_value AS histogram_parent_pwmgr_prompt_update_action, histogram_parent_pwmgr_saving_enabled.key_value AS histogram_parent_pwmgr_saving_enabled, histogram_parent_sandbox_rejected_syscalls.key_value AS histogram_parent_sandbox_rejected_syscalls, histogram_parent_search_reset_result.key_value AS histogram_parent_search_reset_result, histogram_parent_search_service_init_ms.key_value AS histogram_parent_search_service_init_ms, histogram_parent_ssl_handshake_result.key_value AS histogram_parent_ssl_handshake_result, histogram_parent_ssl_handshake_version.key_value AS histogram_parent_ssl_handshake_version, histogram_parent_ssl_tls12_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls12_intolerance_reason_pre, histogram_parent_ssl_tls13_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls13_intolerance_reason_pre, histogram_parent_time_to_first_click_ms.key_value AS histogram_parent_time_to_first_click_ms, histogram_parent_time_to_first_interaction_ms.key_value AS histogram_parent_time_to_first_interaction_ms, histogram_parent_time_to_first_key_input_ms.key_value AS histogram_parent_time_to_first_key_input_ms, histogram_parent_time_to_first_mouse_move_ms.key_value AS histogram_parent_time_to_first_mouse_move_ms, histogram_parent_time_to_first_scroll_ms.key_value AS histogram_parent_time_to_first_scroll_ms, histogram_parent_time_to_non_blank_paint_ms.key_value AS histogram_parent_time_to_non_blank_paint_ms, histogram_parent_time_to_response_start_ms.key_value AS histogram_parent_time_to_response_start_ms, histogram_parent_touch_enabled_device.key_value AS histogram_parent_touch_enabled_device, histogram_parent_tracking_protection_enabled.key_value AS histogram_parent_tracking_protection_enabled, histogram_parent_update_bits_result_complete.key_value AS histogram_parent_update_bits_result_complete, histogram_parent_update_bits_result_partial.key_value AS histogram_parent_update_bits_result_partial, histogram_parent_update_can_use_bits_notify.key_value AS histogram_parent_update_can_use_bits_notify, histogram_parent_update_download_code_complete.key_value AS histogram_parent_update_download_code_complete, histogram_parent_update_download_code_partial.key_value AS histogram_parent_update_download_code_partial, histogram_parent_update_state_code_complete_stage.key_value AS histogram_parent_update_state_code_complete_stage, histogram_parent_update_state_code_complete_startup.key_value AS histogram_parent_update_state_code_complete_startup, histogram_parent_update_state_code_partial_stage.key_value AS histogram_parent_update_state_code_partial_stage, histogram_parent_update_state_code_partial_startup.key_value AS histogram_parent_update_state_code_partial_startup, histogram_parent_update_status_error_code_complete_stage.key_value AS histogram_parent_update_status_error_code_complete_stage, histogram_parent_update_status_error_code_complete_startup.key_value AS histogram_parent_update_status_error_code_complete_startup, histogram_parent_update_status_error_code_partial_stage.key_value AS histogram_parent_update_status_error_code_partial_stage, histogram_parent_update_status_error_code_partial_startup.key_value AS histogram_parent_update_status_error_code_partial_startup, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_parent_uptake_remote_content_result_1, histogram_parent_webext_background_page_load_ms.key_value AS histogram_parent_webext_background_page_load_ms, histogram_parent_webext_browseraction_popup_open_ms.key_value AS histogram_parent_webext_browseraction_popup_open_ms, histogram_parent_webext_browseraction_popup_preload_result_count.key_value AS histogram_parent_webext_browseraction_popup_preload_result_count, histogram_parent_webext_content_script_injection_ms.key_value AS histogram_parent_webext_content_script_injection_ms, histogram_parent_webext_extension_startup_ms.key_value AS histogram_parent_webext_extension_startup_ms, histogram_parent_webext_pageaction_popup_open_ms.key_value AS histogram_parent_webext_pageaction_popup_open_ms, histogram_parent_webext_storage_local_get_ms.key_value AS histogram_parent_webext_storage_local_get_ms, histogram_parent_webext_storage_local_set_ms.key_value AS histogram_parent_webext_storage_local_set_ms, histogram_parent_webvr_time_spent_viewing_in_2d.key_value AS histogram_parent_webvr_time_spent_viewing_in_2d, histogram_parent_webvr_time_spent_viewing_in_oculus.key_value AS histogram_parent_webvr_time_spent_viewing_in_oculus, histogram_parent_webvr_time_spent_viewing_in_openvr.key_value AS histogram_parent_webvr_time_spent_viewing_in_openvr, histogram_parent_webvr_users_view_in.key_value AS histogram_parent_webvr_users_view_in, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_boolean_addon_scalars.key_value) AS _0 ) AS keyed_boolean_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_string_addon_scalars.key_value) AS _0 ) AS keyed_string_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_uint_addon_scalars.key_value) AS _0 ) AS keyed_uint_addon_scalars, popup_notification_stats.key_value AS popup_notification_stats, scalar_content_dom_event_confluence_load_count.key_value AS scalar_content_dom_event_confluence_load_count, scalar_content_dom_event_office_online_load_count.key_value AS scalar_content_dom_event_office_online_load_count, scalar_content_gfx_small_paint_phase_weight.key_value AS scalar_content_gfx_small_paint_phase_weight, scalar_content_images_webp_content_frequency.key_value AS scalar_content_images_webp_content_frequency, scalar_content_pictureinpicture_opened_method.key_value AS scalar_content_pictureinpicture_opened_method, scalar_content_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_content_telemetry_accumulate_unknown_histogram_keys, scalar_content_telemetry_event_counts.key_value AS scalar_content_telemetry_event_counts, scalar_content_webrtc_sdp_parser_diff.key_value AS scalar_content_webrtc_sdp_parser_diff, scalar_content_webrtc_video_recv_codec_used.key_value AS scalar_content_webrtc_video_recv_codec_used, scalar_content_webrtc_video_send_codec_used.key_value AS scalar_content_webrtc_video_send_codec_used, scalar_gpu_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_gpu_telemetry_accumulate_unknown_histogram_keys, scalar_gpu_telemetry_event_counts.key_value AS scalar_gpu_telemetry_event_counts, scalar_parent_a11y_theme.key_value AS scalar_parent_a11y_theme, scalar_parent_browser_engagement_navigation_about_home.key_value AS scalar_parent_browser_engagement_navigation_about_home, scalar_parent_browser_engagement_navigation_about_newtab.key_value AS scalar_parent_browser_engagement_navigation_about_newtab, scalar_parent_browser_engagement_navigation_contextmenu.key_value AS scalar_parent_browser_engagement_navigation_contextmenu, scalar_parent_browser_engagement_navigation_searchbar.key_value AS scalar_parent_browser_engagement_navigation_searchbar, scalar_parent_browser_engagement_navigation_urlbar.key_value AS scalar_parent_browser_engagement_navigation_urlbar, scalar_parent_browser_engagement_navigation_webextension.key_value AS scalar_parent_browser_engagement_navigation_webextension, scalar_parent_browser_errors_collected_count_by_filename.key_value AS scalar_parent_browser_errors_collected_count_by_filename, scalar_parent_browser_search_ad_clicks.key_value AS scalar_parent_browser_search_ad_clicks, scalar_parent_browser_search_with_ads.key_value AS scalar_parent_browser_search_with_ads, scalar_parent_devtools_accessibility_accessible_context_menu_item_activated.key_value AS scalar_parent_devtools_accessibility_accessible_context_menu_item_activated, scalar_parent_devtools_accessibility_audit_activated.key_value AS scalar_parent_devtools_accessibility_audit_activated, scalar_parent_devtools_accessibility_select_accessible_for_node.key_value AS scalar_parent_devtools_accessibility_select_accessible_for_node, scalar_parent_devtools_accessibility_simulation_activated.key_value AS scalar_parent_devtools_accessibility_simulation_activated, scalar_parent_devtools_current_theme.key_value AS scalar_parent_devtools_current_theme, scalar_parent_devtools_inspector_three_pane_enabled.key_value AS scalar_parent_devtools_inspector_three_pane_enabled, scalar_parent_devtools_responsive_open_trigger.key_value AS scalar_parent_devtools_responsive_open_trigger, scalar_parent_devtools_tool_registered.key_value AS scalar_parent_devtools_tool_registered, scalar_parent_devtools_toolbox_tabs_reordered.key_value AS scalar_parent_devtools_toolbox_tabs_reordered, scalar_parent_devtools_tooltip_shown.key_value AS scalar_parent_devtools_tooltip_shown, scalar_parent_extensions_updates_rdf.key_value AS scalar_parent_extensions_updates_rdf, scalar_parent_gfx_advanced_layers_failure_id.key_value AS scalar_parent_gfx_advanced_layers_failure_id, scalar_parent_images_webp_content_frequency.key_value AS scalar_parent_images_webp_content_frequency, scalar_parent_networking_data_transferred.key_value AS scalar_parent_networking_data_transferred, scalar_parent_networking_data_transferred_kb.key_value AS scalar_parent_networking_data_transferred_kb, scalar_parent_networking_data_transferred_v3_kb.key_value AS scalar_parent_networking_data_transferred_v3_kb, scalar_parent_normandy_recipe_freshness.key_value AS scalar_parent_normandy_recipe_freshness, scalar_parent_pictureinpicture_closed_method.key_value AS scalar_parent_pictureinpicture_closed_method, scalar_parent_preferences_browser_home_page_change.key_value AS scalar_parent_preferences_browser_home_page_change, scalar_parent_preferences_browser_home_page_count.key_value AS scalar_parent_preferences_browser_home_page_count, scalar_parent_preferences_search_query.key_value AS scalar_parent_preferences_search_query, scalar_parent_preferences_use_bookmark.key_value AS scalar_parent_preferences_use_bookmark, scalar_parent_preferences_use_current_page.key_value AS scalar_parent_preferences_use_current_page, scalar_parent_qm_origin_directory_unexpected_filename.key_value AS scalar_parent_qm_origin_directory_unexpected_filename, scalar_parent_resistfingerprinting_content_window_size.key_value AS scalar_parent_resistfingerprinting_content_window_size, scalar_parent_sandbox_no_job.key_value AS scalar_parent_sandbox_no_job, scalar_parent_security_client_cert.key_value AS scalar_parent_security_client_cert, scalar_parent_security_contentblocker_permissions.key_value AS scalar_parent_security_contentblocker_permissions, scalar_parent_security_pkcs11_modules_loaded.key_value AS scalar_parent_security_pkcs11_modules_loaded, scalar_parent_security_webauthn_used.key_value AS scalar_parent_security_webauthn_used, scalar_parent_services_sync_sync_login_state_transitions.key_value AS scalar_parent_services_sync_sync_login_state_transitions, scalar_parent_storage_sync_api_usage_items_stored.key_value AS scalar_parent_storage_sync_api_usage_items_stored, scalar_parent_storage_sync_api_usage_storage_consumed.key_value AS scalar_parent_storage_sync_api_usage_storage_consumed, scalar_parent_telemetry_accumulate_clamped_values.key_value AS scalar_parent_telemetry_accumulate_clamped_values, scalar_parent_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_parent_telemetry_accumulate_unknown_histogram_keys, scalar_parent_telemetry_event_counts.key_value AS scalar_parent_telemetry_event_counts, scalar_parent_telemetry_keyed_scalars_exceed_limit.key_value AS scalar_parent_telemetry_keyed_scalars_exceed_limit, scalar_parent_update_binarytransparencyresult.key_value AS scalar_parent_update_binarytransparencyresult, scalar_parent_update_bitshresult.key_value AS scalar_parent_update_bitshresult, scalar_parent_widget_ime_name_on_linux.key_value AS scalar_parent_widget_ime_name_on_linux, scalar_parent_widget_ime_name_on_mac.key_value AS scalar_parent_widget_ime_name_on_mac, scalar_parent_widget_ime_name_on_windows.key_value AS scalar_parent_widget_ime_name_on_windows, ARRAY(SELECT * FROM UNNEST(search_counts.list)) AS search_counts, ssl_handshake_result.key_value AS ssl_handshake_result, string_addon_scalars.key_value AS string_addon_scalars, uint_addon_scalars.key_value AS uint_addon_scalars ), CAST(NULL AS STRING) AS experiment_enrollment_id FROM -- This table was called experiments_v1 in the moz-fx-data-derived-datasets -- project, but we renamed to v0 when copying to shared-prod so that we -- could maintain this query that unions the old and new structures. `moz-fx-data-shared-prod.telemetry_derived.experiments_v0` WHERE submission_date < '2019-12-04' UNION ALL SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.experiments_v1` WHERE submission_date >= '2019-12-04' addon_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addon_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.addon_aggregates_v2` firefox_accounts_exact_mau28_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_v1` AS SELECT submission_date, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, SUM(seen_in_tier1_country_mau) AS tier1_mau FROM `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions_v1` GROUP BY submission_date fenix_clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.fenix_clients_last_seen` AS -- For context on naming and channels of Fenix apps, see: -- https://docs.google.com/document/d/1Ym4eZyS0WngEP6WdwJjmCoxtoQbJSvORxlQwZpuSV2I/edit#heading=h.69hvvg35j8un WITH fenix_union AS ( SELECT *, 'org_mozilla_fenix' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_fenix.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_fenix_nightly' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_firefox' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_firefox.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_firefox_beta' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_firefox_beta.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_fennec_aurora' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_fennec_aurora.baseline_clients_last_seen` ), fenix_app_info AS ( SELECT *, mozfun.norm.fenix_app_info(_dataset, app_build) AS _app_info FROM fenix_union ) SELECT * EXCEPT (_dataset, _app_info) REPLACE(_app_info.channel AS normalized_channel), _app_info.app_name, FROM fenix_app_info experiment_enrollment_other_events_overall View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_other_events_overall` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_other_events_overall_v1` attitudes_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.attitudes_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.attitudes_daily_v1` telemetry_heartbeat_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_heartbeat_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_heartbeat_parquet_v1` main_summary View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_summary` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.main_summary_v4` asn_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.asn_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.asn_aggregates_v1` buildhub2 View -- This is an authorized view that allows us to read specific data from -- a project owned by CloudOps; if the definition here changes, -- it may need to be manually redeployed by Data Ops. CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.buildhub2` AS SELECT * FROM `moz-fx-buildhub2-prod-4784.build_metadata.buildhub2` telemetry_mobile_event_parquet_v2 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet_v2` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, metadata.uri.app_name, os, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id, metadata.uri.app_name, metadata.uri.app_version, sample_id, metadata.uri.app_update_channel ) AS metadata, v, client_id, seq, locale, osversion, device, arch, created, process_start_timestamp, tz, settings, ARRAY( SELECT AS STRUCT f0_ AS timestamp, f1_ AS category, f2_ AS method, f3_ AS object, f4_ AS value, f5_ AS extra FROM UNNEST(events)) AS events, experiments FROM `moz-fx-data-shared-prod.telemetry.mobile_event` telemetry_focus_event_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, metadata.uri.app_update_channel AS channel, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id, metadata.uri.app_name ) AS metadata, v, client_id, seq, locale, os, osversion, created, tz, settings, events, arch, device, process_start_timestamp, experiments FROM `moz-fx-data-shared-prod.telemetry.focus_event` clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.clients_last_seen_v1` experiments View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments` AS SELECT * EXCEPT ( scalar_content_webrtc_nicer_stun_retransmits, scalar_parent_devtools_aboutdevtools_noinstall_exits, scalar_parent_media_blocked_autoplay_no_audio_track_count, histogram_content_devtools_computedview_opened_count, histogram_content_pwmgr_manage_deleted, scalar_parent_devtools_changesview_contextmenu_copy, scalar_content_telemetry_process_creation_timestamp_inconsistent, scalar_parent_devtools_changesview_contextmenu_copy_rule, active_experiment_id, plugins_infobar_shown, scalar_parent_media_page_had_media_count, scalar_parent_webrtc_peerconnection_legacy_callback_stats_used, histogram_content_devtools_responsive_opened_count, histogram_parent_devtools_webaudioeditor_opened_count, histogram_content_pwmgr_manage_copied_password, scalar_content_sw_cors_res_for_so_req_count, scalar_parent_browser_errors_sample_rate, scalar_parent_browser_feeds_livebookmark_item_opened, scalar_parent_browser_session_restore_worker_restart_count, scalar_parent_formautofill_creditcards_fill_type_autofill_modified, histogram_content_devtools_netmonitor_opened_count, scalar_parent_encoding_override_used, scalar_parent_gfx_hdr_windows_display_colorspace_bitfield, scalar_parent_corroborate_system_addons_corrupted, scalar_parent_pdf_viewer_print, scalar_parent_datasanitization_network_cookie_lifetimepolicy, scalar_parent_webrtc_peerconnection_promise_and_callback_stats_used, scalar_parent_telemetry_about_telemetry_pageload, scalar_parent_devtools_changesview_copy, scalar_parent_networking_http_connections_captive_portal, plugins_infobar_block, scalar_parent_browser_errors_collected_with_stack_count, histogram_parent_devtools_developertoolbar_opened_count, histogram_content_devtools_picker_eyedropper_opened_count, histogram_content_devtools_shadereditor_opened_count, histogram_content_devtools_paintflashing_opened_count, web_notification_shown, scalar_parent_media_autoplay_would_be_allowed_count, scalar_parent_navigator_storage_persist_count, scalar_parent_media_blocked_no_metadata_endup_no_audio_track, scalar_parent_devtools_changesview_contextmenu_copy_declaration, scalar_parent_webrtc_peerconnection_datachannel_max_retx_used, plugins_infobar_dismissed, scalar_parent_aushelper_websense_reg_version, scalar_parent_browser_feeds_livebookmark_opened, histogram_content_devtools_scratchpad_window_opened_count, histogram_content_devtools_animationinspector_opened_count, histogram_content_devtools_inspector_opened_count, scalar_parent_security_tls_delegated_credentials_txn, scalar_parent_datasanitization_privacy_clearonshutdown_downloads, crashes_detected_content, scalar_content_webrtc_peerconnection_connected, scalar_parent_browser_usage_graphite, scalar_parent_preferences_read_user_js, histogram_content_devtools_developertoolbar_opened_count, scalar_parent_datasanitization_privacy_clearonshutdown_history, scalar_parent_datasanitization_session_permission_exceptions, scalar_parent_telemetry_profile_directory_scans, histogram_content_devtools_custom_opened_count, histogram_content_devtools_menu_eyedropper_opened_count, histogram_content_devtools_jsprofiler_opened_count, scalar_content_webrtc_hostnameobfuscation_enabled_failed, scalar_parent_browser_session_restore_tabbar_restore_available, scalar_parent_devtools_onboarding_is_devtools_user, scalar_parent_telemetry_profile_directory_scan_date, histogram_content_devtools_layoutview_opened_count, scalar_parent_identity_fxaccounts_missed_commands_fetched, plugins_infobar_allow, scalar_content_media_blocked_autoplay_no_audio_track_count, scalar_parent_idb_type_temporary_count, scalar_parent_preferences_prevent_accessibility_services, histogram_content_devtools_webaudioeditor_opened_count, histogram_content_devtools_eyedropper_opened_count, histogram_content_pwmgr_manage_copied_username, user_pref_marionette_enabled, scalar_parent_telemetry_ecosystem_old_send_time, scalar_content_webrtc_hostnameobfuscation_disabled_failed, scalar_parent_webrtc_hostnameobfuscation_enabled_failed, scalar_content_navigator_storage_estimate_count, scalar_parent_browser_errors_reported_success_count, scalar_parent_storage_sync_api_usage_extensions_using, histogram_parent_devtools_canvasdebugger_opened_count, scalar_parent_media_allowed_autoplay_no_audio_track_count, scalar_parent_telemetry_process_creation_timestamp_inconsistent, loop_activity_counter, scalar_content_browser_feeds_preview_loaded, scalar_parent_media_autoplay_would_not_be_allowed_count, scalar_parent_media_blocked_no_metadata, histogram_content_devtools_jsdebugger_opened_count, scalar_parent_webrtc_peerconnection_datachannel_created, scalar_parent_webrtc_hostnameobfuscation_disabled_failed, scalar_content_webrtc_hostnameobfuscation_enabled_succeeded, scalar_parent_datasanitization_privacy_clearonshutdown_cache, scalar_parent_browser_session_restore_tabbar_restore_clicked, scalar_gpu_browser_usage_graphite, scalar_parent_idb_type_persistent_count, scalar_parent_webrtc_nicer_stun_retransmits, histogram_content_devtools_styleeditor_opened_count, histogram_content_devtools_fontinspector_opened_count, scalar_parent_devtools_webreplay_reload_recording, scalar_parent_devtools_webreplay_save_recording, scalar_content_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_pdf_viewer_fallback_shown, scalar_parent_datasanitization_privacy_sanitize_sanitizeonshutdown, scalar_parent_datasanitization_privacy_clearonshutdown_formdata, scalar_parent_datasanitization_privacy_clearonshutdown_sessions, scalar_parent_services_sync_fxa_verification_method, scalar_content_idb_type_persistent_count, scalar_content_mediarecorder_recording_count, scalar_parent_screenshots_upload, scalar_parent_telemetry_os_shutting_down, histogram_content_devtools_ruleview_opened_count, histogram_content_devtools_dom_opened_count, scalar_parent_webrtc_hostnameobfuscation_enabled_succeeded, scalar_content_webrtc_peerconnection_promise_stats_used, scalar_gpu_telemetry_profile_directory_scans, scalar_parent_browser_feeds_livebookmark_count, scalar_parent_devtools_webreplay_stop_recording, scalar_parent_devtools_webreplay_load_recording, scalar_parent_corroborate_omnijar_corrupted, scalar_parent_pdf_viewer_used, scalar_parent_browser_session_restore_number_of_tabs, scalar_content_telemetry_profile_directory_scans, scalar_content_webrtc_peerconnection_promise_and_callback_stats_used, scalar_parent_mediarecorder_recording_count, scalar_parent_sw_cors_res_for_so_req_count, scalar_parent_telemetry_pending_operations_highwatermark_reached, user_pref_privacy_fuzzyfox_enabled, scalar_content_memoryreporter_max_ghost_windows, scalar_parent_devtools_aboutdevtools_opened, scalar_parent_datasanitization_privacy_clearonshutdown_cookies, user_pref_extensions_allow_non_mpc_extensions, scalar_content_idb_type_temporary_count, scalar_content_webrtc_peerconnection_legacy_callback_stats_used, scalar_parent_media_page_had_play_revoked_count, scalar_parent_webrtc_peerconnection_promise_stats_used, histogram_content_devtools_aboutdebugging_opened_count, histogram_content_devtools_webconsole_opened_count, histogram_content_devtools_browserconsole_opened_count, histogram_content_number_of_profiles, user_pref_browser_launcherprocess_enabled, scalar_parent_webrtc_peerconnection_datachannel_max_life_used, scalar_parent_datasanitization_privacy_clearonshutdown_sitesettings, scalar_parent_datasanitization_privacy_clearonshutdown_offlineapps, scalar_parent_browser_feeds_preview_loaded, scalar_parent_devtools_application_opened_count, scalar_parent_dom_contentprocess_troubled_due_to_memory, scalar_parent_navigator_storage_estimate_count, scalar_parent_telemetry_ecosystem_new_send_time, active_experiment_branch, histogram_content_devtools_webide_opened_count, histogram_content_devtools_scratchpad_opened_count, scalar_parent_datasanitization_privacy_clearonshutdown_openwindows, scalar_parent_browser_usage_plugin_instantiated, scalar_parent_telemetry_persistence_timer_hit_count, histogram_content_devtools_memory_opened_count, scalar_parent_devtools_changesview_contextmenu, scalar_parent_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_browser_session_restore_number_of_win, scalar_content_browser_usage_graphite, scalar_parent_preferences_created_new_user_prefs_file, scalar_content_webrtc_peerconnection_datachannel_max_retx_used, scalar_parent_webrtc_hostnameobfuscation_disabled_succeeded, push_api_notification_received, plugins_notification_user_action, user_prefs, histogram_parent_devtools_shadereditor_opened_count, scalar_parent_devtools_webreplay_new_recording, scalar_content_media_autoplay_default_blocked, scalar_parent_networking_data_transferred_captive_portal, scalar_parent_browser_feeds_feed_subscribed, histogram_content_devtools_storage_opened_count, histogram_content_devtools_options_opened_count, scalar_content_webrtc_hostnameobfuscation_disabled_succeeded, scalar_content_navigator_storage_persist_count, scalar_parent_browser_errors_collected_count, histogram_content_devtools_canvasdebugger_opened_count, histogram_content_devtools_jsbrowserdebugger_opened_count, scalar_parent_networking_http_transactions_captive_portal, scalar_parent_browser_errors_reported_failure_count, scalar_parent_devtools_aboutdevtools_installed, scalar_parent_preferences_prefs_file_was_invalid, scalar_parent_webrtc_peerconnection_connected ) FROM `moz-fx-data-shared-prod.telemetry.experiments_v1` windows_10_build_distribution View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.windows_10_build_distribution` AS WITH channel_summary AS ( SELECT normalized_channel, build_group, max(build_number) AS max_build_number, sum(count) AS frequency FROM `moz-fx-data-shared-prod.telemetry.windows_10_aggregate` GROUP BY normalized_channel, build_group ORDER BY build_group ASC), counts AS ( SELECT normalized_channel, sum(frequency) AS total FROM channel_summary GROUP BY normalized_channel) SELECT normalized_channel, build_group, (frequency / total) AS frequency, frequency AS `count` FROM channel_summary INNER JOIN counts USING (normalized_channel) ORDER BY max_build_number ASC crash_summary_v1 View -- Query generated by: templates/unnest_parquet_view.sql.py crash_summary_v1 telemetry_derived.crash_summary_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_summary_v1` AS SELECT * REPLACE ( experiments.key_value AS experiments, (SELECT AS STRUCT payload.* REPLACE (payload.metadata.key_value AS metadata)) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_derived.crash_summary_v1` core_clients_daily_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_daily_v1` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.core_clients_daily_v1` core_clients_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.core_clients_daily_v1` health View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.health` AS SELECT * REPLACE ( `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata, ( SELECT AS STRUCT payload.* REPLACE ( STRUCT( SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.undefined') AS INT64 ) AS undefined, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.timeout') AS INT64 ) AS timeout, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.abort') AS INT64 ) AS abort, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.eUnreachable') AS INT64 ) AS e_unreachable, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.eTerminated') AS INT64 ) AS e_terminated, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.eChannelOpen') AS INT64 ) AS e_channel_open ) AS send_failure, STRUCT( SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.sync') AS INT64 ) AS sync, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.prio') AS INT64 ) AS prio, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.main') AS INT64 ) AS main, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.crash') AS INT64 ) AS crash, SAFE_CAST( JSON_EXTRACT( additional_properties, \"$.payload.pingDiscardedForSize['<unknown>']\" ) AS INT64 ) AS unknown ) AS ping_discarded_for_size ) ) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_stable.health_v4` mobile_event View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.mobile_event` AS SELECT * REPLACE ( -- The pipeline ensures lowercase client_id since 2020-01-10, but we apply -- LOWER here to provide continuity for older data that still contains -- some uppercase IDs; see https://github.com/mozilla/gcp-ingestion/pull/1069 LOWER(client_id) AS client_id, `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata ) FROM `moz-fx-data-shared-prod.telemetry_stable.mobile_event_v1` core_clients_last_seen_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_last_seen_v1` AS WITH with_days_since AS ( SELECT mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen(days_created_profile_bits) AS days_since_created_profile, * FROM `moz-fx-data-shared-prod.telemetry_derived.core_clients_last_seen_v1` ) SELECT -- Include date_last_seen for compatibility with existing queries. DATE_SUB(submission_date, INTERVAL days_since_seen DAY) AS date_last_seen, * FROM with_days_since firefox_desktop_exact_mau28_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_v1` AS WITH base AS ( SELECT submission_date, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, sum(IF(country IN ('US', 'GB', 'FR', 'DE', 'CA'), mau, 0)) AS tier1_mau, sum(IF(country IN ('US', 'GB', 'FR', 'DE', 'CA'), wau, 0)) AS tier1_wau, sum(IF(country IN ('US', 'GB', 'FR', 'DE', 'CA'), dau, 0)) AS tier1_dau, SUM(visited_5_uri_mau) AS visited_5_uri_mau, SUM(visited_5_uri_wau) AS visited_5_uri_wau, SUM(visited_5_uri_dau) AS visited_5_uri_dau FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_desktop_exact_mau28_by_dimensions_v1` GROUP BY submission_date ), -- We use imputed values for the period after the Armag-add-on deletion event; -- see https://bugzilla.mozilla.org/show_bug.cgi?id=1552558 imputed_global AS ( SELECT `date` AS submission_date, mau FROM `moz-fx-data-shared-prod.static.firefox_desktop_imputed_mau28_v1` WHERE datasource = 'desktop_global' ), -- imputed_tier1 AS ( SELECT `date` AS submission_date, mau FROM `moz-fx-data-shared-prod.static.firefox_desktop_imputed_mau28_v1` WHERE datasource = 'desktop_tier1' ) SELECT base.* REPLACE ( COALESCE(imputed_global.mau, base.mau) AS mau, COALESCE(imputed_tier1.mau, base.tier1_mau) AS tier1_mau ) FROM base FULL JOIN imputed_global USING (submission_date) FULL JOIN imputed_tier1 USING (submission_date) ORDER BY submission_date addons View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addons` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.addons_v2` main_summary_v3 View -- Query generated by: templates/unnest_parquet_view.sql.py main_summary_v3 telemetry_derived.main_summary_v3 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_summary_v3` AS SELECT submission_date AS submission_date_s3, * REPLACE ( ARRAY(SELECT * FROM UNNEST(active_addons.list)) AS active_addons, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (_0.element.map_values.key_value AS map_values) FROM UNNEST(events.list) AS _0 ) AS events, popup_notification_stats.key_value AS popup_notification_stats, ARRAY(SELECT * FROM UNNEST(search_counts.list)) AS search_counts, ssl_handshake_result.key_value AS ssl_handshake_result ) FROM `moz-fx-data-shared-prod.telemetry_derived.main_summary_v3` experiment_enrollment_aggregates_recents View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_aggregates_recents` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_aggregates_recents_v1` main_summary_v4 View -- Query generated by: templates/unnest_parquet_view.sql.py main_summary_v4 telemetry_derived.main_summary_v4 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_summary_v4` AS SELECT submission_date AS submission_date_s3, * EXCEPT ( histogram_content_devtools_computedview_opened_count, histogram_content_devtools_fontinspector_opened_count, histogram_content_devtools_storage_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_downloads, histogram_content_devtools_eyedropper_opened_count, histogram_content_devtools_netmonitor_opened_count, scalar_parent_pdf_viewer_fallback_shown, histogram_content_devtools_paintflashing_opened_count, histogram_content_devtools_custom_opened_count, histogram_content_devtools_aboutdebugging_opened_count, histogram_content_devtools_layoutview_opened_count, scalar_parent_telemetry_ecosystem_new_send_time, scalar_parent_media_blocked_autoplay_no_audio_track_count, push_api_notification_received, histogram_content_devtools_jsbrowserdebugger_opened_count, scalar_parent_webrtc_peerconnection_datachannel_max_life_used, histogram_content_pwmgr_manage_deleted, scalar_parent_webrtc_peerconnection_promise_stats_used, scalar_content_webrtc_peerconnection_promise_and_callback_stats_used, scalar_parent_devtools_aboutdevtools_installed, histogram_content_devtools_webide_opened_count, histogram_content_devtools_picker_eyedropper_opened_count, scalar_parent_devtools_aboutdevtools_opened, scalar_parent_datasanitization_privacy_clearOnShutdown_offlineApps, scalar_parent_datasanitization_privacy_clearOnShutdown_siteSettings, scalar_parent_mediarecorder_recording_count, scalar_parent_sw_cors_res_for_so_req_count, scalar_parent_telemetry_ecosystem_old_send_time, scalar_parent_webrtc_peerconnection_legacy_callback_stats_used, scalar_parent_idb_type_temporary_count, scalar_gpu_telemetry_profile_directory_scans, scalar_parent_telemetry_persistence_timer_hit_count, histogram_content_devtools_scratchpad_window_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_cookies, histogram_content_devtools_memory_opened_count, scalar_parent_datasanitization_privacy_sanitize_sanitizeOnShutdown, histogram_content_devtools_webaudioeditor_opened_count, scalar_content_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_webrtc_hostnameobfuscation_disabled_failed, histogram_content_devtools_jsdebugger_opened_count, scalar_parent_webrtc_peerconnection_datachannel_max_retx_used, scalar_gpu_browser_usage_graphite, histogram_content_pwmgr_manage_copied_password, scalar_parent_browser_errors_sample_rate, scalar_parent_webrtc_hostnameobfuscation_enabled_succeeded, scalar_parent_datasanitization_privacy_clearOnShutdown_openWindows, scalar_parent_devtools_aboutdevtools_noinstall_exits, scalar_parent_datasanitization_privacy_clearOnShutdown_sessions, scalar_parent_webrtc_peerconnection_connected, scalar_content_webrtc_peerconnection_datachannel_max_retx_used, scalar_parent_webrtc_hostnameobfuscation_disabled_succeeded, scalar_parent_datasanitization_session_permission_exceptions, scalar_content_telemetry_profile_directory_scans, histogram_content_devtools_developertoolbar_opened_count, histogram_content_pwmgr_manage_copied_username, scalar_parent_telemetry_process_creation_timestamp_inconsistent, scalar_content_idb_type_temporary_count, scalar_parent_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_telemetry_pending_operations_highwatermark_reached, histogram_content_devtools_inspector_opened_count, histogram_content_number_of_profiles, scalar_content_media_autoplay_default_blocked, scalar_parent_devtools_application_opened_count, histogram_content_devtools_shadereditor_opened_count, scalar_parent_devtools_webreplay_save_recording, histogram_content_devtools_animationinspector_opened_count, histogram_content_devtools_dom_opened_count, histogram_content_devtools_styleeditor_opened_count, scalar_parent_webrtc_hostnameobfuscation_enabled_failed, histogram_content_devtools_ruleview_opened_count, scalar_parent_webrtc_peerconnection_promise_and_callback_stats_used, histogram_content_devtools_options_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_cache, scalar_parent_datasanitization_privacy_clearOnShutdown_formdata, scalar_content_webrtc_peerconnection_legacy_callback_stats_used, histogram_content_devtools_responsive_opened_count, loop_activity_counter, scalar_parent_pdf_viewer_print, scalar_parent_browser_session_restore_tabbar_restore_clicked, histogram_content_devtools_webconsole_opened_count, histogram_content_devtools_scratchpad_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_history, user_pref_browser_launcherprocess_enabled, histogram_content_devtools_canvasdebugger_opened_count, scalar_content_telemetry_process_creation_timestamp_inconsistent, scalar_content_sw_cors_res_for_so_req_count, scalar_parent_datasanitization_network_cookie_lifetimePolicy, scalar_content_media_blocked_autoplay_no_audio_track_count, histogram_content_devtools_jsprofiler_opened_count ) REPLACE( histogram_content_cert_validation_success_by_ca.list AS histogram_content_cert_validation_success_by_ca, histogram_content_checkerboard_severity.list AS histogram_content_checkerboard_severity, histogram_content_composite_time.list AS histogram_content_composite_time, histogram_content_content_paint_time.list AS histogram_content_content_paint_time, histogram_content_cycle_collector_max_pause.list AS histogram_content_cycle_collector_max_pause, histogram_content_devtools_accessibility_picker_time_active_seconds.list AS histogram_content_devtools_accessibility_picker_time_active_seconds, histogram_content_devtools_accessibility_service_time_active_seconds.list AS histogram_content_devtools_accessibility_service_time_active_seconds, histogram_content_devtools_accessibility_time_active_seconds.list AS histogram_content_devtools_accessibility_time_active_seconds, histogram_content_devtools_toolbox_time_active_seconds.list AS histogram_content_devtools_toolbox_time_active_seconds, histogram_content_fx_new_window_ms.list AS histogram_content_fx_new_window_ms, histogram_content_fx_page_load_ms_2.list AS histogram_content_fx_page_load_ms_2, histogram_content_fx_searchbar_selected_result_method.list AS histogram_content_fx_searchbar_selected_result_method, histogram_content_fx_session_restore_restore_window_ms.list AS histogram_content_fx_session_restore_restore_window_ms, histogram_content_fx_session_restore_startup_init_session_ms.list AS histogram_content_fx_session_restore_startup_init_session_ms, histogram_content_fx_session_restore_startup_onload_initial_window_ms.list AS histogram_content_fx_session_restore_startup_onload_initial_window_ms, histogram_content_fx_tab_close_time_anim_ms.list AS histogram_content_fx_tab_close_time_anim_ms, histogram_content_fx_tab_switch_update_ms.list AS histogram_content_fx_tab_switch_update_ms, histogram_content_fx_urlbar_selected_result_index.list AS histogram_content_fx_urlbar_selected_result_index, histogram_content_fx_urlbar_selected_result_index_by_type.list AS histogram_content_fx_urlbar_selected_result_index_by_type, histogram_content_fx_urlbar_selected_result_method.list AS histogram_content_fx_urlbar_selected_result_method, histogram_content_fx_urlbar_selected_result_type.list AS histogram_content_fx_urlbar_selected_result_type, histogram_content_gc_animation_ms.list AS histogram_content_gc_animation_ms, histogram_content_gc_max_pause_ms.list AS histogram_content_gc_max_pause_ms, histogram_content_gc_max_pause_ms_2.list AS histogram_content_gc_max_pause_ms_2, histogram_content_geolocation_request_granted.list AS histogram_content_geolocation_request_granted, histogram_content_ghost_windows.list AS histogram_content_ghost_windows, histogram_content_gpu_process_initialization_time_ms.list AS histogram_content_gpu_process_initialization_time_ms, histogram_content_gpu_process_launch_time_ms_2.list AS histogram_content_gpu_process_launch_time_ms_2, histogram_content_http_channel_disposition.list AS histogram_content_http_channel_disposition, histogram_content_http_pageload_is_ssl.list AS histogram_content_http_pageload_is_ssl, histogram_content_http_transaction_is_ssl.list AS histogram_content_http_transaction_is_ssl, histogram_content_input_event_response_coalesced_ms.list AS histogram_content_input_event_response_coalesced_ms, histogram_content_ipc_read_main_thread_latency_ms.list AS histogram_content_ipc_read_main_thread_latency_ms, histogram_content_memory_distribution_among_content.list AS histogram_content_memory_distribution_among_content, histogram_content_memory_heap_allocated.list AS histogram_content_memory_heap_allocated, histogram_content_memory_resident_fast.list AS histogram_content_memory_resident_fast, histogram_content_memory_total.list AS histogram_content_memory_total, histogram_content_memory_unique.list AS histogram_content_memory_unique, histogram_content_memory_unique_content_startup.list AS histogram_content_memory_unique_content_startup, histogram_content_memory_vsize.list AS histogram_content_memory_vsize, histogram_content_memory_vsize_max_contiguous.list AS histogram_content_memory_vsize_max_contiguous, histogram_content_network_cache_metadata_first_read_time_ms.list AS histogram_content_network_cache_metadata_first_read_time_ms, histogram_content_network_cache_v2_hit_time_ms.list AS histogram_content_network_cache_v2_hit_time_ms, histogram_content_network_cache_v2_miss_time_ms.list AS histogram_content_network_cache_v2_miss_time_ms, histogram_content_places_autocomplete_6_first_results_time_ms.list AS histogram_content_places_autocomplete_6_first_results_time_ms, histogram_content_plugin_shutdown_ms.list AS histogram_content_plugin_shutdown_ms, histogram_content_pwmgr_form_autofill_result.list AS histogram_content_pwmgr_form_autofill_result, histogram_content_pwmgr_login_page_safety.list AS histogram_content_pwmgr_login_page_safety, histogram_content_sandbox_rejected_syscalls.list AS histogram_content_sandbox_rejected_syscalls, histogram_content_search_reset_result.list AS histogram_content_search_reset_result, histogram_content_search_service_init_ms.list AS histogram_content_search_service_init_ms, histogram_content_ssl_handshake_result.list AS histogram_content_ssl_handshake_result, histogram_content_ssl_handshake_version.list AS histogram_content_ssl_handshake_version, histogram_content_ssl_tls12_intolerance_reason_pre.list AS histogram_content_ssl_tls12_intolerance_reason_pre, histogram_content_ssl_tls13_intolerance_reason_pre.list AS histogram_content_ssl_tls13_intolerance_reason_pre, histogram_content_time_to_dom_complete_ms.list AS histogram_content_time_to_dom_complete_ms, histogram_content_time_to_dom_content_loaded_end_ms.list AS histogram_content_time_to_dom_content_loaded_end_ms, histogram_content_time_to_dom_content_loaded_start_ms.list AS histogram_content_time_to_dom_content_loaded_start_ms, histogram_content_time_to_dom_interactive_ms.list AS histogram_content_time_to_dom_interactive_ms, histogram_content_time_to_dom_loading_ms.list AS histogram_content_time_to_dom_loading_ms, histogram_content_time_to_first_click_ms.list AS histogram_content_time_to_first_click_ms, histogram_content_time_to_first_interaction_ms.list AS histogram_content_time_to_first_interaction_ms, histogram_content_time_to_first_key_input_ms.list AS histogram_content_time_to_first_key_input_ms, histogram_content_time_to_first_mouse_move_ms.list AS histogram_content_time_to_first_mouse_move_ms, histogram_content_time_to_first_scroll_ms.list AS histogram_content_time_to_first_scroll_ms, histogram_content_time_to_load_event_end_ms.list AS histogram_content_time_to_load_event_end_ms, histogram_content_time_to_load_event_start_ms.list AS histogram_content_time_to_load_event_start_ms, histogram_content_time_to_non_blank_paint_ms.list AS histogram_content_time_to_non_blank_paint_ms, histogram_content_time_to_response_start_ms.list AS histogram_content_time_to_response_start_ms, histogram_content_tracking_protection_enabled.list AS histogram_content_tracking_protection_enabled, histogram_content_uptake_remote_content_result_1.list AS histogram_content_uptake_remote_content_result_1, histogram_content_webext_content_script_injection_ms.list AS histogram_content_webext_content_script_injection_ms, histogram_content_webext_storage_local_get_ms.list AS histogram_content_webext_storage_local_get_ms, histogram_content_webext_storage_local_set_ms.list AS histogram_content_webext_storage_local_set_ms, histogram_content_webvr_time_spent_viewing_in_2d.list AS histogram_content_webvr_time_spent_viewing_in_2d, histogram_content_webvr_users_view_in.list AS histogram_content_webvr_users_view_in, histogram_gpu_checkerboard_severity.list AS histogram_gpu_checkerboard_severity, histogram_gpu_composite_time.list AS histogram_gpu_composite_time, histogram_gpu_content_frame_time.list AS histogram_gpu_content_frame_time, histogram_gpu_gpu_process_initialization_time_ms.list AS histogram_gpu_gpu_process_initialization_time_ms, histogram_gpu_ipc_read_main_thread_latency_ms.list AS histogram_gpu_ipc_read_main_thread_latency_ms, histogram_gpu_uptake_remote_content_result_1.list AS histogram_gpu_uptake_remote_content_result_1, histogram_gpu_webvr_time_spent_viewing_in_oculus.list AS histogram_gpu_webvr_time_spent_viewing_in_oculus, histogram_gpu_webvr_time_spent_viewing_in_openvr.list AS histogram_gpu_webvr_time_spent_viewing_in_openvr, histogram_gpu_webvr_users_view_in.list AS histogram_gpu_webvr_users_view_in, histogram_parent_a11y_consumers.list AS histogram_parent_a11y_consumers, histogram_parent_a11y_instantiated_flag.list AS histogram_parent_a11y_instantiated_flag, histogram_parent_cert_validation_success_by_ca.list AS histogram_parent_cert_validation_success_by_ca, histogram_parent_checkerboard_severity.list AS histogram_parent_checkerboard_severity, histogram_parent_composite_time.list AS histogram_parent_composite_time, histogram_parent_content_frame_time.list AS histogram_parent_content_frame_time, histogram_parent_content_paint_time.list AS histogram_parent_content_paint_time, histogram_parent_cookie_behavior.list AS histogram_parent_cookie_behavior, histogram_parent_cycle_collector_max_pause.list AS histogram_parent_cycle_collector_max_pause, histogram_parent_devtools_about_devtools_opened_key.list AS histogram_parent_devtools_about_devtools_opened_key, histogram_parent_devtools_about_devtools_opened_reason.list AS histogram_parent_devtools_about_devtools_opened_reason, histogram_parent_devtools_accessibility_picker_time_active_seconds.list AS histogram_parent_devtools_accessibility_picker_time_active_seconds, histogram_parent_devtools_accessibility_service_time_active_seconds.list AS histogram_parent_devtools_accessibility_service_time_active_seconds, histogram_parent_devtools_accessibility_time_active_seconds.list AS histogram_parent_devtools_accessibility_time_active_seconds, histogram_parent_devtools_entry_point.list AS histogram_parent_devtools_entry_point, histogram_parent_devtools_fonteditor_font_type_displayed.list AS histogram_parent_devtools_fonteditor_font_type_displayed, histogram_parent_devtools_fonteditor_n_font_axes.list AS histogram_parent_devtools_fonteditor_n_font_axes, histogram_parent_devtools_fonteditor_n_fonts_rendered.list AS histogram_parent_devtools_fonteditor_n_fonts_rendered, histogram_parent_devtools_toolbox_time_active_seconds.list AS histogram_parent_devtools_toolbox_time_active_seconds, histogram_parent_dns_failed_lookup_time.list AS histogram_parent_dns_failed_lookup_time, histogram_parent_dns_lookup_time.list AS histogram_parent_dns_lookup_time, histogram_parent_fx_new_window_ms.list AS histogram_parent_fx_new_window_ms, histogram_parent_fx_page_load_ms_2.list AS histogram_parent_fx_page_load_ms_2, histogram_parent_fx_searchbar_selected_result_method.list AS histogram_parent_fx_searchbar_selected_result_method, histogram_parent_fx_session_restore_restore_window_ms.list AS histogram_parent_fx_session_restore_restore_window_ms, histogram_parent_fx_session_restore_startup_init_session_ms.list AS histogram_parent_fx_session_restore_startup_init_session_ms, histogram_parent_fx_session_restore_startup_onload_initial_window_ms.list AS histogram_parent_fx_session_restore_startup_onload_initial_window_ms, histogram_parent_fx_tab_close_time_anim_ms.list AS histogram_parent_fx_tab_close_time_anim_ms, histogram_parent_fx_tab_switch_total_e10s_ms.list AS histogram_parent_fx_tab_switch_total_e10s_ms, histogram_parent_fx_tab_switch_update_ms.list AS histogram_parent_fx_tab_switch_update_ms, histogram_parent_fx_urlbar_selected_result_index.list AS histogram_parent_fx_urlbar_selected_result_index, histogram_parent_fx_urlbar_selected_result_index_by_type.list AS histogram_parent_fx_urlbar_selected_result_index_by_type, histogram_parent_fx_urlbar_selected_result_method.list AS histogram_parent_fx_urlbar_selected_result_method, histogram_parent_fx_urlbar_selected_result_type.list AS histogram_parent_fx_urlbar_selected_result_type, histogram_parent_gc_animation_ms.list AS histogram_parent_gc_animation_ms, histogram_parent_gc_max_pause_ms.list AS histogram_parent_gc_max_pause_ms, histogram_parent_gc_max_pause_ms_2.list AS histogram_parent_gc_max_pause_ms_2, histogram_parent_geolocation_request_granted.list AS histogram_parent_geolocation_request_granted, histogram_parent_ghost_windows.list AS histogram_parent_ghost_windows, histogram_parent_gpu_process_initialization_time_ms.list AS histogram_parent_gpu_process_initialization_time_ms, histogram_parent_gpu_process_launch_time_ms_2.list AS histogram_parent_gpu_process_launch_time_ms_2, histogram_parent_http_channel_disposition.list AS histogram_parent_http_channel_disposition, histogram_parent_http_pageload_is_ssl.list AS histogram_parent_http_pageload_is_ssl, histogram_parent_http_transaction_is_ssl.list AS histogram_parent_http_transaction_is_ssl, histogram_parent_input_event_response_coalesced_ms.list AS histogram_parent_input_event_response_coalesced_ms, histogram_parent_ipc_read_main_thread_latency_ms.list AS histogram_parent_ipc_read_main_thread_latency_ms, histogram_parent_memory_distribution_among_content.list AS histogram_parent_memory_distribution_among_content, histogram_parent_memory_heap_allocated.list AS histogram_parent_memory_heap_allocated, histogram_parent_memory_resident_fast.list AS histogram_parent_memory_resident_fast, histogram_parent_memory_total.list AS histogram_parent_memory_total, histogram_parent_memory_unique.list AS histogram_parent_memory_unique, histogram_parent_memory_vsize.list AS histogram_parent_memory_vsize, histogram_parent_memory_vsize_max_contiguous.list AS histogram_parent_memory_vsize_max_contiguous, histogram_parent_network_cache_metadata_first_read_time_ms.list AS histogram_parent_network_cache_metadata_first_read_time_ms, histogram_parent_network_cache_v2_hit_time_ms.list AS histogram_parent_network_cache_v2_hit_time_ms, histogram_parent_network_cache_v2_miss_time_ms.list AS histogram_parent_network_cache_v2_miss_time_ms, histogram_parent_places_autocomplete_6_first_results_time_ms.list AS histogram_parent_places_autocomplete_6_first_results_time_ms, histogram_parent_plugin_shutdown_ms.list AS histogram_parent_plugin_shutdown_ms, histogram_parent_pwmgr_blocklist_num_sites.list AS histogram_parent_pwmgr_blocklist_num_sites, histogram_parent_pwmgr_form_autofill_result.list AS histogram_parent_pwmgr_form_autofill_result, histogram_parent_pwmgr_login_last_used_days.list AS histogram_parent_pwmgr_login_last_used_days, histogram_parent_pwmgr_login_page_safety.list AS histogram_parent_pwmgr_login_page_safety, histogram_parent_pwmgr_manage_opened.list AS histogram_parent_pwmgr_manage_opened, histogram_parent_pwmgr_manage_visibility_toggled.list AS histogram_parent_pwmgr_manage_visibility_toggled, histogram_parent_pwmgr_num_passwords_per_hostname.list AS histogram_parent_pwmgr_num_passwords_per_hostname, histogram_parent_pwmgr_num_saved_passwords.list AS histogram_parent_pwmgr_num_saved_passwords, histogram_parent_pwmgr_prompt_remember_action.list AS histogram_parent_pwmgr_prompt_remember_action, histogram_parent_pwmgr_prompt_update_action.list AS histogram_parent_pwmgr_prompt_update_action, histogram_parent_pwmgr_saving_enabled.list AS histogram_parent_pwmgr_saving_enabled, histogram_parent_sandbox_rejected_syscalls.list AS histogram_parent_sandbox_rejected_syscalls, histogram_parent_search_reset_result.list AS histogram_parent_search_reset_result, histogram_parent_search_service_init_ms.list AS histogram_parent_search_service_init_ms, histogram_parent_ssl_handshake_result.list AS histogram_parent_ssl_handshake_result, histogram_parent_ssl_handshake_version.list AS histogram_parent_ssl_handshake_version, histogram_parent_ssl_tls12_intolerance_reason_pre.list AS histogram_parent_ssl_tls12_intolerance_reason_pre, histogram_parent_ssl_tls13_intolerance_reason_pre.list AS histogram_parent_ssl_tls13_intolerance_reason_pre, histogram_parent_time_to_first_click_ms.list AS histogram_parent_time_to_first_click_ms, histogram_parent_time_to_first_interaction_ms.list AS histogram_parent_time_to_first_interaction_ms, histogram_parent_time_to_first_key_input_ms.list AS histogram_parent_time_to_first_key_input_ms, histogram_parent_time_to_first_mouse_move_ms.list AS histogram_parent_time_to_first_mouse_move_ms, histogram_parent_time_to_first_scroll_ms.list AS histogram_parent_time_to_first_scroll_ms, histogram_parent_time_to_non_blank_paint_ms.list AS histogram_parent_time_to_non_blank_paint_ms, histogram_parent_time_to_response_start_ms.list AS histogram_parent_time_to_response_start_ms, histogram_parent_touch_enabled_device.list AS histogram_parent_touch_enabled_device, histogram_parent_tracking_protection_enabled.list AS histogram_parent_tracking_protection_enabled, histogram_parent_update_bits_result_complete.list AS histogram_parent_update_bits_result_complete, histogram_parent_update_bits_result_partial.list AS histogram_parent_update_bits_result_partial, histogram_parent_update_can_use_bits_notify.list AS histogram_parent_update_can_use_bits_notify, histogram_parent_update_download_code_complete.list AS histogram_parent_update_download_code_complete, histogram_parent_update_download_code_partial.list AS histogram_parent_update_download_code_partial, histogram_parent_update_state_code_complete_stage.list AS histogram_parent_update_state_code_complete_stage, histogram_parent_update_state_code_complete_startup.list AS histogram_parent_update_state_code_complete_startup, histogram_parent_update_state_code_partial_stage.list AS histogram_parent_update_state_code_partial_stage, histogram_parent_update_state_code_partial_startup.list AS histogram_parent_update_state_code_partial_startup, histogram_parent_update_status_error_code_complete_stage.list AS histogram_parent_update_status_error_code_complete_stage, histogram_parent_update_status_error_code_complete_startup.list AS histogram_parent_update_status_error_code_complete_startup, histogram_parent_update_status_error_code_partial_stage.list AS histogram_parent_update_status_error_code_partial_stage, histogram_parent_update_status_error_code_partial_startup.list AS histogram_parent_update_status_error_code_partial_startup, histogram_parent_uptake_remote_content_result_1.list AS histogram_parent_uptake_remote_content_result_1, histogram_parent_webext_background_page_load_ms.list AS histogram_parent_webext_background_page_load_ms, histogram_parent_webext_browseraction_popup_open_ms.list AS histogram_parent_webext_browseraction_popup_open_ms, histogram_parent_webext_browseraction_popup_preload_result_count.list AS histogram_parent_webext_browseraction_popup_preload_result_count, histogram_parent_webext_content_script_injection_ms.list AS histogram_parent_webext_content_script_injection_ms, histogram_parent_webext_extension_startup_ms.list AS histogram_parent_webext_extension_startup_ms, histogram_parent_webext_pageaction_popup_open_ms.list AS histogram_parent_webext_pageaction_popup_open_ms, histogram_parent_webext_storage_local_get_ms.list AS histogram_parent_webext_storage_local_get_ms, histogram_parent_webext_storage_local_set_ms.list AS histogram_parent_webext_storage_local_set_ms, histogram_parent_webvr_time_spent_viewing_in_2d.list AS histogram_parent_webvr_time_spent_viewing_in_2d, histogram_parent_webvr_time_spent_viewing_in_oculus.list AS histogram_parent_webvr_time_spent_viewing_in_oculus, histogram_parent_webvr_time_spent_viewing_in_openvr.list AS histogram_parent_webvr_time_spent_viewing_in_openvr, histogram_parent_webvr_users_view_in.list AS histogram_parent_webvr_users_view_in ) FROM `moz-fx-data-shared-prod.telemetry_derived.main_summary_v4` main_1pct View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_1pct` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.main_1pct_v1` addons_v2 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addons_v2` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.addons_v2` experiments_aggregates_v1 View -- Query generated by: templates/unnest_parquet_view.sql.py experiments_aggregates_v1 telemetry_derived.experiments_aggregates_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments_aggregates_v1` AS SELECT * REPLACE ( histogram.key_value AS histogram, ARRAY(SELECT * FROM UNNEST(statistics.list)) AS statistics ) FROM `moz-fx-data-shared-prod.telemetry_derived.experiments_aggregates_v1` core_clients_last_seen View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.core_clients_last_seen_v1` telemetry_focus_event_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet_v1` windows_10_patch_adoption View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.windows_10_patch_adoption` AS SELECT CAST(ubr AS int64) AS numeric_windows_ubr, build_number, ubr AS label, SUM(count) AS frequency FROM `moz-fx-data-shared-prod.telemetry.windows_10_aggregate` GROUP BY numeric_windows_ubr, build_number, label ORDER BY numeric_windows_ubr ASC clients_scalar_aggregates_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_scalar_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_scalar_aggregates_v1` ssl_ratios_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.ssl_ratios_v1` AS WITH windowed AS ( SELECT *, SUM(ssl_loads) OVER w1 + SUM(non_ssl_loads) OVER w1 AS total_loads FROM `moz-fx-data-shared-prod.telemetry_derived.ssl_ratios_v1` WINDOW w1 AS ( ORDER BY submission_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) ) SELECT submission_date, os, country, -- ratio of pings that have the probe reporting_ratio, -- normalized count of pageloads that went into this ratio (non_ssl_loads + ssl_loads) / total_loads AS normalized_pageloads, ssl_loads / (non_ssl_loads + ssl_loads) AS ratio FROM windowed WHERE non_ssl_loads + ssl_loads > 5000 telemetry_new_profile_parquet_v2 View -- Query generated by: templates/unnest_parquet_view.sql.py telemetry_new_profile_parquet_v2 telemetry_derived.telemetry_new_profile_parquet_v2 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_new_profile_parquet_v2` AS SELECT submission_date AS submission, * REPLACE ( (SELECT AS STRUCT environment.* REPLACE ((SELECT AS STRUCT environment.partner.* REPLACE (ARRAY(SELECT * FROM UNNEST(environment.partner.partner_names.list)) AS partner_names)) AS partner)) AS environment ) FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_new_profile_parquet_v2` socorro_crash View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.socorro_crash` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.socorro_crash_v2` experiment_search_aggregates_recents clients_daily_histogram_aggregates_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily_histogram_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_daily_histogram_aggregates_v1` devtools_panel_usage View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.devtools_panel_usage` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.devtools_panel_usage_v1` firefox_nondesktop_day_2_7_activation View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_day_2_7_activation` AS SELECT DATE_SUB(submission_date, INTERVAL 6 DAY) AS cohort_date, * EXCEPT (submission_date) FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_nondesktop_day_2_7_activation_v1` desktop_retention_1_week Metadata Friendly name : Desktop 1-Week Retention Description : Among profiles that were active at least once in the week starting on the specified day (days 0 through 6), whether each profile is active during the following week (days 7 through 13). This based on https://docs.telemetry.mozilla.org/cookbooks/retention.html#1-week-retention for the usage criterion \"Any Firefox Activity\" on Firefox (Desktop) Owners : dthorn@mozilla.com , jklukas@mozilla.com View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.desktop_retention_1_week` AS SELECT client_id, sample_id, DATE_SUB(submission_date, INTERVAL 13 DAY) AS `date`, -- active week 1 `moz-fx-data-shared-prod`.udf.active_n_weeks_ago(days_seen_bits, 0) AS retained, FROM `moz-fx-data-shared-prod.telemetry.clients_last_seen` WHERE -- active week 0 `moz-fx-data-shared-prod`.udf.active_n_weeks_ago(days_seen_bits, 1) fenix_events_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.fenix_events_v1` AS SELECT submission_timestamp, client_info.client_id AS device_id, CONCAT(document_id, CAST(event.timestamp AS STRING)) AS insert_id, CONCAT(event.category, '.', event.name) AS event_type, TIMESTAMP_ADD(PARSE_TIMESTAMP('%Y-%m-%dT%H:%M%Ez', ping_info.start_time), INTERVAL event.timestamp SECOND) AS timestamp, client_info.app_display_version AS app_version, client_info.os AS platform, client_info.os AS os_name, client_info.os_version AS os_version, client_info.device_manufacturer AS device_manufacturer, client_info.device_model AS device_model, metadata.geo.country AS country, metadata.geo.subdivision1 AS region, metadata.geo.city AS city, ( -- direct insert of `udf.kv_array_to_json_string`, for use in a view SELECT CONCAT( '{', ARRAY_TO_STRING( ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')), \",\"), '}') FROM UNNEST(event.extra) ) AS event_properties, TO_JSON_STRING( STRUCT(client_info.architecture AS arch) ) AS user_properties FROM `moz-fx-data-shared-prod.org_mozilla_fenix_stable.events_v1` CROSS JOIN UNNEST(events) AS event telemetry_ip_privacy_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_ip_privacy_parquet_v1` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_ip_privacy_parquet_v1` active_profiles View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.active_profiles` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.active_profiles_v1` telemetry_core_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_core_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_core_parquet_v3` socorro_crash_v2 View -- Query generated by: templates/unnest_parquet_view.sql.py socorro_crash_v2 telemetry_derived.socorro_crash_v2 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.socorro_crash_v2` AS SELECT * REPLACE ( ARRAY(SELECT * FROM UNNEST(additional_minidumps.list)) AS additional_minidumps, ARRAY(SELECT * FROM UNNEST(addons.list)) AS addons, ( SELECT AS STRUCT json_dump.* REPLACE ( ( SELECT AS STRUCT json_dump.crashing_thread.* REPLACE ( ARRAY(SELECT * FROM UNNEST(json_dump.crashing_thread.frames.list)) AS frames ) ) AS crashing_thread, ARRAY(SELECT * FROM UNNEST(json_dump.modules.list)) AS modules, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (ARRAY(SELECT * FROM UNNEST(_0.element.frames.list)) AS frames) FROM UNNEST(json_dump.threads.list) AS _0 ) AS threads ) ) AS json_dump, ( SELECT AS STRUCT memory_report.* REPLACE (ARRAY(SELECT * FROM UNNEST(memory_report.reports.list)) AS reports) ) AS memory_report ) FROM `moz-fx-data-shared-prod.telemetry_derived.socorro_crash_v2` nondesktop_clients_last_seen_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.nondesktop_clients_last_seen_v1` AS WITH glean_final AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry.fenix_clients_last_seen` UNION ALL SELECT *, 'Lockwise Baseline' AS app_name, FROM `moz-fx-data-shared-prod.mozilla_lockbox.baseline_clients_last_seen` UNION ALL SELECT *, 'Lockwise Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_ios_lockbox.baseline_clients_last_seen` UNION ALL SELECT *, 'Reference Browser Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_reference_browser.baseline_clients_last_seen` UNION ALL SELECT *, 'Firefox TV Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_tv_firefox.baseline_clients_last_seen` UNION ALL SELECT *, 'VR Browser Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_vrbrowser.baseline_clients_last_seen` ) SELECT submission_date, client_id, days_seen_bits, days_since_seen, days_created_profile_bits, days_since_created_profile, app_name, os, osversion AS os_version, normalized_channel, campaign, country, locale, distribution_id, metadata_app_version AS app_version, mozfun.norm.product_info(app_name, os).*, FROM `moz-fx-data-shared-prod.telemetry.core_clients_last_seen` UNION ALL SELECT submission_date, client_id, days_seen_bits, days_since_seen, days_created_profile_bits, days_since_created_profile, app_name, normalized_os AS os, normalized_os_version AS os_version, normalized_channel, NULL AS campaign, country, locale, NULL AS distribution_id, app_display_version AS app_version, mozfun.norm.product_info(app_name, normalized_os).*, FROM glean_final addon_aggregates_v2 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addon_aggregates_v2` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.addon_aggregates_v2` clients_daily View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.clients_daily_v6` clients_daily_v6 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily_v6` AS SELECT submission_date AS submission_date_s3, * EXCEPT ( active_experiment_id, active_experiment_branch, total_hours_sum, scalar_parent_dom_contentprocess_troubled_due_to_memory_sum, histogram_parent_devtools_developertoolbar_opened_count_sum ) REPLACE( IFNULL(country, '??') AS country, IFNULL(city, '??') AS city, IFNULL(geo_subdivision1, '??') AS geo_subdivision1, IFNULL(geo_subdivision2, '??') AS geo_subdivision2 ) FROM `moz-fx-data-shared-prod.telemetry_derived.clients_daily_v6` clients_last_seen_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_last_seen_v1` AS WITH days_since AS ( SELECT DATE_DIFF(submission_date, first_seen_date, DAY) AS days_since_first_seen, DATE_DIFF(submission_date, second_seen_date, DAY) AS days_since_second_seen, mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen(days_visited_1_uri_bits) AS days_since_visited_1_uri, mozfun.bits28.days_since_seen(days_visited_5_uri_bits) AS days_since_visited_5_uri, mozfun.bits28.days_since_seen(days_visited_10_uri_bits) AS days_since_visited_10_uri, mozfun.bits28.days_since_seen(days_had_8_active_ticks_bits) AS days_since_had_8_active_ticks, mozfun.bits28.days_since_seen(days_opened_dev_tools_bits) AS days_since_opened_dev_tools, mozfun.bits28.days_since_seen(days_created_profile_bits) AS days_since_created_profile, mozfun.bits28.days_since_seen(days_interacted_bits) AS days_since_interacted, * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_last_seen_v1` ) SELECT -- Segment definitions; see https://docs.telemetry.mozilla.org/concepts/segments.html -- 0x0FFFFFFE is a bitmask that accepts the previous 27 days, excluding the current day (rightmost bit) -- 0x183060C183 == 0b000001100000110000011000001100000110000011 is a bit mask that accepts a pair of -- consecutive days each week for six weeks; the current day and previous day are accepted. BIT_COUNT(days_seen_bits & 0x0FFFFFFE) >= 14 AS is_regular_user_v3, days_seen_bits & 0x0FFFFFFE = 0 AS is_new_or_resurrected_v3, BIT_COUNT(days_seen_bits & 0x0FFFFFFE) >= 14 AND ( ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date)) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) - 1) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) + 1) ) ) <= 1 ) ) AS is_weekday_regular_v1, BIT_COUNT(days_seen_bits & 0x0FFFFFFE) >= 14 AND NOT ( ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date)) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) - 1) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) + 1) ) ) <= 1 ) ) AS is_allweek_regular_v1, BIT_COUNT(days_visited_1_uri_bits) >= 21 AS is_core_active_v1, CASE WHEN BIT_COUNT(days_visited_1_uri_bits) BETWEEN 1 AND 6 THEN 'infrequent_user' WHEN BIT_COUNT(days_visited_1_uri_bits) BETWEEN 7 AND 13 THEN 'casual_user' WHEN BIT_COUNT(days_visited_1_uri_bits) BETWEEN 14 AND 20 THEN 'regular_user' WHEN BIT_COUNT(days_visited_1_uri_bits) >= 21 THEN 'core_user' ELSE 'other' END AS activity_segments_v1, ( days_since_first_seen = 6 -- 0x7F = mozfun.bits28.from_string('0000000000000000000001111111') AND BIT_COUNT(days_seen_bits & 0x7F) >= 5 ) AS new_profile_7_day_activated_v1, ( days_since_first_seen = 13 -- 0x3FFF = mozfun.bits28.from_string('0000000000000011111111111111') AND BIT_COUNT(days_seen_bits & 0x3FFF) >= 8 ) AS new_profile_14_day_activated_v1, ( days_since_first_seen = 20 -- 0x1FFFFF = mozfun.bits28.from_string('0000000111111111111111111111') AND BIT_COUNT(days_seen_bits & 0x1FFFFF) >= 12 ) AS new_profile_21_day_activated_v1, * EXCEPT ( active_experiment_id, scalar_parent_dom_contentprocess_troubled_due_to_memory_sum, total_hours_sum, histogram_parent_devtools_developertoolbar_opened_count_sum, active_experiment_branch ) REPLACE( IFNULL(country, '??') AS country, IFNULL(city, '??') AS city, IFNULL(geo_subdivision1, '??') AS geo_subdivision1, IFNULL(geo_subdivision2, '??') AS geo_subdivision2, ARRAY( SELECT AS STRUCT *, mozfun.bits28.days_since_seen(bits) AS days_since_seen FROM UNNEST(days_seen_in_experiment) ) AS days_seen_in_experiment ), -- TODO: Announce and remove this temporary field. CAST(sample_id AS STRING) AS _sample_id_string FROM days_since fennec_ios_events_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.fennec_ios_events_v1` AS WITH base_events AS ( SELECT *, event.f0_ AS timestamp, event.f0_ AS event_timestamp, event.f1_ AS event_category, event.f2_ AS event_method, event.f3_ AS event_object, event.f4_ AS event_value, event.f5_ AS event_map_values, metadata.uri.app_version, osversion AS os_version, metadata.geo.country, metadata.geo.city, metadata.uri.app_name FROM `moz-fx-data-shared-prod.telemetry.mobile_event` CROSS JOIN UNNEST(events) AS event ), all_events AS ( SELECT submission_timestamp, client_id AS device_id, ( created + COALESCE( SAFE_CAST(`moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'session_id') AS INT64), 0 ) ) AS session_id, CASE WHEN (event_category IN ('action')) AND (event_method IN ('foreground')) AND (event_object IN ('app')) THEN 'Fennec-iOS - App is foregrounded (session start)' WHEN (event_category IN ('action')) AND (event_method IN ('background')) AND (event_object IN ('app')) THEN 'Fennec-iOS - App is backgrounded (session end)' WHEN (event_category IN ('action')) AND (event_method IN ('view')) AND (event_object IN ('bookmarks-panel')) AND (event_value IN ('home-panel-tab-button')) THEN 'Fennec-iOS - View Bookmarks list from Home Panel tab button' WHEN (event_category IN ('action')) AND (event_method IN ('view')) AND (event_object IN ('bookmarks-panel')) AND (event_value IN ('app-menu')) THEN 'Fennec-iOS - View Bookmarks list from App Menu' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('bookmark')) AND (event_value IN ('page-action-menu')) THEN 'Fennec-iOS - Add Bookmark from Page Action Menu' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('bookmark')) AND (event_value IN ('share-menu')) THEN 'Fennec-iOS - Add Bookmark from Share Menu' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('bookmark')) AND (event_value IN ('activity-stream')) THEN 'Fennec-iOS - Add Bookmark from Activity Stream context menu' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('page-action-menu')) THEN 'Fennec-iOS - Delete Bookmark from Page Action Menu' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('activity-stream')) THEN 'Fennec-iOS - Delete Bookmark from Activity Stream context menu' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('bookmarks-panel')) THEN 'Fennec-iOS - Delete Bookmark from Home Panel via long-press' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('bookmarks-panel')) THEN 'Fennec-iOS - Delete Bookmark from Home Panel via swipe' WHEN (event_category IN ('action')) AND (event_method IN ('open')) AND (event_object IN ('bookmark')) AND (event_value IN ('awesomebar-results')) THEN 'Fennec-iOS - Open Bookmark from Awesomebar search results' WHEN (event_category IN ('action')) AND (event_method IN ('open')) AND (event_object IN ('bookmark')) AND (event_value IN ('bookmarks-panel')) THEN 'Fennec-iOS - Open Bookmark from Home Panel' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reader-mode-open-button')) THEN 'Fennec-iOS - Open Reader Mode' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reader-mode-close-button')) THEN 'Fennec-iOS - Leave Reader Mode' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('reader-mode-toolbar')) THEN 'Fennec-iOS - Add item to Reading List from Toolbar' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('share-extension')) THEN 'Fennec-iOS - Add item to Reading List from Share Extension' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('page-action-menu')) THEN 'Fennec-iOS - Add item to Reading List from Page Action Menu' WHEN (event_category IN ('action')) AND (event_method IN ('open')) AND (event_object IN ('reading-list-item')) THEN 'Fennec-iOS - Open item from Reading List' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('reader-mode-toolbar')) THEN 'Fennec-iOS - Delete item from Reading List from Toolbar' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('reading-list-panel')) THEN 'Fennec-iOS - Delete item from Reading List from Home Panel' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('mark-as-read')) THEN 'Fennec-iOS - Mark Item As Read' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('mark-as-unread')) THEN 'Fennec-iOS - Mark Item As Unread' WHEN (event_category IN ('action')) AND (event_method IN ('change')) AND (event_object IN ('setting')) THEN 'Fennec-iOS - Setting changed' WHEN (event_category IN ('action')) AND (event_method IN ('scan')) AND (event_object IN ('qr-code-url')) THEN 'Fennec-iOS - URL-based QR code scanned' WHEN (event_category IN ('action')) AND (event_method IN ('scan')) AND (event_object IN ('qr-code-text')) THEN 'Fennec-iOS - Non-URL-based QR code scanned' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('send-to-device')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Send to device tapped' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('application-open-url')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Open in Firefox tapped (URL)' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('application-open-url')) AND (event_object IN ('searchText')) THEN 'Fennec-iOS - Open in Firefox tapped (search text)' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('bookmark-this-page')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Bookmark this page tapped' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('add-to-reading-list')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Add to reading list tapped' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('load-in-background')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Load in Background tapped' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('website-data-button')) THEN 'Fennec-iOS - Tap Website Data in Data Management Menu' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('search-website-data')) THEN 'Fennec-iOS - Tap on the Search Bar in Website Data' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('clear-website-data-button')) THEN 'Fennec-iOS - Tap on \\'Clear All Website Data\\' button in Website Data' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-top-sites-button')) THEN 'Fennec-iOS - Tap Top Sites button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-blank-page-button')) THEN 'Fennec-iOS - Tap Blank Page button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-bookmarks-button')) THEN 'Fennec-iOS - Tap Bookmarks button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-history-button')) THEN 'Fennec-iOS - Tap History button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-homepage-button')) THEN 'Fennec-iOS - Tap Homepage button in New Tab Settings' WHEN (event_category IN ('prompt')) AND (event_method IN ('translate')) AND (event_object IN ('tab')) THEN 'Fennec-iOS - Prompt to translate tab to user\\'s native language' WHEN (event_category IN ('action')) AND (event_method IN ('translate')) AND (event_object IN ('tab')) THEN 'Fennec-iOS - Accept or decline offer to translate tab' WHEN (event_category IN ('action')) AND (event_method IN ('press')) AND (event_object IN ('dismissed-onboarding')) THEN 'Fennec-iOS - Dismiss onboarding screen' WHEN (event_category IN ('action')) AND (event_method IN ('press')) AND (event_object IN ('dismissed-onboarding-email-login')) THEN 'Fennec-iOS - Dismiss onboarding screen on email login card' WHEN (event_category IN ('action')) AND (event_method IN ('press')) AND (event_object IN ('dismissed-onboarding-sign-up')) THEN 'Fennec-iOS - Dismiss onboarding screen on sign up card' WHEN NOT ( -- events above are legacy definitions, moved from the previous Spark job. Following statement captures all new, non-ignored events (event_category = 'action' AND event_method = 'add' AND event_object = 'tab') OR (event_category = 'action' AND event_method = 'delete' AND event_object = 'tab') ) THEN CONCAT('Fennec-iOS - ', event_category, '.', event_method, '.', event_object) END AS event_name, event_timestamp AS timestamp, (event_timestamp + created) AS time, app_version, os AS os_name, os_version, country, city, ( SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM UNNEST(event_map_values) ) AS event_props_1, event_map_values, event_object, event_value, event_method, event_category, created, settings FROM base_events WHERE app_name IN ('Fennec') AND os IN ('iOS') -- bug 1636231 - disable background events in ios amplitude AND event_method != 'background' ), all_events_with_insert_ids AS ( SELECT * EXCEPT (event_category, created), CONCAT( device_id, \"-\", CAST(created AS STRING), \"-\", SPLIT(event_name, \" - \")[OFFSET(1)], \"-\", CAST(timestamp AS STRING), \"-\", event_category, \"-\", event_method, \"-\", event_object ) AS insert_id, event_name AS event_type FROM all_events WHERE event_name IS NOT NULL ), extra_props AS ( SELECT * EXCEPT (event_map_values, event_object, event_value, event_method, event_name), ( SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM ( SELECT 'gesture' AS key, CASE WHEN event_name = 'Fennec-iOS - Delete Bookmark from Home Panel via long-press' THEN 'long-press' WHEN event_name = 'Fennec-iOS - Delete Bookmark from Home Panel via swipe' THEN 'swipe' END AS value UNION ALL SELECT 'setting' AS key, CASE WHEN event_name = 'Fennec-iOS - Setting changed' THEN event_value END AS value UNION ALL SELECT 'to' AS key, CASE WHEN event_name = 'Fennec-iOS - Setting changed' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') WHEN event_name = 'Fennec-iOS - Prompt to translate tab to user\\'s native language' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') WHEN event_name = 'Fennec-iOS - Accept or decline offer to translate tab' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') END AS value UNION ALL SELECT 'from' AS key, CASE WHEN event_name = 'Fennec-iOS - Prompt to translate tab to user\\'s native language' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from') WHEN event_name = 'Fennec-iOS - Accept or decline offer to translate tab' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from') END AS value UNION ALL SELECT 'action' AS key, CASE WHEN event_name = 'Fennec-iOS - Accept or decline offer to translate tab' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'action') END AS value UNION ALL SELECT 'slide-num' AS key, CASE WHEN event_name = 'Fennec-iOS - Dismiss onboarding screen' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'slide-num') WHEN event_name = 'Fennec-iOS - Dismiss onboarding screen on email login card' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'slide-num') WHEN event_name = 'Fennec-iOS - Dismiss onboarding screen on sign up card' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'slide-num') END AS value UNION ALL SELECT 'event_value' AS key, event_value AS value ) WHERE VALUE IS NOT NULL ) AS event_props_2, ARRAY_CONCAT( ARRAY<STRING>[], ( SELECT ARRAY_AGG( CASE WHEN key = 'defaultSearchEngine' THEN CONCAT('\"', 'pref_default_search_engine', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'prefKeyAutomaticSliderValue' THEN CONCAT('\"', 'pref_automatic_slider_value', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'prefKeyAutomaticSwitchOnOff' THEN CONCAT('\"', 'pref_automatic_switch_on_off', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'prefKeyThemeName' THEN CONCAT('\"', 'pref_theme_name', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.ASBookmarkHighlightsVisible' THEN CONCAT( '\"', 'pref_activity_stream_bookmark_highlights_visible', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.ASPocketStoriesVisible' THEN CONCAT( '\"', 'pref_activity_stream_pocket_stories_visible', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.ASRecentHighlightsVisible' THEN CONCAT( '\"', 'pref_activity_stream_recent_highlights_visible', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.blockPopups' THEN CONCAT('\"', 'pref_block_popups', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key = 'profile.prefkey.trackingprotection.enabled' THEN CONCAT('\"', 'pref_tracking_protection_enabled', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.prefkey.trackingprotection.normalbrowsing' THEN CONCAT( '\"', 'pref_tracking_protection_normal_browsing', '\":\"', CAST(value AS STRING), '\"' ) WHEN key = 'profile.prefkey.trackingprotection.privatebrowsing' THEN CONCAT( '\"', 'pref_tracking_protection_private_browsing', '\":\"', CAST(value AS STRING), '\"' ) WHEN key = 'profile.prefkey.trackingprotection.strength' THEN CONCAT('\"', 'pref_tracking_protection_strength', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.saveLogins' THEN CONCAT('\"', 'pref_save_logins', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key = 'profile.settings.closePrivateTabs' THEN CONCAT( '\"', 'pref_settings_close_private_tabs', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.show-translation' THEN CONCAT('\"', 'pref_show_translation', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.showClipboardBar' THEN CONCAT( '\"', 'pref_show_clipboard_bar', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'windowHeight' THEN CONCAT('\"', 'pref_window_height', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'windowWidth' THEN CONCAT('\"', 'pref_window_width', '\":\"', CAST(value AS STRING), '\"') END IGNORE NULLS ) FROM UNNEST(SETTINGS) ) ) AS user_props FROM all_events_with_insert_ids ) SELECT * EXCEPT (event_props_1, event_props_2, user_props, settings), CONCAT( '{', ARRAY_TO_STRING( ( SELECT ARRAY_AGG(DISTINCT e) FROM UNNEST(ARRAY_CONCAT(IFNULL(event_props_1, []), IFNULL(event_props_2, []))) AS e ), \",\" ), '}' ) AS event_properties, CONCAT('{', ARRAY_TO_STRING(user_props, \",\"), '}') AS user_properties FROM extra_props experiment_error_aggregates_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_error_aggregates_v1` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_error_aggregates_v1` firefox_desktop_exact_mau28 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_v1` eng_workflow_hgpush_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_hgpush_parquet_v1` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.eng_workflow_hgpush_parquet_v1` firefox_desktop_exact_mau28_by_client_count_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_client_count_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_desktop_exact_mau28_by_client_count_dimensions_v1` eng_workflow_build_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_build_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date, DATE(submission_timestamp) AS submission_date_s3, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date` ) AS metadata, argv, build_opts, client_id, command, duration_ms, success, STRUCT( system.os, system.cpu_brand, system.drive_is_ssd, CAST(system.logical_cores AS int64) AS logical_cores, CAST(system.memory_gb AS int64) AS memory_gb, CAST(system.physical_cores AS int64) AS physical_cores, system.virtual_machine ) AS system, FORMAT_TIMESTAMP('%FT%X', time) AS time, exception, ARRAY( SELECT AS STRUCT u.* REPLACE (CAST(count AS int64) AS count) FROM UNNEST(file_types_changed) AS u ) AS file_types_changed, build_attrs FROM `moz-fx-data-shared-prod.eng_workflow.build` telemetry_core_parquet_v3 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_core_parquet_v3` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, metadata.uri.app_name, os, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id AS app_build_id, normalized_channel ) AS metadata, STRUCT( metadata.uri.app_name AS name ) AS application, v, client_id, seq, locale, osversion, device, arch, profile_date, default_search, distribution_id, created, tz, sessions, durations, searches, experiments, flash_usage, campaign, campaign AS campaign_id, default_browser, show_tracker_stats_share, accessibility_services, metadata.uri.app_version AS metadata_app_version, bug_1501329_affected FROM `moz-fx-data-shared-prod.telemetry.core` firefox_desktop_exact_mau28_by_dimensions_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_dimensions_v1` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_desktop_exact_mau28_by_dimensions_v1` experiment_enrollment_overall View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_overall` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_overall_v1` experiment_enrollment_cumulative_population_estimate View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_cumulative_population_estimate` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_cumulative_population_estimate_v1` client_probe_counts_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.client_probe_counts` AS WITH all_counts AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_scalar_probe_counts_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_histogram_probe_counts_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.scalar_percentiles_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.histogram_percentiles_v1` ) SELECT * FROM all_counts telemetry_downgrade_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_downgrade_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date, `id`, creation_date, application, client_id, version, STRUCT(payload.last_version, payload.last_build_id, payload.has_sync, CAST(NULL AS boolean) AS has_binary, CAST(payload.button AS int64) AS button ) AS payload FROM `moz-fx-data-shared-prod.telemetry.downgrade` experiment_unenrollment_overall View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_unenrollment_overall` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_unenrollment_overall_v1` eng_workflow_hgpush_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_hgpush_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.eng_workflow_hgpush_parquet_v1` rocket_android_events_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.rocket_android_events_v1` AS WITH base_events AS ( SELECT *, event.f0_ AS timestamp, event.f0_ AS event_timestamp, event.f1_ AS event_category, event.f2_ AS event_method, event.f3_ AS event_object, event.f4_ AS event_value, event.f5_ AS event_map_values, metadata.uri.app_version, osversion AS os_version, metadata.geo.country, metadata.geo.city, metadata.uri.app_name FROM `moz-fx-data-shared-prod.telemetry.focus_event` CROSS JOIN UNNEST(events) AS event ), all_events AS ( SELECT submission_timestamp, client_id AS device_id, (created + COALESCE(SAFE_CAST(`moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'session_id') AS INT64), 0)) AS session_id, CASE WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('launcher') ) THEN 'Rocket - App is launched by Launcher' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('shortcut') ) THEN 'Rocket - App is launched by Shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('private_mode') ) THEN 'Rocket - App is launched from Private Shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('private_shortcut') ) AND event_value IS NULL THEN 'Rocket - Show private shortcut prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('private_shortcut') ) AND (event_value IN ('positive', 'negative', 'dismiss') ) THEN 'Rocket - Click private shortcut prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('setting') ) AND (event_value IN ('pref_private_shortcut') ) THEN 'Rocket - Users clicked on a Setting' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('private_mode') ) AND (event_value IN ('exit') ) THEN 'Rocket - Exit private mode' WHEN (event_category IN ('action') ) AND (event_method IN ('pin_shortcut') ) AND (event_object IN ('private_shortcut') ) AND event_value IS NULL THEN 'Rocket - Private shortcut created' WHEN (event_category IN ('action') ) AND (event_method IN ('kill') ) AND (event_object IN ('app') ) AND event_value IS NULL THEN 'Rocket - Kill app' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('external_app') ) THEN 'Rocket - App is launched by external app' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('setting') ) AND (event_value IN ('learn_more') ) THEN 'Rocket - Users clicked on the Learn More link in Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('pref_locale') ) THEN 'Rocket - Users change Locale in Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('foreground') ) AND (event_object IN ('app') ) AND event_value IS NULL THEN 'Rocket - Session starts' WHEN (event_category IN ('action') ) AND (event_method IN ('background') ) AND (event_object IN ('app') ) AND event_value IS NULL THEN 'Rocket - Session ends' WHEN (event_category IN ('action') ) AND (event_method IN ('long_press') ) AND (event_object IN ('browser') ) AND event_value IS NULL THEN 'Rocket - Long Press ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('cancel') ) AND (event_object IN ('browser_contextmenu') ) AND event_value IS NULL THEN 'Rocket - Cancel ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('link') ) THEN 'Rocket - Share link via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('image') ) THEN 'Rocket - Share image via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('save') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('image') ) THEN 'Rocket - Save image via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('copy') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('link') ) THEN 'Rocket - Copy link via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('copy') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('image') ) THEN 'Rocket - Copy image via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('link') ) THEN 'Rocket - Add link via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('permission') ) AND (event_object IN ('browser') ) AND (event_value IN ('geolocation') ) THEN 'Rocket - Permission-Geolocation' WHEN (event_category IN ('action') ) AND (event_method IN ('permission') ) AND (event_object IN ('browser') ) AND (event_value IN ('file') ) THEN 'Rocket - Permission-File' WHEN (event_category IN ('action') ) AND (event_method IN ('permission') ) AND (event_object IN ('browser') ) AND (event_value IN ('audio', 'video', 'eme', 'midi') ) THEN 'Rocket - Permission-Media' WHEN (event_category IN ('action') ) AND (event_method IN ('fullscreen') ) AND (event_object IN ('browser') ) AND (event_value IN ('enter') ) THEN 'Rocket - Enter full screen' WHEN (event_category IN ('action') ) AND (event_method IN ('fullscreen') ) AND (event_object IN ('browser') ) AND (event_value IN ('exit') ) THEN 'Rocket - Exit full screen' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('home') ) THEN 'Rocket - Show Menu from Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('tab_tray') ) AND (event_value IN ('home') ) THEN 'Rocket - Show TabTray from Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('tab_tray') ) AND (event_value IN ('toolbar') ) THEN 'Rocket - Show TabTray from Toolbar' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('toolbar') ) THEN 'Rocket - Show Menu from Toolbar' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('download') ) THEN 'Rocket - Click Menu - Downloads' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('history') ) THEN 'Rocket - Click Menu - History' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('capture') ) THEN 'Rocket - Click Menu - MyShots' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Click Panel - Bookmarks' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('download') ) THEN 'Rocket - Click Panel - Downloads' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('history') ) THEN 'Rocket - Click Panel - History' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('capture') ) THEN 'Rocket - Click Panel - MyShots' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('turbo') ) THEN 'Rocket - Click Menu - TurboMode' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('night_mode') ) THEN 'Rocket - Click Menu - Night Mode' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('block_image') ) THEN 'Rocket - Click Menu - Block Images' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('clear_cache') ) THEN 'Rocket - Click Menu - Clear cache' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('settings') ) THEN 'Rocket - Click Menu - Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('exit') ) THEN 'Rocket - Click Menu - Exit' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Click Menu - Bookmarks' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('theme') ) THEN 'Rocket - Click Menu - Theme' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('add_topsite') ) THEN 'Rocket - Click Menu - Add Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('vertical') ) THEN 'Rocket - Click Menu - Vertical Toggle' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('forward') ) THEN 'Rocket - Click Toolbar - Forward' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('reload') ) THEN 'Rocket - Click Toolbar - Reload' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Toolbar - Share Link' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Click Toolbar - Add bookmark' WHEN (event_category IN ('action') ) AND (event_method IN ('pin_shortcut') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Toolbar - Pin shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('pin_shortcut') ) AND (event_object IN ('menu') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Menu - Pin shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('capture') ) THEN 'Rocket - Click Toolbar - Take Screenshot' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Top Site' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Remove Top Site' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Add Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('snackbar') ) AND (event_value IN ('add_topsite') ) THEN 'Rocket - Click Add Topsite Snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('add_topsite') ) THEN 'Rocket - Select to Add Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('theme') ) THEN 'Rocket - Show Theme Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('theme') ) THEN 'Rocket - Click Theme Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('go_set_default') ) THEN 'Rocket - Show Go-Set-Default Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('go_set_default') ) THEN 'Rocket - Click Go-Set-Default Message' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('home') ) THEN 'Rocket - Search in Home and add a tab' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('link') ) THEN 'Rocket - Enter an url in SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('select_query') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Use SearchSuggestion SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('type_query') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Search with text in SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('private_mode') ) AND (event_value IN ('enter', 'exit') ) THEN 'Rocket - Toggle Private Mode' WHEN (event_category IN ('action') ) AND (event_method IN ('long_press') ) AND (event_object IN ('search_suggestion') ) AND event_value IS NULL THEN 'Rocket - Long click on Search Suggestion' WHEN (event_category IN ('action') ) AND (event_method IN ('clear') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Clear SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('cancel') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Dismiss SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('search_box') ) THEN 'Rocket - Show SearchBar from Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('mini_urlbar') ) THEN 'Rocket - Show SearchBar by clicking MINI_URLBAR' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('search_btn') ) THEN 'Rocket - Show SearchBar by clicking SEARCH_BUTTON' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('toolbar') ) THEN 'Rocket - Add Tab from Toolbar' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Add Tab from TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('private_mode') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Enter Private Mode from TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Switch Tab From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Remove Tab From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Swipe Tab From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('close_all') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Close all From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('panel') ) AND (event_value IN ('file') ) THEN 'Rocket - Remove Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('delete') ) AND (event_object IN ('panel') ) AND (event_value IN ('file') ) THEN 'Rocket - Delete Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('file') ) THEN 'Rocket - Open Download File via snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('download') ) THEN 'Rocket - Show File ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('link') ) THEN 'Rocket - History Open Link' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('panel') ) AND (event_value IN ('link') ) THEN 'Rocket - History Remove Link' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Bookmark Remove Item' WHEN (event_category IN ('action') ) AND (event_method IN ('edit') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Bookmark Edit Item' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Bookmark Open Item' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('history') ) THEN 'Rocket - Show History ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Show Bookmark ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('clear') ) AND (event_object IN ('panel') ) AND (event_value IN ('history') ) THEN 'Rocket - Clear History' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('capture') ) THEN 'Rocket - Open Capture Item' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('capture') ) AND (event_value IN ('link') ) THEN 'Rocket - Open Capture Link' WHEN (event_category IN ('action') ) AND (event_method IN ('edit') ) AND (event_object IN ('capture') ) AND (event_value IN ('image') ) THEN 'Rocket - Edit Capture Image' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('capture') ) AND (event_value IN ('image') ) THEN 'Rocket - Share Capture Image' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('capture') ) AND (event_value IN ('info') ) THEN 'Rocket - Show Capture Info' WHEN (event_category IN ('action') ) AND (event_method IN ('delete') ) AND (event_object IN ('capture') ) AND (event_value IN ('image') ) THEN 'Rocket - Delete Capture Image' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('feedback') ) AND (event_value IN ('dismiss', 'positive', 'negative') OR event_value IS NULL) THEN 'Rocket - click Rate App' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('feedback') ) AND event_value IS NULL THEN 'Rocket - Show Rate App' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('default_browser') ) AND event_value IS NULL THEN 'Rocket - Default Browser Notification shown' WHEN (event_category IN ('action') ) AND (event_method IN ('get') ) AND (event_object IN ('firstrun_push') ) AND event_value IS NULL THEN 'Rocket - Receive Firstrun Push config' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('firstrun_push') ) AND event_value IS NULL THEN 'Rocket - Firstrun Push notification shown' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('default_browser') ) AND event_value IS NULL THEN 'Rocket - Default Browser Notification Clicked' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('promote_share') ) AND (event_value IN ('dismiss', 'share') ) THEN 'Rocket - Promote Share Dialog Clicked' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('promote_share') ) AND event_value IS NULL THEN 'Rocket - Promote Share Dialog shown' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('themetoy') ) AND event_value IS NULL THEN 'Rocket - Change Theme To' WHEN (event_category IN ('action') ) AND (event_method IN ('reset') ) AND (event_object IN ('themetoy') ) AND event_value IS NULL THEN 'Rocket - Reset Theme To' WHEN (event_category IN ('action') ) AND (event_method IN ('clear') ) AND (event_object IN ('private_mode') ) AND event_value IS NULL THEN 'Rocket - Erase Private Mode Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('home') ) AND event_value IS NULL THEN 'Rocket - Home Impression' WHEN (event_category IN ('Downloads') ) AND (event_method IN ('long_press') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('download') ) THEN 'Rocket - Long Press Toolbar Download Indicator' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('find_in_page') ) AND (event_value IN ('next') ) THEN 'Rocket - Click FindInPage Next' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('find_in_page') ) AND (event_value IN ('previous') ) THEN 'Rocket - Click FindInPage Previous' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('find_in_page') ) THEN 'Rocket - Click Menu FindInPage' WHEN (event_category IN ('search') ) AND (event_method IN ('click') ) AND (event_object IN ('quicksearch') ) AND event_value IS NULL THEN 'Rocket - Click Quick Search' WHEN (event_category IN ('enter landscape mode') ) AND (event_method IN ('change') ) AND (event_object IN ('landscape_mode') ) AND (event_value IN ('enter') ) THEN 'Rocket - Enter Landscape Mode' WHEN (event_category IN ('enter landscape mode') ) AND (event_method IN ('change') ) AND (event_object IN ('landscape_mode') ) AND (event_value IN ('exit') ) THEN 'Rocket - Exit Landscape Mode' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('update_msg') ) AND event_value IS NULL THEN 'Rocket - Show in-app update intro dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('update') ) AND event_value IS NULL THEN 'Rocket - Show google play\\'s in-app update dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('update_msg') ) AND (event_value IN ('positive', 'negative') ) THEN 'Rocket - Click in-app update intro dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('update') ) AND (event_value IN ('positive', 'negative') ) THEN 'Rocket - Click google play\\'s in-app update dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('update') ) AND (event_value IN ('downloaded') ) THEN 'Rocket - Show in-app update install prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('update') ) AND (event_value IN ('apply') ) THEN 'Rocket - Click in-app update install prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Show Firstrun Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Click Firstrun Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('logoman') ) AND event_value IS NULL THEN 'Rocket - Show Logoman' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('logoman') ) AND event_value IS NULL THEN 'Rocket - Click Logoman' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('logoman') ) AND event_value IS NULL THEN 'Rocket - Swipe Logoman' WHEN (event_category IN ('action') ) AND (event_method IN ('get') ) AND (event_object IN ('notification') ) AND event_value IS NULL THEN 'Rocket - Get Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('notification') ) AND event_value IS NULL THEN 'Rocket - Show Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('notification') ) AND (event_value IN ('dismiss') ) THEN 'Rocket - Dismiss Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('firstrun_push') ) AND (event_value IN ('dismiss') ) THEN 'Rocket - Dismiss D1 Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('notification') ) AND event_value IS NULL THEN 'Rocket - Open Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('firstrun_push') ) AND event_value IS NULL THEN 'Rocket - Open D1 Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('in_app_message') ) THEN 'Rocket - Show In-App Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('in_app_message') ) THEN 'Rocket - Click In-App Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('content_hub') ) AND event_value IS NULL THEN 'Rocket - Click Content Hub' WHEN (event_category IN ('action') ) AND (event_method IN ('reload') ) AND (event_object IN ('content_home') ) AND event_value IS NULL THEN 'Rocket - Reload Content Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('content_home') ) THEN 'Rocket - Show Content Home Search Bar' WHEN (event_category IN ('action') ) AND (event_method IN ('select_query') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('content_home') ) THEN 'Rocket - Select Query Content Home' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('category') ) AND event_value IS NULL THEN 'Rocket - Open Category' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('detail_page') ) AND (event_value IN ('more') ) THEN 'Rocket - Open Detail Page More' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('content_tab') ) AND event_value IS NULL THEN 'Rocket - Start Content Tab' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('content_tab') ) AND event_value IS NULL THEN 'Rocket - End Content Tab' WHEN (event_category IN ('action') ) AND (event_method IN ('impression') ) AND (event_object IN ('category') ) AND event_value IS NULL THEN 'Rocket - Category Impression' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('process') ) AND (event_value IN ('vertical') ) THEN 'Rocket - Start Vertical Process' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('process') ) AND (event_value IN ('vertical') ) THEN 'Rocket - End Vertical Process' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('vertical') ) THEN 'Rocket - Show Vertical Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('process') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Start Tab Swipe Process' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('process') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - End Tab Swipe Process' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('tab_swipe') ) AND event_value IS NULL THEN 'Rocket - Start Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('tab_swipe') ) AND event_value IS NULL THEN 'Rocket - End Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('share') ) THEN 'Rocket - Click Toolbar - Share' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('OPEN_IN_BROWSER') ) THEN 'Rocket - Click Toolbar - Open in browser' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('reload') ) THEN 'Rocket - Click Toolbar - Reload' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('back') ) THEN 'Rocket - Click Toolbar - Back' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Click Toolbar - Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('drawer') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Show Tab Swipe Drawer' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('drawer') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Click Tab Swipe Drawer' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Add Tab Swipe Tab' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Change Tab Swipe Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Show SearchBar from Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('show_keyboard') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Show Keyboard from Tab Swipe SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('start_typing') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Start Typing from Tab Swipe SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('type_query') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Search with text in SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('select_query') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Use SearchSuggestion in Tab Swipe SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('detail_page') ) THEN 'Rocket - Change Travel Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('personalization') ) THEN 'Rocket - Change Personalization in Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('language') ) THEN 'Rocket - Change Language in Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('setting') ) AND (event_value IN ('lifestyle') ) THEN 'Rocket - Click News Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('category') ) THEN 'Rocket - Change Category in Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('lifestyle') ) THEN 'Rocket - Change News Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('pin') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Pin Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('challenge_page') ) AND (event_value IN ('join') ) THEN 'Rocket - Click Challenge Page Join' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('task') ) THEN 'Rocket - Show Task Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('task') ) AND event_value IS NULL THEN 'Rocket - End Task' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('challenge_complete') ) THEN 'Rocket - Show Challenge Complete Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('challenge_complete') ) THEN 'Rocket - Click Challenge Complete Message' WHEN (event_category IN ('action') ) AND (event_method IN ('sign_in') ) AND (event_object IN ('account') ) AND event_value IS NULL THEN 'Rocket - Account Sign In' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('redeem_page') ) AND event_value IS NULL THEN 'Rocket - Show Redeem Page' WHEN (event_category IN ('action') ) AND (event_method IN ('copy') ) AND (event_object IN ('redeem_page') ) AND (event_value IN ('code') ) THEN 'Rocket - Copy Code on Redeem Page' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('redeem_page') ) AND (event_value IN ('use') ) THEN 'Rocket - Click Redeem on Redeem Page' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('profile') ) AND (event_value IN ('reward') ) THEN 'Rocket - Click Reward Profile' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('content_home') ) AND (event_value IN ('item') ) THEN 'Rocket - Click Content Home Item' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('challenge_page') ) AND (event_value IN ('login') ) THEN 'Rocket - Click Chellenge Page Login' WHEN (event_category IN ('action') ) AND (event_method IN ('long_press') ) AND (event_object IN ('content_home') ) AND (event_value IN ('item') ) THEN 'Rocket - Long Press Content Home Item' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('content_home') ) AND (event_value IN ('contextmenu') ) THEN 'Rocket - Click Content Home Contextmenu' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('game_shortcut') ) THEN 'Rocket - App is launched by Game Shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('update') ) THEN 'Rocket - Show Update Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('update') ) THEN 'Rocket - Click Update Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('game_shortcut') ) THEN 'Rocket - Show Game Shortcut Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('travel_search_result') ) THEN 'Rocket - Show Travel Search Result Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('travel_search_result') ) THEN 'Rocket - Click Travel Search Result Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('setdefault_travel_search') ) THEN 'Rocket - Show Set-default Travel Search Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('setdefault_travel_search') ) THEN 'Rocket - Click Set-default Travel Search Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('toast') ) AND (event_value IN ('exit_warning') ) THEN 'Rocket - Show Exit Warning Toast' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_settings') ) THEN 'Rocket - Show Set-Default by Settings Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_link') ) THEN 'Rocket - Show Set-Default by Link Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_settings') ) THEN 'Rocket - Click Set-Default by Settings Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_link') ) THEN 'Rocket - Click Set-Default by Link Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('toast') ) AND (event_value IN ('set_default_success') ) THEN 'Rocket - Show Set-Default Success Toast' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('snackbar') ) AND (event_value IN ('set_default_try_again') ) THEN 'Rocket - Show Set-Default Try-again Snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('snackbar') ) AND (event_value IN ('set_default_try_again') ) THEN 'Rocket - Click Set-Default Try-again Snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('download') ) AND (event_value IN ('file') ) THEN 'Rocket - Start Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('download') ) AND (event_value IN ('file') ) THEN 'Rocket - End Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('firstrun') ) AND (event_value IN ('turbo') ) THEN 'Rocket - Turn on Turbo Mode in First Run' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('firstrun') ) AND (event_value IN ('finish') ) THEN 'Rocket - Finish First Run' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Show Whatsnew Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Click Whatsnew Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Show Firstrun Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Show Whatsnew Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Click Firstrun Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Click Whatsnew Contextual Hint' END AS event_name, event_timestamp AS timestamp, (event_timestamp + created) AS time, app_version, os AS os_name, os_version, country, city, (SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM UNNEST(event_map_values)) AS event_props_1, event_map_values, event_object, event_value, event_method, event_category, created, settings FROM base_events WHERE app_name IN ('Zerda', 'OTHER') AND os IN ('Android') ), all_events_with_insert_ids AS ( SELECT * EXCEPT (event_category, created), CONCAT(device_id, \"-\", CAST(created AS STRING), \"-\", SPLIT(event_name, \" - \")[OFFSET(1)], \"-\", CAST(timestamp AS STRING), \"-\", event_category, \"-\", event_method, \"-\", event_object) AS insert_id, event_name AS event_type FROM all_events WHERE event_name IS NOT NULL ), extra_props AS ( SELECT * EXCEPT (event_map_values, event_object, event_value, event_method, event_name), (SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM ( SELECT 'to' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') AS value UNION ALL SELECT 'on' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'on') AS value UNION ALL SELECT 'from' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from') AS value UNION ALL SELECT 'mode' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'mode') AS value UNION ALL SELECT 'type' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'type') AS value UNION ALL SELECT 'source' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'source') AS value UNION ALL SELECT 'default' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'default') AS value UNION ALL SELECT 'position' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'position') AS value UNION ALL SELECT 'version' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'version') AS value UNION ALL SELECT 'category' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'category') AS value UNION ALL SELECT 'category_versio' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'category_versio') AS value UNION ALL SELECT 'snackbar' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'snackbar') AS value UNION ALL SELECT 'success' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'success') AS value UNION ALL SELECT 'delay' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'delay') AS value UNION ALL SELECT 'message' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'message') AS value UNION ALL SELECT 'engine' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'engine') AS value UNION ALL SELECT 'duration' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'duration') AS value UNION ALL SELECT 'from_build' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from_build') AS value UNION ALL SELECT 'to_build' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to_build') AS value UNION ALL SELECT 'action' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'action') AS value UNION ALL SELECT 'finish' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'finish') AS value UNION ALL SELECT 'page' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'page') AS value UNION ALL SELECT 'message_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'message_id') AS value UNION ALL SELECT 'link' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'link') AS value UNION ALL SELECT 'background' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'background') AS value UNION ALL SELECT 'primary' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'primary') AS value UNION ALL SELECT 'vertical' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'vertical') AS value UNION ALL SELECT 'component_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'component_id') AS value UNION ALL SELECT 'feed' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'feed') AS value UNION ALL SELECT 'subcategory_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'subcategory_id') AS value UNION ALL SELECT 'version_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'version_id') AS value UNION ALL SELECT 'app_link' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'app_link') AS value UNION ALL SELECT 'session_time' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'session_time') AS value UNION ALL SELECT 'show_keyboard' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'show_keyboard') AS value UNION ALL SELECT 'url_counts' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'url_counts') AS value UNION ALL SELECT 'impression' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'impression') AS value UNION ALL SELECT 'loadtime' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'loadtime') AS value UNION ALL SELECT 'audience_name' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'audience_name') AS value UNION ALL SELECT 'finished' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'finished') AS value UNION ALL SELECT 'task' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'task') AS value UNION ALL SELECT 'item_name' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'item_name') AS value ) WHERE VALUE IS NOT NULL) AS event_props_2, ARRAY_CONCAT(ARRAY<STRING>[], (SELECT ARRAY_AGG( CASE WHEN key='pref_search_engine' THEN CONCAT('\"', 'pref_search_engine', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_privacy_turbo_mode' THEN CONCAT('\"', 'pref_privacy_turbo_mode', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key='pref_performance_block_images' THEN CONCAT('\"', 'pref_performance_block_images', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key='pref_default_browser' THEN CONCAT('\"', 'pref_default_browser', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key='pref_save_downloads_to' THEN CONCAT('\"', 'pref_save_downloads_to', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_webview_version' THEN CONCAT('\"', 'pref_webview_version', '\":\"', CAST(value AS STRING), '\"') WHEN key='install_referrer' THEN CONCAT('\"', 'install_referrer', '\":\"', CAST(value AS STRING), '\"') WHEN key='experiment_name' THEN CONCAT('\"', 'experiment_name', '\":\"', CAST(value AS STRING), '\"') WHEN key='experiment_bucket' THEN CONCAT('\"', 'experiment_bucket', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_locale' THEN CONCAT('\"', 'pref_locale', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_key_s_tracker_token' THEN CONCAT('\"', 'pref_key_s_tracker_token', '\":\"', CAST(value AS STRING), '\"') END IGNORE NULLS) FROM UNNEST(SETTINGS) )) AS user_props FROM all_events_with_insert_ids ) SELECT * EXCEPT (event_props_1, event_props_2, user_props, settings), CONCAT('{', ARRAY_TO_STRING(( SELECT ARRAY_AGG(DISTINCT e) FROM UNNEST(ARRAY_CONCAT(IFNULL(event_props_1, []), IFNULL(event_props_2, []))) AS e ), \",\"), '}') AS event_properties, CONCAT('{', ARRAY_TO_STRING(user_props, \",\"), '}') AS user_properties FROM extra_props windows_10_aggregate View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.windows_10_aggregate` AS WITH aggregated AS ( SELECT os AS name, os_version AS version, windows_build_number AS build_number, CAST(windows_ubr AS STRING) AS ubr, CASE WHEN windows_build_number <= 10240 THEN '1507' WHEN windows_build_number <= 10586 THEN '1511' WHEN windows_build_number <= 14393 THEN '1607' WHEN windows_build_number <= 15063 THEN '1703' WHEN windows_build_number <= 16299 THEN '1709' WHEN windows_build_number <= 17134 THEN '1803' WHEN windows_build_number <= 17763 THEN '1809' WHEN windows_build_number <= 18362 THEN '1903' WHEN windows_build_number <= 18363 THEN '1909' WHEN windows_build_number <= 19041 THEN '2004' WHEN windows_build_number <= 19042 THEN '20H2' WHEN windows_build_number > 19042 THEN 'Insider' ELSE NULL END AS build_group, SPLIT(app_version, \".\")[OFFSET(0)] AS ff_build_version, normalized_channel, COUNT(*) AS `count` FROM `moz-fx-data-shared-prod.telemetry.clients_daily` WHERE submission_date > DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AND os = 'Windows_NT' AND STARTS_WITH(os_version, '10') AND SAFE_CAST(SPLIT(app_version, \".\")[OFFSET(0)] AS INT64) >= 47 AND sample_id = 42 GROUP BY name, version, build_number, ubr, build_group, ff_build_version, normalized_channel), total AS ( SELECT SUM(count) total_obs FROM aggregated) SELECT * FROM aggregated CROSS JOIN total telemetry_anonymous_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_anonymous_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date_s3, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id, metadata.uri.app_name, metadata.uri.app_update_channel, normalized_channel ) AS metadata, application, creation_date, id, payload, type, version FROM `moz-fx-data-shared-prod.telemetry.anonymous` sync View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.sync` AS SELECT * REPLACE( `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata) FROM `moz-fx-data-shared-prod.telemetry_stable.sync_v4` experiment_cumulative_search_count View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_cumulative_search_count` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_cumulative_search_count_v1` events View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.events` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.events_v1` experiment_cumulative_ad_clicks View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_cumulative_ad_clicks` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_cumulative_ad_clicks_v1` crash_summary_v2 View -- Query generated by: templates/unnest_parquet_view.sql.py crash_summary_v2 telemetry_derived.crash_summary_v2 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_summary_v2` AS SELECT * REPLACE ( experiments.key_value AS experiments, (SELECT AS STRUCT payload.* REPLACE (payload.metadata.key_value AS metadata)) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_derived.crash_summary_v2` telemetry_heartbeat_parquet_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_heartbeat_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, type, id, creation_date, version, client_id, application, (SELECT AS STRUCT payload.* replace (CAST(version AS int64) AS version)) AS payload, STRUCT( UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, document_id, metadata.uri.app_build_id, metadata.uri.app_name ) AS metadata, engagement_type FROM `moz-fx-data-shared-prod.telemetry.heartbeat` smoot_usage_day_13 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.smoot_usage_day_13` AS WITH unioned AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_desktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_nondesktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_fxa_v2` ) -- SELECT DATE_SUB(submission_date, INTERVAL 13 DAY) AS `date`, usage, metrics.day_13.*, * EXCEPT (submission_date, usage, metrics) FROM unioned lockwise_mobile_events_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.lockwise_mobile_events_v1` AS -- WITH android AS ( SELECT os, client_id, submission_date_s3, timestamp_seconds(cast(substr(cast(metadata.timestamp AS string), 1, 10) AS int64)) AS submission_timestamp, device, metadata.app_build_id, e.* FROM `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet_v2`, UNNEST(events) AS e WHERE metadata.app_name = 'Lockbox' AND os = 'Android' -- Filter out test data before the Android launch date. AND submission_date_s3 >= '2019-03-25' ), -- ios AS ( SELECT os, client_id, submission_date_s3, timestamp_seconds(cast(substr(cast(metadata.timestamp AS string), 1, 10) AS int64)) AS submission_timestamp, device, metadata.app_build_id, e.* FROM `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet_v1`, UNNEST(events) AS e WHERE metadata.app_name = 'Lockbox' AND os = 'iOS' -- Filter out test data before the iOS launch date. AND submission_date_s3 >= '2018-07-09' ) -- SELECT * FROM android UNION ALL SELECT * FROM ios telemetry_shield_study_parquet_v1 View -- Query generated by: templates/unnest_parquet_view.sql.py telemetry_shield_study_parquet_v1 telemetry_derived.telemetry_shield_study_parquet_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_shield_study_parquet_v1` AS SELECT submission_date AS submission, * REPLACE ( (SELECT AS STRUCT application.* REPLACE ((SELECT AS STRUCT application.addons.* REPLACE (application.addons.active_addons.key_value AS active_addons, application.addons.active_gmplugins.key_value AS active_gmplugins)) AS addons)) AS application, (SELECT AS STRUCT payload.* REPLACE ((SELECT AS STRUCT payload.data.* REPLACE (payload.data.attributes.key_value AS attributes)) AS data)) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_shield_study_parquet_v1` firefox_nondesktop_exact_mau28_by_product_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_product_v1` AS SELECT submission_date, product, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), mau, 0)) AS tier1_mau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), wau, 0)) AS tier1_wau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), dau, 0)) AS tier1_dau FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` GROUP BY submission_date, product telemetry_anonymous_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_anonymous_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_anonymous_parquet_v1` events_v1 View -- Creates a union view to provide continuity between legacy parquet events view and new -- all-gcp events tables CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.events_v1` AS WITH parquet_events AS ( SELECT * EXCEPT ( -- These are old fields that were removed in the parquet job but resurfaced in the BQ import e10s_enabled, e10s_cohort, subsession_start_date, subsession_length, sync_configured, sync_count_desktop, sync_count_mobile, active_experiment_id, active_experiment_branch ) REPLACE( event_map_values.key_value AS event_map_values, -- experiments struct in new events includes enrollment_id and type subfields ( SELECT ARRAY_AGG( STRUCT( e.key AS key, STRUCT( e.value AS branch, CAST(NULL AS string) AS enrollment_id, CAST(NULL AS string) AS `type` ) AS value ) ) FROM UNNEST(experiments.key_value) e ) AS experiments, -- Bug 1525620: fix inconsistencies in timestamp resolution for main vs event events CASE WHEN doc_type = 'main' THEN SAFE.TIMESTAMP_MICROS(CAST(`timestamp` / 1000 AS INT64)) ELSE SAFE.TIMESTAMP_SECONDS(`timestamp`) END AS `timestamp`, SAFE.TIMESTAMP_MILLIS(session_start_time) AS session_start_time ), CAST(NULL AS STRING) AS build_id FROM `moz-fx-data-shared-prod.telemetry_derived.events_v1` WHERE submission_date < '2019-10-31' ), main_events AS ( SELECT submission_date, 'main' AS doc_type, document_id, client_id, normalized_channel, country, locale, app_name, app_version, os, os_version, `timestamp`, sample_id, event_timestamp, event_category, event_method, event_object, event_string_value, event_map_values, experiments, event_process, subsession_id, session_start_time, session_id, build_id FROM `moz-fx-data-shared-prod`.telemetry_derived.main_events_v1 WHERE submission_date >= '2019-10-31' ), event_events AS ( SELECT submission_date, 'event' AS doc_type, document_id, client_id, normalized_channel, country, locale, app_name, app_version, os, os_version, `timestamp`, sample_id, event_timestamp, event_category, event_method, event_object, event_string_value, event_map_values, experiments, event_process, subsession_id, session_start_time, session_id, build_id FROM `moz-fx-data-shared-prod`.telemetry_derived.event_events_v1 WHERE submission_date >= '2019-10-31' ) SELECT * FROM parquet_events UNION ALL SELECT * FROM main_events UNION ALL SELECT * FROM event_events ssl_ratios View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.ssl_ratios` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.ssl_ratios_v1` accessibility_clients View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.accessibility_clients` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.accessibility_clients_v1` experiment_enrollment_aggregates_hourly View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_aggregates_hourly` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_aggregates_hourly_v1` firefox_accounts_exact_mau28_by_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions_v1` firefox_nondesktop_exact_mau28_by_product View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_product` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_product_v1` first_shutdown_summary View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.first_shutdown_summary` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.first_shutdown_summary_v4` main_nightly View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_nightly` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.main_nightly_v1` firefox_accounts_exact_mau28_by_dimensions_v1 View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions_v1` AS SELECT raw.* EXCEPT (mau_tier1_inclusive), -- We rename this column here to match the new standard of prefixing _mau -- with the usage criterion; we can refactor to have the correct name in -- the raw table the next time we need to make a change and backfill. mau_tier1_inclusive AS seen_in_tier1_country_mau, COALESCE(cn.code, raw.country) AS country_code FROM `moz-fx-data-shared-prod.firefox_accounts_derived.exact_mau28_v1` AS raw LEFT JOIN `moz-fx-data-shared-prod.static.country_names_v1` cn ON (raw.country = cn.name) telemetry_new_profile_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_new_profile_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_new_profile_parquet_v2` firefox_desktop_exact_mau28_by_dimensions View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_dimensions_v1` origin_content_blocking View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.origin_content_blocking` AS WITH most_recent AS ( SELECT * EXCEPT(_n) FROM ( SELECT *, ROW_NUMBER() OVER ( PARTITION BY submission_date, batch_id, origin ORDER BY TIMESTAMP DESC ) AS _n FROM `moz-fx-data-shared-prod.telemetry_derived.origin_content_blocking` ) WHERE _n = 1 ) SELECT submission_date, batch_id, origin, aggregate FROM most_recent first_shutdown_summary_v4 View -- Query generated by: templates/unnest_parquet_view.sql.py first_shutdown_summary_v4 telemetry_derived.first_shutdown_summary_v4 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.first_shutdown_summary_v4` AS SELECT submission_date AS submission_date_s3, * REPLACE ( ARRAY(SELECT * FROM UNNEST(active_addons.list)) AS active_addons, ARRAY(SELECT * FROM UNNEST(antispyware.list)) AS antispyware, ARRAY(SELECT * FROM UNNEST(antivirus.list)) AS antivirus, boolean_addon_scalars.key_value AS boolean_addon_scalars, ARRAY(SELECT * FROM UNNEST(disabled_addons_ids.list)) AS disabled_addons_ids, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_accept_languages.list) ) AS environment_settings_intl_accept_languages, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_app_locales.list) ) AS environment_settings_intl_app_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_available_locales.list) ) AS environment_settings_intl_available_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_regional_prefs_locales.list) ) AS environment_settings_intl_regional_prefs_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_requested_locales.list) ) AS environment_settings_intl_requested_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_system_locales.list) ) AS environment_settings_intl_system_locales, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (_0.element.map_values.key_value AS map_values) FROM UNNEST(events.list) AS _0 ) AS events, experiments.key_value AS experiments, ARRAY(SELECT * FROM UNNEST(firewall.list)) AS firewall, histogram_content_a11y_consumers.key_value AS histogram_content_a11y_consumers, histogram_content_a11y_instantiated_flag.key_value AS histogram_content_a11y_instantiated_flag, histogram_content_cert_validation_success_by_ca.key_value AS histogram_content_cert_validation_success_by_ca, histogram_content_checkerboard_severity.key_value AS histogram_content_checkerboard_severity, histogram_content_composite_time.key_value AS histogram_content_composite_time, histogram_content_content_paint_time.key_value AS histogram_content_content_paint_time, histogram_content_cycle_collector_max_pause.key_value AS histogram_content_cycle_collector_max_pause, histogram_content_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_content_devtools_accessibility_picker_time_active_seconds, histogram_content_devtools_accessibility_service_time_active_seconds.key_value AS histogram_content_devtools_accessibility_service_time_active_seconds, histogram_content_devtools_accessibility_time_active_seconds.key_value AS histogram_content_devtools_accessibility_time_active_seconds, histogram_content_devtools_toolbox_time_active_seconds.key_value AS histogram_content_devtools_toolbox_time_active_seconds, histogram_content_fx_new_window_ms.key_value AS histogram_content_fx_new_window_ms, histogram_content_fx_page_load_ms_2.key_value AS histogram_content_fx_page_load_ms_2, histogram_content_fx_searchbar_selected_result_method.key_value AS histogram_content_fx_searchbar_selected_result_method, histogram_content_fx_session_restore_restore_window_ms.key_value AS histogram_content_fx_session_restore_restore_window_ms, histogram_content_fx_session_restore_startup_init_session_ms.key_value AS histogram_content_fx_session_restore_startup_init_session_ms, histogram_content_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_content_fx_session_restore_startup_onload_initial_window_ms, histogram_content_fx_tab_close_time_anim_ms.key_value AS histogram_content_fx_tab_close_time_anim_ms, histogram_content_fx_tab_switch_update_ms.key_value AS histogram_content_fx_tab_switch_update_ms, histogram_content_fx_urlbar_selected_result_index.key_value AS histogram_content_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_content_fx_urlbar_selected_result_index_by_type, histogram_content_fx_urlbar_selected_result_method.key_value AS histogram_content_fx_urlbar_selected_result_method, histogram_content_fx_urlbar_selected_result_type.key_value AS histogram_content_fx_urlbar_selected_result_type, histogram_content_gc_animation_ms.key_value AS histogram_content_gc_animation_ms, histogram_content_gc_max_pause_ms.key_value AS histogram_content_gc_max_pause_ms, histogram_content_gc_max_pause_ms_2.key_value AS histogram_content_gc_max_pause_ms_2, histogram_content_geolocation_request_granted.key_value AS histogram_content_geolocation_request_granted, histogram_content_ghost_windows.key_value AS histogram_content_ghost_windows, histogram_content_gpu_process_initialization_time_ms.key_value AS histogram_content_gpu_process_initialization_time_ms, histogram_content_gpu_process_launch_time_ms_2.key_value AS histogram_content_gpu_process_launch_time_ms_2, histogram_content_http_channel_disposition.key_value AS histogram_content_http_channel_disposition, histogram_content_http_pageload_is_ssl.key_value AS histogram_content_http_pageload_is_ssl, histogram_content_http_transaction_is_ssl.key_value AS histogram_content_http_transaction_is_ssl, histogram_content_input_event_response_coalesced_ms.key_value AS histogram_content_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_content_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_memory_distribution_among_content.key_value) AS _0 ) AS histogram_content_memory_distribution_among_content, histogram_content_memory_heap_allocated.key_value AS histogram_content_memory_heap_allocated, histogram_content_memory_resident_fast.key_value AS histogram_content_memory_resident_fast, histogram_content_memory_total.key_value AS histogram_content_memory_total, histogram_content_memory_unique.key_value AS histogram_content_memory_unique, histogram_content_memory_unique_content_startup.key_value AS histogram_content_memory_unique_content_startup, histogram_content_memory_vsize.key_value AS histogram_content_memory_vsize, histogram_content_memory_vsize_max_contiguous.key_value AS histogram_content_memory_vsize_max_contiguous, histogram_content_network_cache_metadata_first_read_time_ms.key_value AS histogram_content_network_cache_metadata_first_read_time_ms, histogram_content_network_cache_v2_hit_time_ms.key_value AS histogram_content_network_cache_v2_hit_time_ms, histogram_content_network_cache_v2_miss_time_ms.key_value AS histogram_content_network_cache_v2_miss_time_ms, histogram_content_places_autocomplete_6_first_results_time_ms.key_value AS histogram_content_places_autocomplete_6_first_results_time_ms, histogram_content_plugin_shutdown_ms.key_value AS histogram_content_plugin_shutdown_ms, histogram_content_pwmgr_form_autofill_result.key_value AS histogram_content_pwmgr_form_autofill_result, histogram_content_pwmgr_login_page_safety.key_value AS histogram_content_pwmgr_login_page_safety, histogram_content_sandbox_rejected_syscalls.key_value AS histogram_content_sandbox_rejected_syscalls, histogram_content_search_reset_result.key_value AS histogram_content_search_reset_result, histogram_content_search_service_init_ms.key_value AS histogram_content_search_service_init_ms, histogram_content_ssl_handshake_result.key_value AS histogram_content_ssl_handshake_result, histogram_content_ssl_handshake_version.key_value AS histogram_content_ssl_handshake_version, histogram_content_ssl_tls12_intolerance_reason_pre.key_value AS histogram_content_ssl_tls12_intolerance_reason_pre, histogram_content_ssl_tls13_intolerance_reason_pre.key_value AS histogram_content_ssl_tls13_intolerance_reason_pre, histogram_content_time_to_dom_complete_ms.key_value AS histogram_content_time_to_dom_complete_ms, histogram_content_time_to_dom_content_loaded_end_ms.key_value AS histogram_content_time_to_dom_content_loaded_end_ms, histogram_content_time_to_dom_content_loaded_start_ms.key_value AS histogram_content_time_to_dom_content_loaded_start_ms, histogram_content_time_to_dom_interactive_ms.key_value AS histogram_content_time_to_dom_interactive_ms, histogram_content_time_to_dom_loading_ms.key_value AS histogram_content_time_to_dom_loading_ms, histogram_content_time_to_first_click_ms.key_value AS histogram_content_time_to_first_click_ms, histogram_content_time_to_first_interaction_ms.key_value AS histogram_content_time_to_first_interaction_ms, histogram_content_time_to_first_key_input_ms.key_value AS histogram_content_time_to_first_key_input_ms, histogram_content_time_to_first_mouse_move_ms.key_value AS histogram_content_time_to_first_mouse_move_ms, histogram_content_time_to_first_scroll_ms.key_value AS histogram_content_time_to_first_scroll_ms, histogram_content_time_to_load_event_end_ms.key_value AS histogram_content_time_to_load_event_end_ms, histogram_content_time_to_load_event_start_ms.key_value AS histogram_content_time_to_load_event_start_ms, histogram_content_time_to_non_blank_paint_ms.key_value AS histogram_content_time_to_non_blank_paint_ms, histogram_content_time_to_response_start_ms.key_value AS histogram_content_time_to_response_start_ms, histogram_content_touch_enabled_device.key_value AS histogram_content_touch_enabled_device, histogram_content_tracking_protection_enabled.key_value AS histogram_content_tracking_protection_enabled, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_content_uptake_remote_content_result_1, histogram_content_webext_content_script_injection_ms.key_value AS histogram_content_webext_content_script_injection_ms, histogram_content_webext_storage_local_get_ms.key_value AS histogram_content_webext_storage_local_get_ms, histogram_content_webext_storage_local_set_ms.key_value AS histogram_content_webext_storage_local_set_ms, histogram_content_webvr_time_spent_viewing_in_2d.key_value AS histogram_content_webvr_time_spent_viewing_in_2d, histogram_content_webvr_users_view_in.key_value AS histogram_content_webvr_users_view_in, histogram_gpu_a11y_consumers.key_value AS histogram_gpu_a11y_consumers, histogram_gpu_a11y_instantiated_flag.key_value AS histogram_gpu_a11y_instantiated_flag, histogram_gpu_cert_validation_success_by_ca.key_value AS histogram_gpu_cert_validation_success_by_ca, histogram_gpu_checkerboard_severity.key_value AS histogram_gpu_checkerboard_severity, histogram_gpu_composite_time.key_value AS histogram_gpu_composite_time, histogram_gpu_content_frame_time.key_value AS histogram_gpu_content_frame_time, histogram_gpu_cycle_collector_max_pause.key_value AS histogram_gpu_cycle_collector_max_pause, histogram_gpu_fx_urlbar_selected_result_index.key_value AS histogram_gpu_fx_urlbar_selected_result_index, histogram_gpu_fx_urlbar_selected_result_type.key_value AS histogram_gpu_fx_urlbar_selected_result_type, histogram_gpu_gc_max_pause_ms.key_value AS histogram_gpu_gc_max_pause_ms, histogram_gpu_ghost_windows.key_value AS histogram_gpu_ghost_windows, histogram_gpu_gpu_process_initialization_time_ms.key_value AS histogram_gpu_gpu_process_initialization_time_ms, histogram_gpu_http_channel_disposition.key_value AS histogram_gpu_http_channel_disposition, histogram_gpu_http_pageload_is_ssl.key_value AS histogram_gpu_http_pageload_is_ssl, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_gpu_ipc_read_main_thread_latency_ms, histogram_gpu_search_reset_result.key_value AS histogram_gpu_search_reset_result, histogram_gpu_ssl_handshake_result.key_value AS histogram_gpu_ssl_handshake_result, histogram_gpu_ssl_handshake_version.key_value AS histogram_gpu_ssl_handshake_version, histogram_gpu_ssl_tls12_intolerance_reason_pre.key_value AS histogram_gpu_ssl_tls12_intolerance_reason_pre, histogram_gpu_ssl_tls13_intolerance_reason_pre.key_value AS histogram_gpu_ssl_tls13_intolerance_reason_pre, histogram_gpu_time_to_first_click_ms.key_value AS histogram_gpu_time_to_first_click_ms, histogram_gpu_time_to_first_interaction_ms.key_value AS histogram_gpu_time_to_first_interaction_ms, histogram_gpu_time_to_first_key_input_ms.key_value AS histogram_gpu_time_to_first_key_input_ms, histogram_gpu_time_to_first_mouse_move_ms.key_value AS histogram_gpu_time_to_first_mouse_move_ms, histogram_gpu_time_to_first_scroll_ms.key_value AS histogram_gpu_time_to_first_scroll_ms, histogram_gpu_time_to_non_blank_paint_ms.key_value AS histogram_gpu_time_to_non_blank_paint_ms, histogram_gpu_touch_enabled_device.key_value AS histogram_gpu_touch_enabled_device, histogram_gpu_tracking_protection_enabled.key_value AS histogram_gpu_tracking_protection_enabled, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_gpu_uptake_remote_content_result_1, histogram_gpu_webvr_time_spent_viewing_in_oculus.key_value AS histogram_gpu_webvr_time_spent_viewing_in_oculus, histogram_gpu_webvr_time_spent_viewing_in_openvr.key_value AS histogram_gpu_webvr_time_spent_viewing_in_openvr, histogram_gpu_webvr_users_view_in.key_value AS histogram_gpu_webvr_users_view_in, histogram_parent_a11y_consumers.key_value AS histogram_parent_a11y_consumers, histogram_parent_a11y_instantiated_flag.key_value AS histogram_parent_a11y_instantiated_flag, histogram_parent_cert_validation_success_by_ca.key_value AS histogram_parent_cert_validation_success_by_ca, histogram_parent_checkerboard_severity.key_value AS histogram_parent_checkerboard_severity, histogram_parent_composite_time.key_value AS histogram_parent_composite_time, histogram_parent_content_frame_time.key_value AS histogram_parent_content_frame_time, histogram_parent_content_paint_time.key_value AS histogram_parent_content_paint_time, histogram_parent_cookie_behavior.key_value AS histogram_parent_cookie_behavior, histogram_parent_cycle_collector_max_pause.key_value AS histogram_parent_cycle_collector_max_pause, histogram_parent_devtools_about_devtools_opened_key.key_value AS histogram_parent_devtools_about_devtools_opened_key, histogram_parent_devtools_about_devtools_opened_reason.key_value AS histogram_parent_devtools_about_devtools_opened_reason, histogram_parent_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_picker_time_active_seconds, histogram_parent_devtools_accessibility_service_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_service_time_active_seconds, histogram_parent_devtools_accessibility_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_time_active_seconds, histogram_parent_devtools_entry_point.key_value AS histogram_parent_devtools_entry_point, histogram_parent_devtools_fonteditor_font_type_displayed.key_value AS histogram_parent_devtools_fonteditor_font_type_displayed, histogram_parent_devtools_fonteditor_n_font_axes.key_value AS histogram_parent_devtools_fonteditor_n_font_axes, histogram_parent_devtools_fonteditor_n_fonts_rendered.key_value AS histogram_parent_devtools_fonteditor_n_fonts_rendered, histogram_parent_devtools_toolbox_time_active_seconds.key_value AS histogram_parent_devtools_toolbox_time_active_seconds, histogram_parent_dns_failed_lookup_time.key_value AS histogram_parent_dns_failed_lookup_time, histogram_parent_dns_lookup_time.key_value AS histogram_parent_dns_lookup_time, histogram_parent_fx_new_window_ms.key_value AS histogram_parent_fx_new_window_ms, histogram_parent_fx_page_load_ms_2.key_value AS histogram_parent_fx_page_load_ms_2, histogram_parent_fx_searchbar_selected_result_method.key_value AS histogram_parent_fx_searchbar_selected_result_method, histogram_parent_fx_session_restore_restore_window_ms.key_value AS histogram_parent_fx_session_restore_restore_window_ms, histogram_parent_fx_session_restore_startup_init_session_ms.key_value AS histogram_parent_fx_session_restore_startup_init_session_ms, histogram_parent_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_parent_fx_session_restore_startup_onload_initial_window_ms, histogram_parent_fx_tab_close_time_anim_ms.key_value AS histogram_parent_fx_tab_close_time_anim_ms, histogram_parent_fx_tab_switch_total_e10s_ms.key_value AS histogram_parent_fx_tab_switch_total_e10s_ms, histogram_parent_fx_tab_switch_update_ms.key_value AS histogram_parent_fx_tab_switch_update_ms, histogram_parent_fx_urlbar_selected_result_index.key_value AS histogram_parent_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_parent_fx_urlbar_selected_result_index_by_type, histogram_parent_fx_urlbar_selected_result_method.key_value AS histogram_parent_fx_urlbar_selected_result_method, histogram_parent_fx_urlbar_selected_result_type.key_value AS histogram_parent_fx_urlbar_selected_result_type, histogram_parent_gc_animation_ms.key_value AS histogram_parent_gc_animation_ms, histogram_parent_gc_max_pause_ms.key_value AS histogram_parent_gc_max_pause_ms, histogram_parent_gc_max_pause_ms_2.key_value AS histogram_parent_gc_max_pause_ms_2, histogram_parent_geolocation_request_granted.key_value AS histogram_parent_geolocation_request_granted, histogram_parent_ghost_windows.key_value AS histogram_parent_ghost_windows, histogram_parent_gpu_process_initialization_time_ms.key_value AS histogram_parent_gpu_process_initialization_time_ms, histogram_parent_gpu_process_launch_time_ms_2.key_value AS histogram_parent_gpu_process_launch_time_ms_2, histogram_parent_http_channel_disposition.key_value AS histogram_parent_http_channel_disposition, histogram_parent_http_pageload_is_ssl.key_value AS histogram_parent_http_pageload_is_ssl, histogram_parent_http_transaction_is_ssl.key_value AS histogram_parent_http_transaction_is_ssl, histogram_parent_input_event_response_coalesced_ms.key_value AS histogram_parent_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_parent_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_memory_distribution_among_content.key_value) AS _0 ) AS histogram_parent_memory_distribution_among_content, histogram_parent_memory_heap_allocated.key_value AS histogram_parent_memory_heap_allocated, histogram_parent_memory_resident_fast.key_value AS histogram_parent_memory_resident_fast, histogram_parent_memory_total.key_value AS histogram_parent_memory_total, histogram_parent_memory_unique.key_value AS histogram_parent_memory_unique, histogram_parent_memory_vsize.key_value AS histogram_parent_memory_vsize, histogram_parent_memory_vsize_max_contiguous.key_value AS histogram_parent_memory_vsize_max_contiguous, histogram_parent_network_cache_metadata_first_read_time_ms.key_value AS histogram_parent_network_cache_metadata_first_read_time_ms, histogram_parent_network_cache_v2_hit_time_ms.key_value AS histogram_parent_network_cache_v2_hit_time_ms, histogram_parent_network_cache_v2_miss_time_ms.key_value AS histogram_parent_network_cache_v2_miss_time_ms, histogram_parent_places_autocomplete_6_first_results_time_ms.key_value AS histogram_parent_places_autocomplete_6_first_results_time_ms, histogram_parent_plugin_shutdown_ms.key_value AS histogram_parent_plugin_shutdown_ms, histogram_parent_pwmgr_blocklist_num_sites.key_value AS histogram_parent_pwmgr_blocklist_num_sites, histogram_parent_pwmgr_form_autofill_result.key_value AS histogram_parent_pwmgr_form_autofill_result, histogram_parent_pwmgr_login_last_used_days.key_value AS histogram_parent_pwmgr_login_last_used_days, histogram_parent_pwmgr_login_page_safety.key_value AS histogram_parent_pwmgr_login_page_safety, histogram_parent_pwmgr_manage_opened.key_value AS histogram_parent_pwmgr_manage_opened, histogram_parent_pwmgr_manage_visibility_toggled.key_value AS histogram_parent_pwmgr_manage_visibility_toggled, histogram_parent_pwmgr_num_passwords_per_hostname.key_value AS histogram_parent_pwmgr_num_passwords_per_hostname, histogram_parent_pwmgr_num_saved_passwords.key_value AS histogram_parent_pwmgr_num_saved_passwords, histogram_parent_pwmgr_prompt_remember_action.key_value AS histogram_parent_pwmgr_prompt_remember_action, histogram_parent_pwmgr_prompt_update_action.key_value AS histogram_parent_pwmgr_prompt_update_action, histogram_parent_pwmgr_saving_enabled.key_value AS histogram_parent_pwmgr_saving_enabled, histogram_parent_sandbox_rejected_syscalls.key_value AS histogram_parent_sandbox_rejected_syscalls, histogram_parent_search_reset_result.key_value AS histogram_parent_search_reset_result, histogram_parent_search_service_init_ms.key_value AS histogram_parent_search_service_init_ms, histogram_parent_ssl_handshake_result.key_value AS histogram_parent_ssl_handshake_result, histogram_parent_ssl_handshake_version.key_value AS histogram_parent_ssl_handshake_version, histogram_parent_ssl_tls12_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls12_intolerance_reason_pre, histogram_parent_ssl_tls13_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls13_intolerance_reason_pre, histogram_parent_time_to_first_click_ms.key_value AS histogram_parent_time_to_first_click_ms, histogram_parent_time_to_first_interaction_ms.key_value AS histogram_parent_time_to_first_interaction_ms, histogram_parent_time_to_first_key_input_ms.key_value AS histogram_parent_time_to_first_key_input_ms, histogram_parent_time_to_first_mouse_move_ms.key_value AS histogram_parent_time_to_first_mouse_move_ms, histogram_parent_time_to_first_scroll_ms.key_value AS histogram_parent_time_to_first_scroll_ms, histogram_parent_time_to_non_blank_paint_ms.key_value AS histogram_parent_time_to_non_blank_paint_ms, histogram_parent_time_to_response_start_ms.key_value AS histogram_parent_time_to_response_start_ms, histogram_parent_touch_enabled_device.key_value AS histogram_parent_touch_enabled_device, histogram_parent_tracking_protection_enabled.key_value AS histogram_parent_tracking_protection_enabled, histogram_parent_update_bits_result_complete.key_value AS histogram_parent_update_bits_result_complete, histogram_parent_update_bits_result_partial.key_value AS histogram_parent_update_bits_result_partial, histogram_parent_update_can_use_bits_notify.key_value AS histogram_parent_update_can_use_bits_notify, histogram_parent_update_download_code_complete.key_value AS histogram_parent_update_download_code_complete, histogram_parent_update_download_code_partial.key_value AS histogram_parent_update_download_code_partial, histogram_parent_update_state_code_complete_stage.key_value AS histogram_parent_update_state_code_complete_stage, histogram_parent_update_state_code_complete_startup.key_value AS histogram_parent_update_state_code_complete_startup, histogram_parent_update_state_code_partial_stage.key_value AS histogram_parent_update_state_code_partial_stage, histogram_parent_update_state_code_partial_startup.key_value AS histogram_parent_update_state_code_partial_startup, histogram_parent_update_status_error_code_complete_stage.key_value AS histogram_parent_update_status_error_code_complete_stage, histogram_parent_update_status_error_code_complete_startup.key_value AS histogram_parent_update_status_error_code_complete_startup, histogram_parent_update_status_error_code_partial_stage.key_value AS histogram_parent_update_status_error_code_partial_stage, histogram_parent_update_status_error_code_partial_startup.key_value AS histogram_parent_update_status_error_code_partial_startup, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_parent_uptake_remote_content_result_1, histogram_parent_webext_background_page_load_ms.key_value AS histogram_parent_webext_background_page_load_ms, histogram_parent_webext_browseraction_popup_open_ms.key_value AS histogram_parent_webext_browseraction_popup_open_ms, histogram_parent_webext_browseraction_popup_preload_result_count.key_value AS histogram_parent_webext_browseraction_popup_preload_result_count, histogram_parent_webext_content_script_injection_ms.key_value AS histogram_parent_webext_content_script_injection_ms, histogram_parent_webext_extension_startup_ms.key_value AS histogram_parent_webext_extension_startup_ms, histogram_parent_webext_pageaction_popup_open_ms.key_value AS histogram_parent_webext_pageaction_popup_open_ms, histogram_parent_webext_storage_local_get_ms.key_value AS histogram_parent_webext_storage_local_get_ms, histogram_parent_webext_storage_local_set_ms.key_value AS histogram_parent_webext_storage_local_set_ms, histogram_parent_webvr_time_spent_viewing_in_2d.key_value AS histogram_parent_webvr_time_spent_viewing_in_2d, histogram_parent_webvr_time_spent_viewing_in_oculus.key_value AS histogram_parent_webvr_time_spent_viewing_in_oculus, histogram_parent_webvr_time_spent_viewing_in_openvr.key_value AS histogram_parent_webvr_time_spent_viewing_in_openvr, histogram_parent_webvr_users_view_in.key_value AS histogram_parent_webvr_users_view_in, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_boolean_addon_scalars.key_value) AS _0 ) AS keyed_boolean_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_string_addon_scalars.key_value) AS _0 ) AS keyed_string_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_uint_addon_scalars.key_value) AS _0 ) AS keyed_uint_addon_scalars, popup_notification_stats.key_value AS popup_notification_stats, scalar_content_dom_event_confluence_load_count.key_value AS scalar_content_dom_event_confluence_load_count, scalar_content_dom_event_office_online_load_count.key_value AS scalar_content_dom_event_office_online_load_count, scalar_content_gfx_small_paint_phase_weight.key_value AS scalar_content_gfx_small_paint_phase_weight, scalar_content_images_webp_content_frequency.key_value AS scalar_content_images_webp_content_frequency, scalar_content_pictureinpicture_opened_method.key_value AS scalar_content_pictureinpicture_opened_method, scalar_content_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_content_telemetry_accumulate_unknown_histogram_keys, scalar_content_telemetry_event_counts.key_value AS scalar_content_telemetry_event_counts, scalar_content_webrtc_sdp_parser_diff.key_value AS scalar_content_webrtc_sdp_parser_diff, scalar_content_webrtc_video_recv_codec_used.key_value AS scalar_content_webrtc_video_recv_codec_used, scalar_content_webrtc_video_send_codec_used.key_value AS scalar_content_webrtc_video_send_codec_used, scalar_gpu_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_gpu_telemetry_accumulate_unknown_histogram_keys, scalar_gpu_telemetry_event_counts.key_value AS scalar_gpu_telemetry_event_counts, scalar_parent_a11y_theme.key_value AS scalar_parent_a11y_theme, scalar_parent_browser_engagement_navigation_about_home.key_value AS scalar_parent_browser_engagement_navigation_about_home, scalar_parent_browser_engagement_navigation_about_newtab.key_value AS scalar_parent_browser_engagement_navigation_about_newtab, scalar_parent_browser_engagement_navigation_contextmenu.key_value AS scalar_parent_browser_engagement_navigation_contextmenu, scalar_parent_browser_engagement_navigation_searchbar.key_value AS scalar_parent_browser_engagement_navigation_searchbar, scalar_parent_browser_engagement_navigation_urlbar.key_value AS scalar_parent_browser_engagement_navigation_urlbar, scalar_parent_browser_engagement_navigation_webextension.key_value AS scalar_parent_browser_engagement_navigation_webextension, scalar_parent_browser_errors_collected_count_by_filename.key_value AS scalar_parent_browser_errors_collected_count_by_filename, scalar_parent_browser_search_ad_clicks.key_value AS scalar_parent_browser_search_ad_clicks, scalar_parent_browser_search_with_ads.key_value AS scalar_parent_browser_search_with_ads, scalar_parent_devtools_accessibility_accessible_context_menu_item_activated.key_value AS scalar_parent_devtools_accessibility_accessible_context_menu_item_activated, scalar_parent_devtools_accessibility_audit_activated.key_value AS scalar_parent_devtools_accessibility_audit_activated, scalar_parent_devtools_accessibility_select_accessible_for_node.key_value AS scalar_parent_devtools_accessibility_select_accessible_for_node, scalar_parent_devtools_current_theme.key_value AS scalar_parent_devtools_current_theme, scalar_parent_devtools_inspector_three_pane_enabled.key_value AS scalar_parent_devtools_inspector_three_pane_enabled, scalar_parent_devtools_responsive_open_trigger.key_value AS scalar_parent_devtools_responsive_open_trigger, scalar_parent_devtools_tool_registered.key_value AS scalar_parent_devtools_tool_registered, scalar_parent_devtools_toolbox_tabs_reordered.key_value AS scalar_parent_devtools_toolbox_tabs_reordered, scalar_parent_devtools_tooltip_shown.key_value AS scalar_parent_devtools_tooltip_shown, scalar_parent_extensions_updates_rdf.key_value AS scalar_parent_extensions_updates_rdf, scalar_parent_gfx_advanced_layers_failure_id.key_value AS scalar_parent_gfx_advanced_layers_failure_id, scalar_parent_images_webp_content_frequency.key_value AS scalar_parent_images_webp_content_frequency, scalar_parent_networking_data_transferred.key_value AS scalar_parent_networking_data_transferred, scalar_parent_networking_data_transferred_kb.key_value AS scalar_parent_networking_data_transferred_kb, scalar_parent_networking_data_transferred_v3_kb.key_value AS scalar_parent_networking_data_transferred_v3_kb, scalar_parent_normandy_recipe_freshness.key_value AS scalar_parent_normandy_recipe_freshness, scalar_parent_pictureinpicture_closed_method.key_value AS scalar_parent_pictureinpicture_closed_method, scalar_parent_preferences_browser_home_page_change.key_value AS scalar_parent_preferences_browser_home_page_change, scalar_parent_preferences_browser_home_page_count.key_value AS scalar_parent_preferences_browser_home_page_count, scalar_parent_preferences_search_query.key_value AS scalar_parent_preferences_search_query, scalar_parent_preferences_use_bookmark.key_value AS scalar_parent_preferences_use_bookmark, scalar_parent_preferences_use_current_page.key_value AS scalar_parent_preferences_use_current_page, scalar_parent_qm_origin_directory_unexpected_filename.key_value AS scalar_parent_qm_origin_directory_unexpected_filename, scalar_parent_resistfingerprinting_content_window_size.key_value AS scalar_parent_resistfingerprinting_content_window_size, scalar_parent_sandbox_no_job.key_value AS scalar_parent_sandbox_no_job, scalar_parent_security_client_cert.key_value AS scalar_parent_security_client_cert, scalar_parent_security_pkcs11_modules_loaded.key_value AS scalar_parent_security_pkcs11_modules_loaded, scalar_parent_security_webauthn_used.key_value AS scalar_parent_security_webauthn_used, scalar_parent_services_sync_sync_login_state_transitions.key_value AS scalar_parent_services_sync_sync_login_state_transitions, scalar_parent_storage_sync_api_usage_items_stored.key_value AS scalar_parent_storage_sync_api_usage_items_stored, scalar_parent_storage_sync_api_usage_storage_consumed.key_value AS scalar_parent_storage_sync_api_usage_storage_consumed, scalar_parent_telemetry_accumulate_clamped_values.key_value AS scalar_parent_telemetry_accumulate_clamped_values, scalar_parent_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_parent_telemetry_accumulate_unknown_histogram_keys, scalar_parent_telemetry_event_counts.key_value AS scalar_parent_telemetry_event_counts, scalar_parent_telemetry_keyed_scalars_exceed_limit.key_value AS scalar_parent_telemetry_keyed_scalars_exceed_limit, scalar_parent_update_binarytransparencyresult.key_value AS scalar_parent_update_binarytransparencyresult, scalar_parent_update_bitshresult.key_value AS scalar_parent_update_bitshresult, scalar_parent_widget_ime_name_on_linux.key_value AS scalar_parent_widget_ime_name_on_linux, scalar_parent_widget_ime_name_on_mac.key_value AS scalar_parent_widget_ime_name_on_mac, scalar_parent_widget_ime_name_on_windows.key_value AS scalar_parent_widget_ime_name_on_windows, ARRAY(SELECT * FROM UNNEST(search_counts.list)) AS search_counts, ssl_handshake_result.key_value AS ssl_handshake_result, string_addon_scalars.key_value AS string_addon_scalars, uint_addon_scalars.key_value AS uint_addon_scalars ) FROM `moz-fx-data-shared-prod.telemetry_derived.first_shutdown_summary_v4` telemetry_mobile_event_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet_v2` simpleprophet_forecasts View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.simpleprophet_forecasts` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.simpleprophet_forecasts_desktop_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.simpleprophet_forecasts_mobile_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.simpleprophet_forecasts_fxa_v1` eng_workflow_build_parquet View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_build_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.eng_workflow_build_parquet_v1` experiments_aggregates View CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.experiments_aggregates_v1`","title":"telemetry"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28_by_dimensions_v1","text":"","title":"firefox_nondesktop_exact_mau28_by_dimensions_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` AS SELECT raw.*, COALESCE(cc.name, raw.country) AS country_name FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_nondesktop_exact_mau28_v1` AS raw LEFT JOIN `moz-fx-data-shared-prod.static.country_codes_v1` cc ON (raw.country = cc.code)","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_error_aggregates","text":"","title":"experiment_error_aggregates"},{"location":"moz-fx-data-shared-prod/telemetry/#view_1","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_error_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_error_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#nondesktop_clients_last_seen","text":"","title":"nondesktop_clients_last_seen"},{"location":"moz-fx-data-shared-prod/telemetry/#view_2","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.nondesktop_clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.nondesktop_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_enrollment_daily_active_population","text":"","title":"experiment_enrollment_daily_active_population"},{"location":"moz-fx-data-shared-prod/telemetry/#view_3","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_daily_active_population` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_daily_active_population_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_probe_processes","text":"","title":"clients_probe_processes"},{"location":"moz-fx-data-shared-prod/telemetry/#view_4","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.client_probe_processes` AS SELECT metric, os, channel, ARRAY_AGG(DISTINCT(process)) AS processes, FROM `moz-fx-data-shared-prod.telemetry_derived.client_probe_counts_v1` GROUP BY metric, os, channel ORDER BY metric, os","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#addon_names","text":"","title":"addon_names"},{"location":"moz-fx-data-shared-prod/telemetry/#view_5","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addon_names` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.addon_names_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#addons_daily","text":"","title":"addons_daily"},{"location":"moz-fx-data-shared-prod/telemetry/#view_6","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addons_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.addons_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#lockwise_mobile_events","text":"","title":"lockwise_mobile_events"},{"location":"moz-fx-data-shared-prod/telemetry/#view_7","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.lockwise_mobile_events` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.lockwise_mobile_events_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28_v1","text":"","title":"firefox_nondesktop_exact_mau28_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_8","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_v1` AS SELECT submission_date, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), mau, 0)) AS tier1_mau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), wau, 0)) AS tier1_wau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), dau, 0)) AS tier1_dau FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` GROUP BY submission_date","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#crash_aggregates_v1","text":"","title":"crash_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_9","text":"-- Query generated by: templates/unnest_parquet_view.sql.py crash_aggregates_v1 telemetry_derived.crash_aggregates_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_aggregates_v1` AS SELECT * REPLACE (dimensions.key_value AS dimensions, stats.key_value AS stats) FROM `moz-fx-data-shared-prod.telemetry_derived.crash_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_first_seen","text":"","title":"clients_first_seen"},{"location":"moz-fx-data-shared-prod/telemetry/#metadata","text":"Friendly name : Clients first seen Description : Identical in schema to clients_daily except that each client appears only once over all time; includes fields first_seen_date and second_seen_date for determining user \"activation\" Owners : jklukas@mozilla.com","title":"Metadata"},{"location":"moz-fx-data-shared-prod/telemetry/#view_10","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_first_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_first_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_ip_privacy_parquet","text":"","title":"telemetry_ip_privacy_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_11","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_ip_privacy_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_ip_privacy_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_downgrade_parquet","text":"","title":"telemetry_downgrade_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_12","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_downgrade_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_downgrade_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28","text":"","title":"firefox_nondesktop_exact_mau28"},{"location":"moz-fx-data-shared-prod/telemetry/#view_13","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28_by_client_count_dimensions","text":"","title":"firefox_nondesktop_exact_mau28_by_client_count_dimensions"},{"location":"moz-fx-data-shared-prod/telemetry/#view_14","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_client_count_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_nondesktop_exact_mau28_by_client_count_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_histogram_aggregates_v1","text":"","title":"clients_histogram_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_15","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_histogram_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_histogram_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_ip_privacy","text":"","title":"telemetry_ip_privacy"},{"location":"moz-fx-data-shared-prod/telemetry/#view_16","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_ip_privacy` AS SELECT DATE(submission_timestamp) AS submission_date, * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_ip_privacy_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#core","text":"","title":"core"},{"location":"moz-fx-data-shared-prod/telemetry/#view_17","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core` AS WITH unioned AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v3` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v4` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v5` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v6` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v7` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v8` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v9` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_stable.core_v10` ) -- SELECT * REPLACE ( -- The pipeline ensures lowercase client_id since 2020-01-10, but we apply -- LOWER here to provide continuity for older data that still contains -- some uppercase IDs; see https://github.com/mozilla/gcp-ingestion/pull/1069 LOWER(client_id) AS client_id, `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata ) FROM unioned","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28_by_dimensions","text":"","title":"firefox_nondesktop_exact_mau28_by_dimensions"},{"location":"moz-fx-data-shared-prod/telemetry/#view_18","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#crash_summary","text":"","title":"crash_summary"},{"location":"moz-fx-data-shared-prod/telemetry/#view_19","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_summary` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.crash_summary_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#smoot_usage_day_0","text":"","title":"smoot_usage_day_0"},{"location":"moz-fx-data-shared-prod/telemetry/#view_20","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.smoot_usage_day_0` AS WITH unioned AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_desktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_nondesktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_fxa_v2` ) -- SELECT submission_date AS `date`, usage, metrics.day_0.*, * EXCEPT (submission_date, usage, metrics) FROM unioned UNION ALL SELECT DATE_SUB(submission_date, INTERVAL 6 DAY) AS `date`, usage, new_profiles AS dau, NULL AS wau, NULL AS mau, NULL AS active_days_in_week, * EXCEPT (submission_date, usage, new_profiles) FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_new_profiles_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#crash_aggregates","text":"","title":"crash_aggregates"},{"location":"moz-fx-data-shared-prod/telemetry/#view_21","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.crash_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#focus_event","text":"","title":"focus_event"},{"location":"moz-fx-data-shared-prod/telemetry/#view_22","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.focus_event` AS SELECT * REPLACE ( -- The pipeline ensures lowercase client_id since 2020-01-10, but we apply -- LOWER here to provide continuity for older data that still contains -- some uppercase IDs; see https://github.com/mozilla/gcp-ingestion/pull/1069 LOWER(client_id) AS client_id, `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata ) FROM `moz-fx-data-shared-prod.telemetry_stable.focus_event_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_cumulative_search_with_ads_count","text":"","title":"experiment_cumulative_search_with_ads_count"},{"location":"moz-fx-data-shared-prod/telemetry/#view_23","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_cumulative_search_with_ads_count` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_cumulative_search_with_ads_count_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_daily_scalar_aggregates_v1","text":"","title":"clients_daily_scalar_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_24","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily_scalar_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_daily_scalar_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_search_aggregates_hourly","text":"","title":"experiment_search_aggregates_hourly"},{"location":"moz-fx-data-shared-prod/telemetry/#view_25","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_search_aggregates_hourly` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_search_aggregates_hourly_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_shield_study_parquet","text":"","title":"telemetry_shield_study_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_26","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_shield_study_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_shield_study_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiments_v1","text":"","title":"experiments_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_27","text":"-- Query generated by: templates/unnest_parquet_view.sql.py experiments_v1 telemetry_derived.experiments_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments_v1` AS SELECT submission_date AS submission_date_s3, * REPLACE ( ARRAY(SELECT * FROM UNNEST(active_addons.list)) AS active_addons, ARRAY(SELECT * FROM UNNEST(antispyware.list)) AS antispyware, ARRAY(SELECT * FROM UNNEST(antivirus.list)) AS antivirus, boolean_addon_scalars.key_value AS boolean_addon_scalars, ARRAY(SELECT * FROM UNNEST(disabled_addons_ids.list)) AS disabled_addons_ids, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_accept_languages.list) ) AS environment_settings_intl_accept_languages, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_app_locales.list) ) AS environment_settings_intl_app_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_available_locales.list) ) AS environment_settings_intl_available_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_regional_prefs_locales.list) ) AS environment_settings_intl_regional_prefs_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_requested_locales.list) ) AS environment_settings_intl_requested_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_system_locales.list) ) AS environment_settings_intl_system_locales, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (_0.element.map_values.key_value AS map_values) FROM UNNEST(events.list) AS _0 ) AS events, experiments.key_value AS experiments, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(experiments_details.key_value) AS _0 ) AS experiments_details, ARRAY(SELECT * FROM UNNEST(firewall.list)) AS firewall, histogram_content_cert_validation_success_by_ca.key_value AS histogram_content_cert_validation_success_by_ca, histogram_content_checkerboard_severity.key_value AS histogram_content_checkerboard_severity, histogram_content_composite_time.key_value AS histogram_content_composite_time, histogram_content_content_paint_time.key_value AS histogram_content_content_paint_time, histogram_content_cycle_collector_max_pause.key_value AS histogram_content_cycle_collector_max_pause, histogram_content_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_content_devtools_accessibility_picker_time_active_seconds, histogram_content_devtools_accessibility_service_time_active_seconds.key_value AS histogram_content_devtools_accessibility_service_time_active_seconds, histogram_content_devtools_accessibility_time_active_seconds.key_value AS histogram_content_devtools_accessibility_time_active_seconds, histogram_content_devtools_toolbox_time_active_seconds.key_value AS histogram_content_devtools_toolbox_time_active_seconds, histogram_content_fx_new_window_ms.key_value AS histogram_content_fx_new_window_ms, histogram_content_fx_page_load_ms_2.key_value AS histogram_content_fx_page_load_ms_2, histogram_content_fx_searchbar_selected_result_method.key_value AS histogram_content_fx_searchbar_selected_result_method, histogram_content_fx_session_restore_restore_window_ms.key_value AS histogram_content_fx_session_restore_restore_window_ms, histogram_content_fx_session_restore_startup_init_session_ms.key_value AS histogram_content_fx_session_restore_startup_init_session_ms, histogram_content_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_content_fx_session_restore_startup_onload_initial_window_ms, histogram_content_fx_tab_close_time_anim_ms.key_value AS histogram_content_fx_tab_close_time_anim_ms, histogram_content_fx_tab_switch_update_ms.key_value AS histogram_content_fx_tab_switch_update_ms, histogram_content_fx_urlbar_selected_result_index.key_value AS histogram_content_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_content_fx_urlbar_selected_result_index_by_type, histogram_content_fx_urlbar_selected_result_method.key_value AS histogram_content_fx_urlbar_selected_result_method, histogram_content_fx_urlbar_selected_result_type.key_value AS histogram_content_fx_urlbar_selected_result_type, histogram_content_gc_animation_ms.key_value AS histogram_content_gc_animation_ms, histogram_content_gc_max_pause_ms.key_value AS histogram_content_gc_max_pause_ms, histogram_content_gc_max_pause_ms_2.key_value AS histogram_content_gc_max_pause_ms_2, histogram_content_geolocation_request_granted.key_value AS histogram_content_geolocation_request_granted, histogram_content_ghost_windows.key_value AS histogram_content_ghost_windows, histogram_content_gpu_process_initialization_time_ms.key_value AS histogram_content_gpu_process_initialization_time_ms, histogram_content_gpu_process_launch_time_ms_2.key_value AS histogram_content_gpu_process_launch_time_ms_2, histogram_content_http_channel_disposition.key_value AS histogram_content_http_channel_disposition, histogram_content_http_pageload_is_ssl.key_value AS histogram_content_http_pageload_is_ssl, histogram_content_http_transaction_is_ssl.key_value AS histogram_content_http_transaction_is_ssl, histogram_content_input_event_response_coalesced_ms.key_value AS histogram_content_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_content_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_memory_distribution_among_content.key_value) AS _0 ) AS histogram_content_memory_distribution_among_content, histogram_content_memory_heap_allocated.key_value AS histogram_content_memory_heap_allocated, histogram_content_memory_resident_fast.key_value AS histogram_content_memory_resident_fast, histogram_content_memory_total.key_value AS histogram_content_memory_total, histogram_content_memory_unique.key_value AS histogram_content_memory_unique, histogram_content_memory_unique_content_startup.key_value AS histogram_content_memory_unique_content_startup, histogram_content_memory_vsize.key_value AS histogram_content_memory_vsize, histogram_content_memory_vsize_max_contiguous.key_value AS histogram_content_memory_vsize_max_contiguous, histogram_content_network_cache_metadata_first_read_time_ms.key_value AS histogram_content_network_cache_metadata_first_read_time_ms, histogram_content_network_cache_v2_hit_time_ms.key_value AS histogram_content_network_cache_v2_hit_time_ms, histogram_content_network_cache_v2_miss_time_ms.key_value AS histogram_content_network_cache_v2_miss_time_ms, histogram_content_places_autocomplete_6_first_results_time_ms.key_value AS histogram_content_places_autocomplete_6_first_results_time_ms, histogram_content_plugin_shutdown_ms.key_value AS histogram_content_plugin_shutdown_ms, histogram_content_pwmgr_form_autofill_result.key_value AS histogram_content_pwmgr_form_autofill_result, histogram_content_pwmgr_login_page_safety.key_value AS histogram_content_pwmgr_login_page_safety, histogram_content_sandbox_rejected_syscalls.key_value AS histogram_content_sandbox_rejected_syscalls, histogram_content_search_reset_result.key_value AS histogram_content_search_reset_result, histogram_content_search_service_init_ms.key_value AS histogram_content_search_service_init_ms, histogram_content_ssl_handshake_result.key_value AS histogram_content_ssl_handshake_result, histogram_content_ssl_handshake_version.key_value AS histogram_content_ssl_handshake_version, histogram_content_ssl_tls12_intolerance_reason_pre.key_value AS histogram_content_ssl_tls12_intolerance_reason_pre, histogram_content_ssl_tls13_intolerance_reason_pre.key_value AS histogram_content_ssl_tls13_intolerance_reason_pre, histogram_content_time_to_dom_complete_ms.key_value AS histogram_content_time_to_dom_complete_ms, histogram_content_time_to_dom_content_loaded_end_ms.key_value AS histogram_content_time_to_dom_content_loaded_end_ms, histogram_content_time_to_dom_content_loaded_start_ms.key_value AS histogram_content_time_to_dom_content_loaded_start_ms, histogram_content_time_to_dom_interactive_ms.key_value AS histogram_content_time_to_dom_interactive_ms, histogram_content_time_to_dom_loading_ms.key_value AS histogram_content_time_to_dom_loading_ms, histogram_content_time_to_first_click_ms.key_value AS histogram_content_time_to_first_click_ms, histogram_content_time_to_first_interaction_ms.key_value AS histogram_content_time_to_first_interaction_ms, histogram_content_time_to_first_key_input_ms.key_value AS histogram_content_time_to_first_key_input_ms, histogram_content_time_to_first_mouse_move_ms.key_value AS histogram_content_time_to_first_mouse_move_ms, histogram_content_time_to_first_scroll_ms.key_value AS histogram_content_time_to_first_scroll_ms, histogram_content_time_to_load_event_end_ms.key_value AS histogram_content_time_to_load_event_end_ms, histogram_content_time_to_load_event_start_ms.key_value AS histogram_content_time_to_load_event_start_ms, histogram_content_time_to_non_blank_paint_ms.key_value AS histogram_content_time_to_non_blank_paint_ms, histogram_content_time_to_response_start_ms.key_value AS histogram_content_time_to_response_start_ms, histogram_content_tracking_protection_enabled.key_value AS histogram_content_tracking_protection_enabled, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_content_uptake_remote_content_result_1, histogram_content_webext_content_script_injection_ms.key_value AS histogram_content_webext_content_script_injection_ms, histogram_content_webext_storage_local_get_ms.key_value AS histogram_content_webext_storage_local_get_ms, histogram_content_webext_storage_local_set_ms.key_value AS histogram_content_webext_storage_local_set_ms, histogram_content_webvr_time_spent_viewing_in_2d.key_value AS histogram_content_webvr_time_spent_viewing_in_2d, histogram_content_webvr_users_view_in.key_value AS histogram_content_webvr_users_view_in, histogram_gpu_checkerboard_severity.key_value AS histogram_gpu_checkerboard_severity, histogram_gpu_composite_time.key_value AS histogram_gpu_composite_time, histogram_gpu_content_frame_time.key_value AS histogram_gpu_content_frame_time, histogram_gpu_gpu_process_initialization_time_ms.key_value AS histogram_gpu_gpu_process_initialization_time_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_gpu_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_gpu_uptake_remote_content_result_1, histogram_gpu_webvr_time_spent_viewing_in_oculus.key_value AS histogram_gpu_webvr_time_spent_viewing_in_oculus, histogram_gpu_webvr_time_spent_viewing_in_openvr.key_value AS histogram_gpu_webvr_time_spent_viewing_in_openvr, histogram_gpu_webvr_users_view_in.key_value AS histogram_gpu_webvr_users_view_in, histogram_parent_a11y_consumers.key_value AS histogram_parent_a11y_consumers, histogram_parent_a11y_instantiated_flag.key_value AS histogram_parent_a11y_instantiated_flag, histogram_parent_cert_validation_success_by_ca.key_value AS histogram_parent_cert_validation_success_by_ca, histogram_parent_checkerboard_severity.key_value AS histogram_parent_checkerboard_severity, histogram_parent_composite_time.key_value AS histogram_parent_composite_time, histogram_parent_content_frame_time.key_value AS histogram_parent_content_frame_time, histogram_parent_content_paint_time.key_value AS histogram_parent_content_paint_time, histogram_parent_cookie_behavior.key_value AS histogram_parent_cookie_behavior, histogram_parent_cycle_collector_max_pause.key_value AS histogram_parent_cycle_collector_max_pause, histogram_parent_devtools_about_devtools_opened_key.key_value AS histogram_parent_devtools_about_devtools_opened_key, histogram_parent_devtools_about_devtools_opened_reason.key_value AS histogram_parent_devtools_about_devtools_opened_reason, histogram_parent_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_picker_time_active_seconds, histogram_parent_devtools_accessibility_service_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_service_time_active_seconds, histogram_parent_devtools_accessibility_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_time_active_seconds, histogram_parent_devtools_entry_point.key_value AS histogram_parent_devtools_entry_point, histogram_parent_devtools_fonteditor_font_type_displayed.key_value AS histogram_parent_devtools_fonteditor_font_type_displayed, histogram_parent_devtools_fonteditor_n_font_axes.key_value AS histogram_parent_devtools_fonteditor_n_font_axes, histogram_parent_devtools_fonteditor_n_fonts_rendered.key_value AS histogram_parent_devtools_fonteditor_n_fonts_rendered, histogram_parent_devtools_toolbox_time_active_seconds.key_value AS histogram_parent_devtools_toolbox_time_active_seconds, histogram_parent_dns_failed_lookup_time.key_value AS histogram_parent_dns_failed_lookup_time, histogram_parent_dns_lookup_time.key_value AS histogram_parent_dns_lookup_time, histogram_parent_fx_new_window_ms.key_value AS histogram_parent_fx_new_window_ms, histogram_parent_fx_page_load_ms_2.key_value AS histogram_parent_fx_page_load_ms_2, histogram_parent_fx_searchbar_selected_result_method.key_value AS histogram_parent_fx_searchbar_selected_result_method, histogram_parent_fx_session_restore_restore_window_ms.key_value AS histogram_parent_fx_session_restore_restore_window_ms, histogram_parent_fx_session_restore_startup_init_session_ms.key_value AS histogram_parent_fx_session_restore_startup_init_session_ms, histogram_parent_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_parent_fx_session_restore_startup_onload_initial_window_ms, histogram_parent_fx_tab_close_time_anim_ms.key_value AS histogram_parent_fx_tab_close_time_anim_ms, histogram_parent_fx_tab_switch_total_e10s_ms.key_value AS histogram_parent_fx_tab_switch_total_e10s_ms, histogram_parent_fx_tab_switch_update_ms.key_value AS histogram_parent_fx_tab_switch_update_ms, histogram_parent_fx_urlbar_selected_result_index.key_value AS histogram_parent_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_parent_fx_urlbar_selected_result_index_by_type, histogram_parent_fx_urlbar_selected_result_method.key_value AS histogram_parent_fx_urlbar_selected_result_method, histogram_parent_fx_urlbar_selected_result_type.key_value AS histogram_parent_fx_urlbar_selected_result_type, histogram_parent_gc_animation_ms.key_value AS histogram_parent_gc_animation_ms, histogram_parent_gc_max_pause_ms.key_value AS histogram_parent_gc_max_pause_ms, histogram_parent_gc_max_pause_ms_2.key_value AS histogram_parent_gc_max_pause_ms_2, histogram_parent_geolocation_request_granted.key_value AS histogram_parent_geolocation_request_granted, histogram_parent_ghost_windows.key_value AS histogram_parent_ghost_windows, histogram_parent_gpu_process_initialization_time_ms.key_value AS histogram_parent_gpu_process_initialization_time_ms, histogram_parent_gpu_process_launch_time_ms_2.key_value AS histogram_parent_gpu_process_launch_time_ms_2, histogram_parent_http_channel_disposition.key_value AS histogram_parent_http_channel_disposition, histogram_parent_http_pageload_is_ssl.key_value AS histogram_parent_http_pageload_is_ssl, histogram_parent_http_transaction_is_ssl.key_value AS histogram_parent_http_transaction_is_ssl, histogram_parent_input_event_response_coalesced_ms.key_value AS histogram_parent_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_parent_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_memory_distribution_among_content.key_value) AS _0 ) AS histogram_parent_memory_distribution_among_content, histogram_parent_memory_heap_allocated.key_value AS histogram_parent_memory_heap_allocated, histogram_parent_memory_resident_fast.key_value AS histogram_parent_memory_resident_fast, histogram_parent_memory_total.key_value AS histogram_parent_memory_total, histogram_parent_memory_unique.key_value AS histogram_parent_memory_unique, histogram_parent_memory_vsize.key_value AS histogram_parent_memory_vsize, histogram_parent_memory_vsize_max_contiguous.key_value AS histogram_parent_memory_vsize_max_contiguous, histogram_parent_network_cache_metadata_first_read_time_ms.key_value AS histogram_parent_network_cache_metadata_first_read_time_ms, histogram_parent_network_cache_v2_hit_time_ms.key_value AS histogram_parent_network_cache_v2_hit_time_ms, histogram_parent_network_cache_v2_miss_time_ms.key_value AS histogram_parent_network_cache_v2_miss_time_ms, histogram_parent_places_autocomplete_6_first_results_time_ms.key_value AS histogram_parent_places_autocomplete_6_first_results_time_ms, histogram_parent_plugin_shutdown_ms.key_value AS histogram_parent_plugin_shutdown_ms, histogram_parent_pwmgr_blocklist_num_sites.key_value AS histogram_parent_pwmgr_blocklist_num_sites, histogram_parent_pwmgr_form_autofill_result.key_value AS histogram_parent_pwmgr_form_autofill_result, histogram_parent_pwmgr_login_last_used_days.key_value AS histogram_parent_pwmgr_login_last_used_days, histogram_parent_pwmgr_login_page_safety.key_value AS histogram_parent_pwmgr_login_page_safety, histogram_parent_pwmgr_manage_opened.key_value AS histogram_parent_pwmgr_manage_opened, histogram_parent_pwmgr_manage_visibility_toggled.key_value AS histogram_parent_pwmgr_manage_visibility_toggled, histogram_parent_pwmgr_num_passwords_per_hostname.key_value AS histogram_parent_pwmgr_num_passwords_per_hostname, histogram_parent_pwmgr_num_saved_passwords.key_value AS histogram_parent_pwmgr_num_saved_passwords, histogram_parent_pwmgr_prompt_remember_action.key_value AS histogram_parent_pwmgr_prompt_remember_action, histogram_parent_pwmgr_prompt_update_action.key_value AS histogram_parent_pwmgr_prompt_update_action, histogram_parent_pwmgr_saving_enabled.key_value AS histogram_parent_pwmgr_saving_enabled, histogram_parent_sandbox_rejected_syscalls.key_value AS histogram_parent_sandbox_rejected_syscalls, histogram_parent_search_reset_result.key_value AS histogram_parent_search_reset_result, histogram_parent_search_service_init_ms.key_value AS histogram_parent_search_service_init_ms, histogram_parent_ssl_handshake_result.key_value AS histogram_parent_ssl_handshake_result, histogram_parent_ssl_handshake_version.key_value AS histogram_parent_ssl_handshake_version, histogram_parent_ssl_tls12_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls12_intolerance_reason_pre, histogram_parent_ssl_tls13_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls13_intolerance_reason_pre, histogram_parent_time_to_first_click_ms.key_value AS histogram_parent_time_to_first_click_ms, histogram_parent_time_to_first_interaction_ms.key_value AS histogram_parent_time_to_first_interaction_ms, histogram_parent_time_to_first_key_input_ms.key_value AS histogram_parent_time_to_first_key_input_ms, histogram_parent_time_to_first_mouse_move_ms.key_value AS histogram_parent_time_to_first_mouse_move_ms, histogram_parent_time_to_first_scroll_ms.key_value AS histogram_parent_time_to_first_scroll_ms, histogram_parent_time_to_non_blank_paint_ms.key_value AS histogram_parent_time_to_non_blank_paint_ms, histogram_parent_time_to_response_start_ms.key_value AS histogram_parent_time_to_response_start_ms, histogram_parent_touch_enabled_device.key_value AS histogram_parent_touch_enabled_device, histogram_parent_tracking_protection_enabled.key_value AS histogram_parent_tracking_protection_enabled, histogram_parent_update_bits_result_complete.key_value AS histogram_parent_update_bits_result_complete, histogram_parent_update_bits_result_partial.key_value AS histogram_parent_update_bits_result_partial, histogram_parent_update_can_use_bits_notify.key_value AS histogram_parent_update_can_use_bits_notify, histogram_parent_update_download_code_complete.key_value AS histogram_parent_update_download_code_complete, histogram_parent_update_download_code_partial.key_value AS histogram_parent_update_download_code_partial, histogram_parent_update_state_code_complete_stage.key_value AS histogram_parent_update_state_code_complete_stage, histogram_parent_update_state_code_complete_startup.key_value AS histogram_parent_update_state_code_complete_startup, histogram_parent_update_state_code_partial_stage.key_value AS histogram_parent_update_state_code_partial_stage, histogram_parent_update_state_code_partial_startup.key_value AS histogram_parent_update_state_code_partial_startup, histogram_parent_update_status_error_code_complete_stage.key_value AS histogram_parent_update_status_error_code_complete_stage, histogram_parent_update_status_error_code_complete_startup.key_value AS histogram_parent_update_status_error_code_complete_startup, histogram_parent_update_status_error_code_partial_stage.key_value AS histogram_parent_update_status_error_code_partial_stage, histogram_parent_update_status_error_code_partial_startup.key_value AS histogram_parent_update_status_error_code_partial_startup, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_parent_uptake_remote_content_result_1, histogram_parent_webext_background_page_load_ms.key_value AS histogram_parent_webext_background_page_load_ms, histogram_parent_webext_browseraction_popup_open_ms.key_value AS histogram_parent_webext_browseraction_popup_open_ms, histogram_parent_webext_browseraction_popup_preload_result_count.key_value AS histogram_parent_webext_browseraction_popup_preload_result_count, histogram_parent_webext_content_script_injection_ms.key_value AS histogram_parent_webext_content_script_injection_ms, histogram_parent_webext_extension_startup_ms.key_value AS histogram_parent_webext_extension_startup_ms, histogram_parent_webext_pageaction_popup_open_ms.key_value AS histogram_parent_webext_pageaction_popup_open_ms, histogram_parent_webext_storage_local_get_ms.key_value AS histogram_parent_webext_storage_local_get_ms, histogram_parent_webext_storage_local_set_ms.key_value AS histogram_parent_webext_storage_local_set_ms, histogram_parent_webvr_time_spent_viewing_in_2d.key_value AS histogram_parent_webvr_time_spent_viewing_in_2d, histogram_parent_webvr_time_spent_viewing_in_oculus.key_value AS histogram_parent_webvr_time_spent_viewing_in_oculus, histogram_parent_webvr_time_spent_viewing_in_openvr.key_value AS histogram_parent_webvr_time_spent_viewing_in_openvr, histogram_parent_webvr_users_view_in.key_value AS histogram_parent_webvr_users_view_in, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_boolean_addon_scalars.key_value) AS _0 ) AS keyed_boolean_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_string_addon_scalars.key_value) AS _0 ) AS keyed_string_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_uint_addon_scalars.key_value) AS _0 ) AS keyed_uint_addon_scalars, popup_notification_stats.key_value AS popup_notification_stats, scalar_content_dom_event_confluence_load_count.key_value AS scalar_content_dom_event_confluence_load_count, scalar_content_dom_event_office_online_load_count.key_value AS scalar_content_dom_event_office_online_load_count, scalar_content_gfx_small_paint_phase_weight.key_value AS scalar_content_gfx_small_paint_phase_weight, scalar_content_images_webp_content_frequency.key_value AS scalar_content_images_webp_content_frequency, scalar_content_pictureinpicture_opened_method.key_value AS scalar_content_pictureinpicture_opened_method, scalar_content_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_content_telemetry_accumulate_unknown_histogram_keys, scalar_content_telemetry_event_counts.key_value AS scalar_content_telemetry_event_counts, scalar_content_webrtc_sdp_parser_diff.key_value AS scalar_content_webrtc_sdp_parser_diff, scalar_content_webrtc_video_recv_codec_used.key_value AS scalar_content_webrtc_video_recv_codec_used, scalar_content_webrtc_video_send_codec_used.key_value AS scalar_content_webrtc_video_send_codec_used, scalar_gpu_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_gpu_telemetry_accumulate_unknown_histogram_keys, scalar_gpu_telemetry_event_counts.key_value AS scalar_gpu_telemetry_event_counts, scalar_parent_a11y_theme.key_value AS scalar_parent_a11y_theme, scalar_parent_browser_engagement_navigation_about_home.key_value AS scalar_parent_browser_engagement_navigation_about_home, scalar_parent_browser_engagement_navigation_about_newtab.key_value AS scalar_parent_browser_engagement_navigation_about_newtab, scalar_parent_browser_engagement_navigation_contextmenu.key_value AS scalar_parent_browser_engagement_navigation_contextmenu, scalar_parent_browser_engagement_navigation_searchbar.key_value AS scalar_parent_browser_engagement_navigation_searchbar, scalar_parent_browser_engagement_navigation_urlbar.key_value AS scalar_parent_browser_engagement_navigation_urlbar, scalar_parent_browser_engagement_navigation_webextension.key_value AS scalar_parent_browser_engagement_navigation_webextension, scalar_parent_browser_errors_collected_count_by_filename.key_value AS scalar_parent_browser_errors_collected_count_by_filename, scalar_parent_browser_search_ad_clicks.key_value AS scalar_parent_browser_search_ad_clicks, scalar_parent_browser_search_with_ads.key_value AS scalar_parent_browser_search_with_ads, scalar_parent_devtools_accessibility_accessible_context_menu_item_activated.key_value AS scalar_parent_devtools_accessibility_accessible_context_menu_item_activated, scalar_parent_devtools_accessibility_audit_activated.key_value AS scalar_parent_devtools_accessibility_audit_activated, scalar_parent_devtools_accessibility_select_accessible_for_node.key_value AS scalar_parent_devtools_accessibility_select_accessible_for_node, scalar_parent_devtools_accessibility_simulation_activated.key_value AS scalar_parent_devtools_accessibility_simulation_activated, scalar_parent_devtools_current_theme.key_value AS scalar_parent_devtools_current_theme, scalar_parent_devtools_inspector_three_pane_enabled.key_value AS scalar_parent_devtools_inspector_three_pane_enabled, scalar_parent_devtools_responsive_open_trigger.key_value AS scalar_parent_devtools_responsive_open_trigger, scalar_parent_devtools_tool_registered.key_value AS scalar_parent_devtools_tool_registered, scalar_parent_devtools_toolbox_tabs_reordered.key_value AS scalar_parent_devtools_toolbox_tabs_reordered, scalar_parent_devtools_tooltip_shown.key_value AS scalar_parent_devtools_tooltip_shown, scalar_parent_extensions_updates_rdf.key_value AS scalar_parent_extensions_updates_rdf, scalar_parent_gfx_advanced_layers_failure_id.key_value AS scalar_parent_gfx_advanced_layers_failure_id, scalar_parent_images_webp_content_frequency.key_value AS scalar_parent_images_webp_content_frequency, scalar_parent_networking_data_transferred.key_value AS scalar_parent_networking_data_transferred, scalar_parent_networking_data_transferred_kb.key_value AS scalar_parent_networking_data_transferred_kb, scalar_parent_networking_data_transferred_v3_kb.key_value AS scalar_parent_networking_data_transferred_v3_kb, scalar_parent_normandy_recipe_freshness.key_value AS scalar_parent_normandy_recipe_freshness, scalar_parent_pictureinpicture_closed_method.key_value AS scalar_parent_pictureinpicture_closed_method, scalar_parent_preferences_browser_home_page_change.key_value AS scalar_parent_preferences_browser_home_page_change, scalar_parent_preferences_browser_home_page_count.key_value AS scalar_parent_preferences_browser_home_page_count, scalar_parent_preferences_search_query.key_value AS scalar_parent_preferences_search_query, scalar_parent_preferences_use_bookmark.key_value AS scalar_parent_preferences_use_bookmark, scalar_parent_preferences_use_current_page.key_value AS scalar_parent_preferences_use_current_page, scalar_parent_qm_origin_directory_unexpected_filename.key_value AS scalar_parent_qm_origin_directory_unexpected_filename, scalar_parent_resistfingerprinting_content_window_size.key_value AS scalar_parent_resistfingerprinting_content_window_size, scalar_parent_sandbox_no_job.key_value AS scalar_parent_sandbox_no_job, scalar_parent_security_client_cert.key_value AS scalar_parent_security_client_cert, scalar_parent_security_contentblocker_permissions.key_value AS scalar_parent_security_contentblocker_permissions, scalar_parent_security_pkcs11_modules_loaded.key_value AS scalar_parent_security_pkcs11_modules_loaded, scalar_parent_security_webauthn_used.key_value AS scalar_parent_security_webauthn_used, scalar_parent_services_sync_sync_login_state_transitions.key_value AS scalar_parent_services_sync_sync_login_state_transitions, scalar_parent_storage_sync_api_usage_items_stored.key_value AS scalar_parent_storage_sync_api_usage_items_stored, scalar_parent_storage_sync_api_usage_storage_consumed.key_value AS scalar_parent_storage_sync_api_usage_storage_consumed, scalar_parent_telemetry_accumulate_clamped_values.key_value AS scalar_parent_telemetry_accumulate_clamped_values, scalar_parent_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_parent_telemetry_accumulate_unknown_histogram_keys, scalar_parent_telemetry_event_counts.key_value AS scalar_parent_telemetry_event_counts, scalar_parent_telemetry_keyed_scalars_exceed_limit.key_value AS scalar_parent_telemetry_keyed_scalars_exceed_limit, scalar_parent_update_binarytransparencyresult.key_value AS scalar_parent_update_binarytransparencyresult, scalar_parent_update_bitshresult.key_value AS scalar_parent_update_bitshresult, scalar_parent_widget_ime_name_on_linux.key_value AS scalar_parent_widget_ime_name_on_linux, scalar_parent_widget_ime_name_on_mac.key_value AS scalar_parent_widget_ime_name_on_mac, scalar_parent_widget_ime_name_on_windows.key_value AS scalar_parent_widget_ime_name_on_windows, ARRAY(SELECT * FROM UNNEST(search_counts.list)) AS search_counts, ssl_handshake_result.key_value AS ssl_handshake_result, string_addon_scalars.key_value AS string_addon_scalars, uint_addon_scalars.key_value AS uint_addon_scalars ), CAST(NULL AS STRING) AS experiment_enrollment_id FROM -- This table was called experiments_v1 in the moz-fx-data-derived-datasets -- project, but we renamed to v0 when copying to shared-prod so that we -- could maintain this query that unions the old and new structures. `moz-fx-data-shared-prod.telemetry_derived.experiments_v0` WHERE submission_date < '2019-12-04' UNION ALL SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.experiments_v1` WHERE submission_date >= '2019-12-04'","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#addon_aggregates","text":"","title":"addon_aggregates"},{"location":"moz-fx-data-shared-prod/telemetry/#view_28","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addon_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.addon_aggregates_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_accounts_exact_mau28_v1","text":"","title":"firefox_accounts_exact_mau28_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_29","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_v1` AS SELECT submission_date, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, SUM(seen_in_tier1_country_mau) AS tier1_mau FROM `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions_v1` GROUP BY submission_date","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#fenix_clients_last_seen","text":"","title":"fenix_clients_last_seen"},{"location":"moz-fx-data-shared-prod/telemetry/#view_30","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.fenix_clients_last_seen` AS -- For context on naming and channels of Fenix apps, see: -- https://docs.google.com/document/d/1Ym4eZyS0WngEP6WdwJjmCoxtoQbJSvORxlQwZpuSV2I/edit#heading=h.69hvvg35j8un WITH fenix_union AS ( SELECT *, 'org_mozilla_fenix' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_fenix.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_fenix_nightly' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_firefox' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_firefox.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_firefox_beta' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_firefox_beta.baseline_clients_last_seen` UNION ALL SELECT *, 'org_mozilla_fennec_aurora' AS _dataset FROM `moz-fx-data-shared-prod.org_mozilla_fennec_aurora.baseline_clients_last_seen` ), fenix_app_info AS ( SELECT *, mozfun.norm.fenix_app_info(_dataset, app_build) AS _app_info FROM fenix_union ) SELECT * EXCEPT (_dataset, _app_info) REPLACE(_app_info.channel AS normalized_channel), _app_info.app_name, FROM fenix_app_info","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_enrollment_other_events_overall","text":"","title":"experiment_enrollment_other_events_overall"},{"location":"moz-fx-data-shared-prod/telemetry/#view_31","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_other_events_overall` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_other_events_overall_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#attitudes_daily","text":"","title":"attitudes_daily"},{"location":"moz-fx-data-shared-prod/telemetry/#view_32","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.attitudes_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.attitudes_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_heartbeat_parquet","text":"","title":"telemetry_heartbeat_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_33","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_heartbeat_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_heartbeat_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#main_summary","text":"","title":"main_summary"},{"location":"moz-fx-data-shared-prod/telemetry/#view_34","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_summary` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.main_summary_v4`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#asn_aggregates","text":"","title":"asn_aggregates"},{"location":"moz-fx-data-shared-prod/telemetry/#view_35","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.asn_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.asn_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#buildhub2","text":"","title":"buildhub2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_36","text":"-- This is an authorized view that allows us to read specific data from -- a project owned by CloudOps; if the definition here changes, -- it may need to be manually redeployed by Data Ops. CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.buildhub2` AS SELECT * FROM `moz-fx-buildhub2-prod-4784.build_metadata.buildhub2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_mobile_event_parquet_v2","text":"","title":"telemetry_mobile_event_parquet_v2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_37","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet_v2` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, metadata.uri.app_name, os, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id, metadata.uri.app_name, metadata.uri.app_version, sample_id, metadata.uri.app_update_channel ) AS metadata, v, client_id, seq, locale, osversion, device, arch, created, process_start_timestamp, tz, settings, ARRAY( SELECT AS STRUCT f0_ AS timestamp, f1_ AS category, f2_ AS method, f3_ AS object, f4_ AS value, f5_ AS extra FROM UNNEST(events)) AS events, experiments FROM `moz-fx-data-shared-prod.telemetry.mobile_event`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_focus_event_parquet_v1","text":"","title":"telemetry_focus_event_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_38","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, metadata.uri.app_update_channel AS channel, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id, metadata.uri.app_name ) AS metadata, v, client_id, seq, locale, os, osversion, created, tz, settings, events, arch, device, process_start_timestamp, experiments FROM `moz-fx-data-shared-prod.telemetry.focus_event`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_last_seen","text":"","title":"clients_last_seen"},{"location":"moz-fx-data-shared-prod/telemetry/#view_39","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiments","text":"","title":"experiments"},{"location":"moz-fx-data-shared-prod/telemetry/#view_40","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments` AS SELECT * EXCEPT ( scalar_content_webrtc_nicer_stun_retransmits, scalar_parent_devtools_aboutdevtools_noinstall_exits, scalar_parent_media_blocked_autoplay_no_audio_track_count, histogram_content_devtools_computedview_opened_count, histogram_content_pwmgr_manage_deleted, scalar_parent_devtools_changesview_contextmenu_copy, scalar_content_telemetry_process_creation_timestamp_inconsistent, scalar_parent_devtools_changesview_contextmenu_copy_rule, active_experiment_id, plugins_infobar_shown, scalar_parent_media_page_had_media_count, scalar_parent_webrtc_peerconnection_legacy_callback_stats_used, histogram_content_devtools_responsive_opened_count, histogram_parent_devtools_webaudioeditor_opened_count, histogram_content_pwmgr_manage_copied_password, scalar_content_sw_cors_res_for_so_req_count, scalar_parent_browser_errors_sample_rate, scalar_parent_browser_feeds_livebookmark_item_opened, scalar_parent_browser_session_restore_worker_restart_count, scalar_parent_formautofill_creditcards_fill_type_autofill_modified, histogram_content_devtools_netmonitor_opened_count, scalar_parent_encoding_override_used, scalar_parent_gfx_hdr_windows_display_colorspace_bitfield, scalar_parent_corroborate_system_addons_corrupted, scalar_parent_pdf_viewer_print, scalar_parent_datasanitization_network_cookie_lifetimepolicy, scalar_parent_webrtc_peerconnection_promise_and_callback_stats_used, scalar_parent_telemetry_about_telemetry_pageload, scalar_parent_devtools_changesview_copy, scalar_parent_networking_http_connections_captive_portal, plugins_infobar_block, scalar_parent_browser_errors_collected_with_stack_count, histogram_parent_devtools_developertoolbar_opened_count, histogram_content_devtools_picker_eyedropper_opened_count, histogram_content_devtools_shadereditor_opened_count, histogram_content_devtools_paintflashing_opened_count, web_notification_shown, scalar_parent_media_autoplay_would_be_allowed_count, scalar_parent_navigator_storage_persist_count, scalar_parent_media_blocked_no_metadata_endup_no_audio_track, scalar_parent_devtools_changesview_contextmenu_copy_declaration, scalar_parent_webrtc_peerconnection_datachannel_max_retx_used, plugins_infobar_dismissed, scalar_parent_aushelper_websense_reg_version, scalar_parent_browser_feeds_livebookmark_opened, histogram_content_devtools_scratchpad_window_opened_count, histogram_content_devtools_animationinspector_opened_count, histogram_content_devtools_inspector_opened_count, scalar_parent_security_tls_delegated_credentials_txn, scalar_parent_datasanitization_privacy_clearonshutdown_downloads, crashes_detected_content, scalar_content_webrtc_peerconnection_connected, scalar_parent_browser_usage_graphite, scalar_parent_preferences_read_user_js, histogram_content_devtools_developertoolbar_opened_count, scalar_parent_datasanitization_privacy_clearonshutdown_history, scalar_parent_datasanitization_session_permission_exceptions, scalar_parent_telemetry_profile_directory_scans, histogram_content_devtools_custom_opened_count, histogram_content_devtools_menu_eyedropper_opened_count, histogram_content_devtools_jsprofiler_opened_count, scalar_content_webrtc_hostnameobfuscation_enabled_failed, scalar_parent_browser_session_restore_tabbar_restore_available, scalar_parent_devtools_onboarding_is_devtools_user, scalar_parent_telemetry_profile_directory_scan_date, histogram_content_devtools_layoutview_opened_count, scalar_parent_identity_fxaccounts_missed_commands_fetched, plugins_infobar_allow, scalar_content_media_blocked_autoplay_no_audio_track_count, scalar_parent_idb_type_temporary_count, scalar_parent_preferences_prevent_accessibility_services, histogram_content_devtools_webaudioeditor_opened_count, histogram_content_devtools_eyedropper_opened_count, histogram_content_pwmgr_manage_copied_username, user_pref_marionette_enabled, scalar_parent_telemetry_ecosystem_old_send_time, scalar_content_webrtc_hostnameobfuscation_disabled_failed, scalar_parent_webrtc_hostnameobfuscation_enabled_failed, scalar_content_navigator_storage_estimate_count, scalar_parent_browser_errors_reported_success_count, scalar_parent_storage_sync_api_usage_extensions_using, histogram_parent_devtools_canvasdebugger_opened_count, scalar_parent_media_allowed_autoplay_no_audio_track_count, scalar_parent_telemetry_process_creation_timestamp_inconsistent, loop_activity_counter, scalar_content_browser_feeds_preview_loaded, scalar_parent_media_autoplay_would_not_be_allowed_count, scalar_parent_media_blocked_no_metadata, histogram_content_devtools_jsdebugger_opened_count, scalar_parent_webrtc_peerconnection_datachannel_created, scalar_parent_webrtc_hostnameobfuscation_disabled_failed, scalar_content_webrtc_hostnameobfuscation_enabled_succeeded, scalar_parent_datasanitization_privacy_clearonshutdown_cache, scalar_parent_browser_session_restore_tabbar_restore_clicked, scalar_gpu_browser_usage_graphite, scalar_parent_idb_type_persistent_count, scalar_parent_webrtc_nicer_stun_retransmits, histogram_content_devtools_styleeditor_opened_count, histogram_content_devtools_fontinspector_opened_count, scalar_parent_devtools_webreplay_reload_recording, scalar_parent_devtools_webreplay_save_recording, scalar_content_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_pdf_viewer_fallback_shown, scalar_parent_datasanitization_privacy_sanitize_sanitizeonshutdown, scalar_parent_datasanitization_privacy_clearonshutdown_formdata, scalar_parent_datasanitization_privacy_clearonshutdown_sessions, scalar_parent_services_sync_fxa_verification_method, scalar_content_idb_type_persistent_count, scalar_content_mediarecorder_recording_count, scalar_parent_screenshots_upload, scalar_parent_telemetry_os_shutting_down, histogram_content_devtools_ruleview_opened_count, histogram_content_devtools_dom_opened_count, scalar_parent_webrtc_hostnameobfuscation_enabled_succeeded, scalar_content_webrtc_peerconnection_promise_stats_used, scalar_gpu_telemetry_profile_directory_scans, scalar_parent_browser_feeds_livebookmark_count, scalar_parent_devtools_webreplay_stop_recording, scalar_parent_devtools_webreplay_load_recording, scalar_parent_corroborate_omnijar_corrupted, scalar_parent_pdf_viewer_used, scalar_parent_browser_session_restore_number_of_tabs, scalar_content_telemetry_profile_directory_scans, scalar_content_webrtc_peerconnection_promise_and_callback_stats_used, scalar_parent_mediarecorder_recording_count, scalar_parent_sw_cors_res_for_so_req_count, scalar_parent_telemetry_pending_operations_highwatermark_reached, user_pref_privacy_fuzzyfox_enabled, scalar_content_memoryreporter_max_ghost_windows, scalar_parent_devtools_aboutdevtools_opened, scalar_parent_datasanitization_privacy_clearonshutdown_cookies, user_pref_extensions_allow_non_mpc_extensions, scalar_content_idb_type_temporary_count, scalar_content_webrtc_peerconnection_legacy_callback_stats_used, scalar_parent_media_page_had_play_revoked_count, scalar_parent_webrtc_peerconnection_promise_stats_used, histogram_content_devtools_aboutdebugging_opened_count, histogram_content_devtools_webconsole_opened_count, histogram_content_devtools_browserconsole_opened_count, histogram_content_number_of_profiles, user_pref_browser_launcherprocess_enabled, scalar_parent_webrtc_peerconnection_datachannel_max_life_used, scalar_parent_datasanitization_privacy_clearonshutdown_sitesettings, scalar_parent_datasanitization_privacy_clearonshutdown_offlineapps, scalar_parent_browser_feeds_preview_loaded, scalar_parent_devtools_application_opened_count, scalar_parent_dom_contentprocess_troubled_due_to_memory, scalar_parent_navigator_storage_estimate_count, scalar_parent_telemetry_ecosystem_new_send_time, active_experiment_branch, histogram_content_devtools_webide_opened_count, histogram_content_devtools_scratchpad_opened_count, scalar_parent_datasanitization_privacy_clearonshutdown_openwindows, scalar_parent_browser_usage_plugin_instantiated, scalar_parent_telemetry_persistence_timer_hit_count, histogram_content_devtools_memory_opened_count, scalar_parent_devtools_changesview_contextmenu, scalar_parent_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_browser_session_restore_number_of_win, scalar_content_browser_usage_graphite, scalar_parent_preferences_created_new_user_prefs_file, scalar_content_webrtc_peerconnection_datachannel_max_retx_used, scalar_parent_webrtc_hostnameobfuscation_disabled_succeeded, push_api_notification_received, plugins_notification_user_action, user_prefs, histogram_parent_devtools_shadereditor_opened_count, scalar_parent_devtools_webreplay_new_recording, scalar_content_media_autoplay_default_blocked, scalar_parent_networking_data_transferred_captive_portal, scalar_parent_browser_feeds_feed_subscribed, histogram_content_devtools_storage_opened_count, histogram_content_devtools_options_opened_count, scalar_content_webrtc_hostnameobfuscation_disabled_succeeded, scalar_content_navigator_storage_persist_count, scalar_parent_browser_errors_collected_count, histogram_content_devtools_canvasdebugger_opened_count, histogram_content_devtools_jsbrowserdebugger_opened_count, scalar_parent_networking_http_transactions_captive_portal, scalar_parent_browser_errors_reported_failure_count, scalar_parent_devtools_aboutdevtools_installed, scalar_parent_preferences_prefs_file_was_invalid, scalar_parent_webrtc_peerconnection_connected ) FROM `moz-fx-data-shared-prod.telemetry.experiments_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#windows_10_build_distribution","text":"","title":"windows_10_build_distribution"},{"location":"moz-fx-data-shared-prod/telemetry/#view_41","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.windows_10_build_distribution` AS WITH channel_summary AS ( SELECT normalized_channel, build_group, max(build_number) AS max_build_number, sum(count) AS frequency FROM `moz-fx-data-shared-prod.telemetry.windows_10_aggregate` GROUP BY normalized_channel, build_group ORDER BY build_group ASC), counts AS ( SELECT normalized_channel, sum(frequency) AS total FROM channel_summary GROUP BY normalized_channel) SELECT normalized_channel, build_group, (frequency / total) AS frequency, frequency AS `count` FROM channel_summary INNER JOIN counts USING (normalized_channel) ORDER BY max_build_number ASC","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#crash_summary_v1","text":"","title":"crash_summary_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_42","text":"-- Query generated by: templates/unnest_parquet_view.sql.py crash_summary_v1 telemetry_derived.crash_summary_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_summary_v1` AS SELECT * REPLACE ( experiments.key_value AS experiments, (SELECT AS STRUCT payload.* REPLACE (payload.metadata.key_value AS metadata)) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_derived.crash_summary_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#core_clients_daily_v1","text":"","title":"core_clients_daily_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_43","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_daily_v1` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.core_clients_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#core_clients_daily","text":"","title":"core_clients_daily"},{"location":"moz-fx-data-shared-prod/telemetry/#view_44","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.core_clients_daily_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#health","text":"","title":"health"},{"location":"moz-fx-data-shared-prod/telemetry/#view_45","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.health` AS SELECT * REPLACE ( `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata, ( SELECT AS STRUCT payload.* REPLACE ( STRUCT( SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.undefined') AS INT64 ) AS undefined, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.timeout') AS INT64 ) AS timeout, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.abort') AS INT64 ) AS abort, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.eUnreachable') AS INT64 ) AS e_unreachable, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.eTerminated') AS INT64 ) AS e_terminated, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.sendFailure.eChannelOpen') AS INT64 ) AS e_channel_open ) AS send_failure, STRUCT( SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.sync') AS INT64 ) AS sync, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.prio') AS INT64 ) AS prio, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.main') AS INT64 ) AS main, SAFE_CAST( JSON_EXTRACT(additional_properties, '$.payload.pingDiscardedForSize.crash') AS INT64 ) AS crash, SAFE_CAST( JSON_EXTRACT( additional_properties, \"$.payload.pingDiscardedForSize['<unknown>']\" ) AS INT64 ) AS unknown ) AS ping_discarded_for_size ) ) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_stable.health_v4`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#mobile_event","text":"","title":"mobile_event"},{"location":"moz-fx-data-shared-prod/telemetry/#view_46","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.mobile_event` AS SELECT * REPLACE ( -- The pipeline ensures lowercase client_id since 2020-01-10, but we apply -- LOWER here to provide continuity for older data that still contains -- some uppercase IDs; see https://github.com/mozilla/gcp-ingestion/pull/1069 LOWER(client_id) AS client_id, `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata ) FROM `moz-fx-data-shared-prod.telemetry_stable.mobile_event_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#core_clients_last_seen_v1","text":"","title":"core_clients_last_seen_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_47","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_last_seen_v1` AS WITH with_days_since AS ( SELECT mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen(days_created_profile_bits) AS days_since_created_profile, * FROM `moz-fx-data-shared-prod.telemetry_derived.core_clients_last_seen_v1` ) SELECT -- Include date_last_seen for compatibility with existing queries. DATE_SUB(submission_date, INTERVAL days_since_seen DAY) AS date_last_seen, * FROM with_days_since","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_desktop_exact_mau28_v1","text":"","title":"firefox_desktop_exact_mau28_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_48","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_v1` AS WITH base AS ( SELECT submission_date, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, sum(IF(country IN ('US', 'GB', 'FR', 'DE', 'CA'), mau, 0)) AS tier1_mau, sum(IF(country IN ('US', 'GB', 'FR', 'DE', 'CA'), wau, 0)) AS tier1_wau, sum(IF(country IN ('US', 'GB', 'FR', 'DE', 'CA'), dau, 0)) AS tier1_dau, SUM(visited_5_uri_mau) AS visited_5_uri_mau, SUM(visited_5_uri_wau) AS visited_5_uri_wau, SUM(visited_5_uri_dau) AS visited_5_uri_dau FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_desktop_exact_mau28_by_dimensions_v1` GROUP BY submission_date ), -- We use imputed values for the period after the Armag-add-on deletion event; -- see https://bugzilla.mozilla.org/show_bug.cgi?id=1552558 imputed_global AS ( SELECT `date` AS submission_date, mau FROM `moz-fx-data-shared-prod.static.firefox_desktop_imputed_mau28_v1` WHERE datasource = 'desktop_global' ), -- imputed_tier1 AS ( SELECT `date` AS submission_date, mau FROM `moz-fx-data-shared-prod.static.firefox_desktop_imputed_mau28_v1` WHERE datasource = 'desktop_tier1' ) SELECT base.* REPLACE ( COALESCE(imputed_global.mau, base.mau) AS mau, COALESCE(imputed_tier1.mau, base.tier1_mau) AS tier1_mau ) FROM base FULL JOIN imputed_global USING (submission_date) FULL JOIN imputed_tier1 USING (submission_date) ORDER BY submission_date","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#addons","text":"","title":"addons"},{"location":"moz-fx-data-shared-prod/telemetry/#view_49","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addons` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.addons_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#main_summary_v3","text":"","title":"main_summary_v3"},{"location":"moz-fx-data-shared-prod/telemetry/#view_50","text":"-- Query generated by: templates/unnest_parquet_view.sql.py main_summary_v3 telemetry_derived.main_summary_v3 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_summary_v3` AS SELECT submission_date AS submission_date_s3, * REPLACE ( ARRAY(SELECT * FROM UNNEST(active_addons.list)) AS active_addons, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (_0.element.map_values.key_value AS map_values) FROM UNNEST(events.list) AS _0 ) AS events, popup_notification_stats.key_value AS popup_notification_stats, ARRAY(SELECT * FROM UNNEST(search_counts.list)) AS search_counts, ssl_handshake_result.key_value AS ssl_handshake_result ) FROM `moz-fx-data-shared-prod.telemetry_derived.main_summary_v3`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_enrollment_aggregates_recents","text":"","title":"experiment_enrollment_aggregates_recents"},{"location":"moz-fx-data-shared-prod/telemetry/#view_51","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_aggregates_recents` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_aggregates_recents_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#main_summary_v4","text":"","title":"main_summary_v4"},{"location":"moz-fx-data-shared-prod/telemetry/#view_52","text":"-- Query generated by: templates/unnest_parquet_view.sql.py main_summary_v4 telemetry_derived.main_summary_v4 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_summary_v4` AS SELECT submission_date AS submission_date_s3, * EXCEPT ( histogram_content_devtools_computedview_opened_count, histogram_content_devtools_fontinspector_opened_count, histogram_content_devtools_storage_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_downloads, histogram_content_devtools_eyedropper_opened_count, histogram_content_devtools_netmonitor_opened_count, scalar_parent_pdf_viewer_fallback_shown, histogram_content_devtools_paintflashing_opened_count, histogram_content_devtools_custom_opened_count, histogram_content_devtools_aboutdebugging_opened_count, histogram_content_devtools_layoutview_opened_count, scalar_parent_telemetry_ecosystem_new_send_time, scalar_parent_media_blocked_autoplay_no_audio_track_count, push_api_notification_received, histogram_content_devtools_jsbrowserdebugger_opened_count, scalar_parent_webrtc_peerconnection_datachannel_max_life_used, histogram_content_pwmgr_manage_deleted, scalar_parent_webrtc_peerconnection_promise_stats_used, scalar_content_webrtc_peerconnection_promise_and_callback_stats_used, scalar_parent_devtools_aboutdevtools_installed, histogram_content_devtools_webide_opened_count, histogram_content_devtools_picker_eyedropper_opened_count, scalar_parent_devtools_aboutdevtools_opened, scalar_parent_datasanitization_privacy_clearOnShutdown_offlineApps, scalar_parent_datasanitization_privacy_clearOnShutdown_siteSettings, scalar_parent_mediarecorder_recording_count, scalar_parent_sw_cors_res_for_so_req_count, scalar_parent_telemetry_ecosystem_old_send_time, scalar_parent_webrtc_peerconnection_legacy_callback_stats_used, scalar_parent_idb_type_temporary_count, scalar_gpu_telemetry_profile_directory_scans, scalar_parent_telemetry_persistence_timer_hit_count, histogram_content_devtools_scratchpad_window_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_cookies, histogram_content_devtools_memory_opened_count, scalar_parent_datasanitization_privacy_sanitize_sanitizeOnShutdown, histogram_content_devtools_webaudioeditor_opened_count, scalar_content_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_webrtc_hostnameobfuscation_disabled_failed, histogram_content_devtools_jsdebugger_opened_count, scalar_parent_webrtc_peerconnection_datachannel_max_retx_used, scalar_gpu_browser_usage_graphite, histogram_content_pwmgr_manage_copied_password, scalar_parent_browser_errors_sample_rate, scalar_parent_webrtc_hostnameobfuscation_enabled_succeeded, scalar_parent_datasanitization_privacy_clearOnShutdown_openWindows, scalar_parent_devtools_aboutdevtools_noinstall_exits, scalar_parent_datasanitization_privacy_clearOnShutdown_sessions, scalar_parent_webrtc_peerconnection_connected, scalar_content_webrtc_peerconnection_datachannel_max_retx_used, scalar_parent_webrtc_hostnameobfuscation_disabled_succeeded, scalar_parent_datasanitization_session_permission_exceptions, scalar_content_telemetry_profile_directory_scans, histogram_content_devtools_developertoolbar_opened_count, histogram_content_pwmgr_manage_copied_username, scalar_parent_telemetry_process_creation_timestamp_inconsistent, scalar_content_idb_type_temporary_count, scalar_parent_webrtc_peerconnection_datachannel_max_retx_and_life_used, scalar_parent_telemetry_pending_operations_highwatermark_reached, histogram_content_devtools_inspector_opened_count, histogram_content_number_of_profiles, scalar_content_media_autoplay_default_blocked, scalar_parent_devtools_application_opened_count, histogram_content_devtools_shadereditor_opened_count, scalar_parent_devtools_webreplay_save_recording, histogram_content_devtools_animationinspector_opened_count, histogram_content_devtools_dom_opened_count, histogram_content_devtools_styleeditor_opened_count, scalar_parent_webrtc_hostnameobfuscation_enabled_failed, histogram_content_devtools_ruleview_opened_count, scalar_parent_webrtc_peerconnection_promise_and_callback_stats_used, histogram_content_devtools_options_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_cache, scalar_parent_datasanitization_privacy_clearOnShutdown_formdata, scalar_content_webrtc_peerconnection_legacy_callback_stats_used, histogram_content_devtools_responsive_opened_count, loop_activity_counter, scalar_parent_pdf_viewer_print, scalar_parent_browser_session_restore_tabbar_restore_clicked, histogram_content_devtools_webconsole_opened_count, histogram_content_devtools_scratchpad_opened_count, scalar_parent_datasanitization_privacy_clearOnShutdown_history, user_pref_browser_launcherprocess_enabled, histogram_content_devtools_canvasdebugger_opened_count, scalar_content_telemetry_process_creation_timestamp_inconsistent, scalar_content_sw_cors_res_for_so_req_count, scalar_parent_datasanitization_network_cookie_lifetimePolicy, scalar_content_media_blocked_autoplay_no_audio_track_count, histogram_content_devtools_jsprofiler_opened_count ) REPLACE( histogram_content_cert_validation_success_by_ca.list AS histogram_content_cert_validation_success_by_ca, histogram_content_checkerboard_severity.list AS histogram_content_checkerboard_severity, histogram_content_composite_time.list AS histogram_content_composite_time, histogram_content_content_paint_time.list AS histogram_content_content_paint_time, histogram_content_cycle_collector_max_pause.list AS histogram_content_cycle_collector_max_pause, histogram_content_devtools_accessibility_picker_time_active_seconds.list AS histogram_content_devtools_accessibility_picker_time_active_seconds, histogram_content_devtools_accessibility_service_time_active_seconds.list AS histogram_content_devtools_accessibility_service_time_active_seconds, histogram_content_devtools_accessibility_time_active_seconds.list AS histogram_content_devtools_accessibility_time_active_seconds, histogram_content_devtools_toolbox_time_active_seconds.list AS histogram_content_devtools_toolbox_time_active_seconds, histogram_content_fx_new_window_ms.list AS histogram_content_fx_new_window_ms, histogram_content_fx_page_load_ms_2.list AS histogram_content_fx_page_load_ms_2, histogram_content_fx_searchbar_selected_result_method.list AS histogram_content_fx_searchbar_selected_result_method, histogram_content_fx_session_restore_restore_window_ms.list AS histogram_content_fx_session_restore_restore_window_ms, histogram_content_fx_session_restore_startup_init_session_ms.list AS histogram_content_fx_session_restore_startup_init_session_ms, histogram_content_fx_session_restore_startup_onload_initial_window_ms.list AS histogram_content_fx_session_restore_startup_onload_initial_window_ms, histogram_content_fx_tab_close_time_anim_ms.list AS histogram_content_fx_tab_close_time_anim_ms, histogram_content_fx_tab_switch_update_ms.list AS histogram_content_fx_tab_switch_update_ms, histogram_content_fx_urlbar_selected_result_index.list AS histogram_content_fx_urlbar_selected_result_index, histogram_content_fx_urlbar_selected_result_index_by_type.list AS histogram_content_fx_urlbar_selected_result_index_by_type, histogram_content_fx_urlbar_selected_result_method.list AS histogram_content_fx_urlbar_selected_result_method, histogram_content_fx_urlbar_selected_result_type.list AS histogram_content_fx_urlbar_selected_result_type, histogram_content_gc_animation_ms.list AS histogram_content_gc_animation_ms, histogram_content_gc_max_pause_ms.list AS histogram_content_gc_max_pause_ms, histogram_content_gc_max_pause_ms_2.list AS histogram_content_gc_max_pause_ms_2, histogram_content_geolocation_request_granted.list AS histogram_content_geolocation_request_granted, histogram_content_ghost_windows.list AS histogram_content_ghost_windows, histogram_content_gpu_process_initialization_time_ms.list AS histogram_content_gpu_process_initialization_time_ms, histogram_content_gpu_process_launch_time_ms_2.list AS histogram_content_gpu_process_launch_time_ms_2, histogram_content_http_channel_disposition.list AS histogram_content_http_channel_disposition, histogram_content_http_pageload_is_ssl.list AS histogram_content_http_pageload_is_ssl, histogram_content_http_transaction_is_ssl.list AS histogram_content_http_transaction_is_ssl, histogram_content_input_event_response_coalesced_ms.list AS histogram_content_input_event_response_coalesced_ms, histogram_content_ipc_read_main_thread_latency_ms.list AS histogram_content_ipc_read_main_thread_latency_ms, histogram_content_memory_distribution_among_content.list AS histogram_content_memory_distribution_among_content, histogram_content_memory_heap_allocated.list AS histogram_content_memory_heap_allocated, histogram_content_memory_resident_fast.list AS histogram_content_memory_resident_fast, histogram_content_memory_total.list AS histogram_content_memory_total, histogram_content_memory_unique.list AS histogram_content_memory_unique, histogram_content_memory_unique_content_startup.list AS histogram_content_memory_unique_content_startup, histogram_content_memory_vsize.list AS histogram_content_memory_vsize, histogram_content_memory_vsize_max_contiguous.list AS histogram_content_memory_vsize_max_contiguous, histogram_content_network_cache_metadata_first_read_time_ms.list AS histogram_content_network_cache_metadata_first_read_time_ms, histogram_content_network_cache_v2_hit_time_ms.list AS histogram_content_network_cache_v2_hit_time_ms, histogram_content_network_cache_v2_miss_time_ms.list AS histogram_content_network_cache_v2_miss_time_ms, histogram_content_places_autocomplete_6_first_results_time_ms.list AS histogram_content_places_autocomplete_6_first_results_time_ms, histogram_content_plugin_shutdown_ms.list AS histogram_content_plugin_shutdown_ms, histogram_content_pwmgr_form_autofill_result.list AS histogram_content_pwmgr_form_autofill_result, histogram_content_pwmgr_login_page_safety.list AS histogram_content_pwmgr_login_page_safety, histogram_content_sandbox_rejected_syscalls.list AS histogram_content_sandbox_rejected_syscalls, histogram_content_search_reset_result.list AS histogram_content_search_reset_result, histogram_content_search_service_init_ms.list AS histogram_content_search_service_init_ms, histogram_content_ssl_handshake_result.list AS histogram_content_ssl_handshake_result, histogram_content_ssl_handshake_version.list AS histogram_content_ssl_handshake_version, histogram_content_ssl_tls12_intolerance_reason_pre.list AS histogram_content_ssl_tls12_intolerance_reason_pre, histogram_content_ssl_tls13_intolerance_reason_pre.list AS histogram_content_ssl_tls13_intolerance_reason_pre, histogram_content_time_to_dom_complete_ms.list AS histogram_content_time_to_dom_complete_ms, histogram_content_time_to_dom_content_loaded_end_ms.list AS histogram_content_time_to_dom_content_loaded_end_ms, histogram_content_time_to_dom_content_loaded_start_ms.list AS histogram_content_time_to_dom_content_loaded_start_ms, histogram_content_time_to_dom_interactive_ms.list AS histogram_content_time_to_dom_interactive_ms, histogram_content_time_to_dom_loading_ms.list AS histogram_content_time_to_dom_loading_ms, histogram_content_time_to_first_click_ms.list AS histogram_content_time_to_first_click_ms, histogram_content_time_to_first_interaction_ms.list AS histogram_content_time_to_first_interaction_ms, histogram_content_time_to_first_key_input_ms.list AS histogram_content_time_to_first_key_input_ms, histogram_content_time_to_first_mouse_move_ms.list AS histogram_content_time_to_first_mouse_move_ms, histogram_content_time_to_first_scroll_ms.list AS histogram_content_time_to_first_scroll_ms, histogram_content_time_to_load_event_end_ms.list AS histogram_content_time_to_load_event_end_ms, histogram_content_time_to_load_event_start_ms.list AS histogram_content_time_to_load_event_start_ms, histogram_content_time_to_non_blank_paint_ms.list AS histogram_content_time_to_non_blank_paint_ms, histogram_content_time_to_response_start_ms.list AS histogram_content_time_to_response_start_ms, histogram_content_tracking_protection_enabled.list AS histogram_content_tracking_protection_enabled, histogram_content_uptake_remote_content_result_1.list AS histogram_content_uptake_remote_content_result_1, histogram_content_webext_content_script_injection_ms.list AS histogram_content_webext_content_script_injection_ms, histogram_content_webext_storage_local_get_ms.list AS histogram_content_webext_storage_local_get_ms, histogram_content_webext_storage_local_set_ms.list AS histogram_content_webext_storage_local_set_ms, histogram_content_webvr_time_spent_viewing_in_2d.list AS histogram_content_webvr_time_spent_viewing_in_2d, histogram_content_webvr_users_view_in.list AS histogram_content_webvr_users_view_in, histogram_gpu_checkerboard_severity.list AS histogram_gpu_checkerboard_severity, histogram_gpu_composite_time.list AS histogram_gpu_composite_time, histogram_gpu_content_frame_time.list AS histogram_gpu_content_frame_time, histogram_gpu_gpu_process_initialization_time_ms.list AS histogram_gpu_gpu_process_initialization_time_ms, histogram_gpu_ipc_read_main_thread_latency_ms.list AS histogram_gpu_ipc_read_main_thread_latency_ms, histogram_gpu_uptake_remote_content_result_1.list AS histogram_gpu_uptake_remote_content_result_1, histogram_gpu_webvr_time_spent_viewing_in_oculus.list AS histogram_gpu_webvr_time_spent_viewing_in_oculus, histogram_gpu_webvr_time_spent_viewing_in_openvr.list AS histogram_gpu_webvr_time_spent_viewing_in_openvr, histogram_gpu_webvr_users_view_in.list AS histogram_gpu_webvr_users_view_in, histogram_parent_a11y_consumers.list AS histogram_parent_a11y_consumers, histogram_parent_a11y_instantiated_flag.list AS histogram_parent_a11y_instantiated_flag, histogram_parent_cert_validation_success_by_ca.list AS histogram_parent_cert_validation_success_by_ca, histogram_parent_checkerboard_severity.list AS histogram_parent_checkerboard_severity, histogram_parent_composite_time.list AS histogram_parent_composite_time, histogram_parent_content_frame_time.list AS histogram_parent_content_frame_time, histogram_parent_content_paint_time.list AS histogram_parent_content_paint_time, histogram_parent_cookie_behavior.list AS histogram_parent_cookie_behavior, histogram_parent_cycle_collector_max_pause.list AS histogram_parent_cycle_collector_max_pause, histogram_parent_devtools_about_devtools_opened_key.list AS histogram_parent_devtools_about_devtools_opened_key, histogram_parent_devtools_about_devtools_opened_reason.list AS histogram_parent_devtools_about_devtools_opened_reason, histogram_parent_devtools_accessibility_picker_time_active_seconds.list AS histogram_parent_devtools_accessibility_picker_time_active_seconds, histogram_parent_devtools_accessibility_service_time_active_seconds.list AS histogram_parent_devtools_accessibility_service_time_active_seconds, histogram_parent_devtools_accessibility_time_active_seconds.list AS histogram_parent_devtools_accessibility_time_active_seconds, histogram_parent_devtools_entry_point.list AS histogram_parent_devtools_entry_point, histogram_parent_devtools_fonteditor_font_type_displayed.list AS histogram_parent_devtools_fonteditor_font_type_displayed, histogram_parent_devtools_fonteditor_n_font_axes.list AS histogram_parent_devtools_fonteditor_n_font_axes, histogram_parent_devtools_fonteditor_n_fonts_rendered.list AS histogram_parent_devtools_fonteditor_n_fonts_rendered, histogram_parent_devtools_toolbox_time_active_seconds.list AS histogram_parent_devtools_toolbox_time_active_seconds, histogram_parent_dns_failed_lookup_time.list AS histogram_parent_dns_failed_lookup_time, histogram_parent_dns_lookup_time.list AS histogram_parent_dns_lookup_time, histogram_parent_fx_new_window_ms.list AS histogram_parent_fx_new_window_ms, histogram_parent_fx_page_load_ms_2.list AS histogram_parent_fx_page_load_ms_2, histogram_parent_fx_searchbar_selected_result_method.list AS histogram_parent_fx_searchbar_selected_result_method, histogram_parent_fx_session_restore_restore_window_ms.list AS histogram_parent_fx_session_restore_restore_window_ms, histogram_parent_fx_session_restore_startup_init_session_ms.list AS histogram_parent_fx_session_restore_startup_init_session_ms, histogram_parent_fx_session_restore_startup_onload_initial_window_ms.list AS histogram_parent_fx_session_restore_startup_onload_initial_window_ms, histogram_parent_fx_tab_close_time_anim_ms.list AS histogram_parent_fx_tab_close_time_anim_ms, histogram_parent_fx_tab_switch_total_e10s_ms.list AS histogram_parent_fx_tab_switch_total_e10s_ms, histogram_parent_fx_tab_switch_update_ms.list AS histogram_parent_fx_tab_switch_update_ms, histogram_parent_fx_urlbar_selected_result_index.list AS histogram_parent_fx_urlbar_selected_result_index, histogram_parent_fx_urlbar_selected_result_index_by_type.list AS histogram_parent_fx_urlbar_selected_result_index_by_type, histogram_parent_fx_urlbar_selected_result_method.list AS histogram_parent_fx_urlbar_selected_result_method, histogram_parent_fx_urlbar_selected_result_type.list AS histogram_parent_fx_urlbar_selected_result_type, histogram_parent_gc_animation_ms.list AS histogram_parent_gc_animation_ms, histogram_parent_gc_max_pause_ms.list AS histogram_parent_gc_max_pause_ms, histogram_parent_gc_max_pause_ms_2.list AS histogram_parent_gc_max_pause_ms_2, histogram_parent_geolocation_request_granted.list AS histogram_parent_geolocation_request_granted, histogram_parent_ghost_windows.list AS histogram_parent_ghost_windows, histogram_parent_gpu_process_initialization_time_ms.list AS histogram_parent_gpu_process_initialization_time_ms, histogram_parent_gpu_process_launch_time_ms_2.list AS histogram_parent_gpu_process_launch_time_ms_2, histogram_parent_http_channel_disposition.list AS histogram_parent_http_channel_disposition, histogram_parent_http_pageload_is_ssl.list AS histogram_parent_http_pageload_is_ssl, histogram_parent_http_transaction_is_ssl.list AS histogram_parent_http_transaction_is_ssl, histogram_parent_input_event_response_coalesced_ms.list AS histogram_parent_input_event_response_coalesced_ms, histogram_parent_ipc_read_main_thread_latency_ms.list AS histogram_parent_ipc_read_main_thread_latency_ms, histogram_parent_memory_distribution_among_content.list AS histogram_parent_memory_distribution_among_content, histogram_parent_memory_heap_allocated.list AS histogram_parent_memory_heap_allocated, histogram_parent_memory_resident_fast.list AS histogram_parent_memory_resident_fast, histogram_parent_memory_total.list AS histogram_parent_memory_total, histogram_parent_memory_unique.list AS histogram_parent_memory_unique, histogram_parent_memory_vsize.list AS histogram_parent_memory_vsize, histogram_parent_memory_vsize_max_contiguous.list AS histogram_parent_memory_vsize_max_contiguous, histogram_parent_network_cache_metadata_first_read_time_ms.list AS histogram_parent_network_cache_metadata_first_read_time_ms, histogram_parent_network_cache_v2_hit_time_ms.list AS histogram_parent_network_cache_v2_hit_time_ms, histogram_parent_network_cache_v2_miss_time_ms.list AS histogram_parent_network_cache_v2_miss_time_ms, histogram_parent_places_autocomplete_6_first_results_time_ms.list AS histogram_parent_places_autocomplete_6_first_results_time_ms, histogram_parent_plugin_shutdown_ms.list AS histogram_parent_plugin_shutdown_ms, histogram_parent_pwmgr_blocklist_num_sites.list AS histogram_parent_pwmgr_blocklist_num_sites, histogram_parent_pwmgr_form_autofill_result.list AS histogram_parent_pwmgr_form_autofill_result, histogram_parent_pwmgr_login_last_used_days.list AS histogram_parent_pwmgr_login_last_used_days, histogram_parent_pwmgr_login_page_safety.list AS histogram_parent_pwmgr_login_page_safety, histogram_parent_pwmgr_manage_opened.list AS histogram_parent_pwmgr_manage_opened, histogram_parent_pwmgr_manage_visibility_toggled.list AS histogram_parent_pwmgr_manage_visibility_toggled, histogram_parent_pwmgr_num_passwords_per_hostname.list AS histogram_parent_pwmgr_num_passwords_per_hostname, histogram_parent_pwmgr_num_saved_passwords.list AS histogram_parent_pwmgr_num_saved_passwords, histogram_parent_pwmgr_prompt_remember_action.list AS histogram_parent_pwmgr_prompt_remember_action, histogram_parent_pwmgr_prompt_update_action.list AS histogram_parent_pwmgr_prompt_update_action, histogram_parent_pwmgr_saving_enabled.list AS histogram_parent_pwmgr_saving_enabled, histogram_parent_sandbox_rejected_syscalls.list AS histogram_parent_sandbox_rejected_syscalls, histogram_parent_search_reset_result.list AS histogram_parent_search_reset_result, histogram_parent_search_service_init_ms.list AS histogram_parent_search_service_init_ms, histogram_parent_ssl_handshake_result.list AS histogram_parent_ssl_handshake_result, histogram_parent_ssl_handshake_version.list AS histogram_parent_ssl_handshake_version, histogram_parent_ssl_tls12_intolerance_reason_pre.list AS histogram_parent_ssl_tls12_intolerance_reason_pre, histogram_parent_ssl_tls13_intolerance_reason_pre.list AS histogram_parent_ssl_tls13_intolerance_reason_pre, histogram_parent_time_to_first_click_ms.list AS histogram_parent_time_to_first_click_ms, histogram_parent_time_to_first_interaction_ms.list AS histogram_parent_time_to_first_interaction_ms, histogram_parent_time_to_first_key_input_ms.list AS histogram_parent_time_to_first_key_input_ms, histogram_parent_time_to_first_mouse_move_ms.list AS histogram_parent_time_to_first_mouse_move_ms, histogram_parent_time_to_first_scroll_ms.list AS histogram_parent_time_to_first_scroll_ms, histogram_parent_time_to_non_blank_paint_ms.list AS histogram_parent_time_to_non_blank_paint_ms, histogram_parent_time_to_response_start_ms.list AS histogram_parent_time_to_response_start_ms, histogram_parent_touch_enabled_device.list AS histogram_parent_touch_enabled_device, histogram_parent_tracking_protection_enabled.list AS histogram_parent_tracking_protection_enabled, histogram_parent_update_bits_result_complete.list AS histogram_parent_update_bits_result_complete, histogram_parent_update_bits_result_partial.list AS histogram_parent_update_bits_result_partial, histogram_parent_update_can_use_bits_notify.list AS histogram_parent_update_can_use_bits_notify, histogram_parent_update_download_code_complete.list AS histogram_parent_update_download_code_complete, histogram_parent_update_download_code_partial.list AS histogram_parent_update_download_code_partial, histogram_parent_update_state_code_complete_stage.list AS histogram_parent_update_state_code_complete_stage, histogram_parent_update_state_code_complete_startup.list AS histogram_parent_update_state_code_complete_startup, histogram_parent_update_state_code_partial_stage.list AS histogram_parent_update_state_code_partial_stage, histogram_parent_update_state_code_partial_startup.list AS histogram_parent_update_state_code_partial_startup, histogram_parent_update_status_error_code_complete_stage.list AS histogram_parent_update_status_error_code_complete_stage, histogram_parent_update_status_error_code_complete_startup.list AS histogram_parent_update_status_error_code_complete_startup, histogram_parent_update_status_error_code_partial_stage.list AS histogram_parent_update_status_error_code_partial_stage, histogram_parent_update_status_error_code_partial_startup.list AS histogram_parent_update_status_error_code_partial_startup, histogram_parent_uptake_remote_content_result_1.list AS histogram_parent_uptake_remote_content_result_1, histogram_parent_webext_background_page_load_ms.list AS histogram_parent_webext_background_page_load_ms, histogram_parent_webext_browseraction_popup_open_ms.list AS histogram_parent_webext_browseraction_popup_open_ms, histogram_parent_webext_browseraction_popup_preload_result_count.list AS histogram_parent_webext_browseraction_popup_preload_result_count, histogram_parent_webext_content_script_injection_ms.list AS histogram_parent_webext_content_script_injection_ms, histogram_parent_webext_extension_startup_ms.list AS histogram_parent_webext_extension_startup_ms, histogram_parent_webext_pageaction_popup_open_ms.list AS histogram_parent_webext_pageaction_popup_open_ms, histogram_parent_webext_storage_local_get_ms.list AS histogram_parent_webext_storage_local_get_ms, histogram_parent_webext_storage_local_set_ms.list AS histogram_parent_webext_storage_local_set_ms, histogram_parent_webvr_time_spent_viewing_in_2d.list AS histogram_parent_webvr_time_spent_viewing_in_2d, histogram_parent_webvr_time_spent_viewing_in_oculus.list AS histogram_parent_webvr_time_spent_viewing_in_oculus, histogram_parent_webvr_time_spent_viewing_in_openvr.list AS histogram_parent_webvr_time_spent_viewing_in_openvr, histogram_parent_webvr_users_view_in.list AS histogram_parent_webvr_users_view_in ) FROM `moz-fx-data-shared-prod.telemetry_derived.main_summary_v4`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#main_1pct","text":"","title":"main_1pct"},{"location":"moz-fx-data-shared-prod/telemetry/#view_53","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_1pct` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.main_1pct_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#addons_v2","text":"","title":"addons_v2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_54","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addons_v2` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.addons_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiments_aggregates_v1","text":"","title":"experiments_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_55","text":"-- Query generated by: templates/unnest_parquet_view.sql.py experiments_aggregates_v1 telemetry_derived.experiments_aggregates_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments_aggregates_v1` AS SELECT * REPLACE ( histogram.key_value AS histogram, ARRAY(SELECT * FROM UNNEST(statistics.list)) AS statistics ) FROM `moz-fx-data-shared-prod.telemetry_derived.experiments_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#core_clients_last_seen","text":"","title":"core_clients_last_seen"},{"location":"moz-fx-data-shared-prod/telemetry/#view_56","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.core_clients_last_seen` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.core_clients_last_seen_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_focus_event_parquet","text":"","title":"telemetry_focus_event_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_57","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#windows_10_patch_adoption","text":"","title":"windows_10_patch_adoption"},{"location":"moz-fx-data-shared-prod/telemetry/#view_58","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.windows_10_patch_adoption` AS SELECT CAST(ubr AS int64) AS numeric_windows_ubr, build_number, ubr AS label, SUM(count) AS frequency FROM `moz-fx-data-shared-prod.telemetry.windows_10_aggregate` GROUP BY numeric_windows_ubr, build_number, label ORDER BY numeric_windows_ubr ASC","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_scalar_aggregates_v1","text":"","title":"clients_scalar_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_59","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_scalar_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_scalar_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#ssl_ratios_v1","text":"","title":"ssl_ratios_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_60","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.ssl_ratios_v1` AS WITH windowed AS ( SELECT *, SUM(ssl_loads) OVER w1 + SUM(non_ssl_loads) OVER w1 AS total_loads FROM `moz-fx-data-shared-prod.telemetry_derived.ssl_ratios_v1` WINDOW w1 AS ( ORDER BY submission_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) ) SELECT submission_date, os, country, -- ratio of pings that have the probe reporting_ratio, -- normalized count of pageloads that went into this ratio (non_ssl_loads + ssl_loads) / total_loads AS normalized_pageloads, ssl_loads / (non_ssl_loads + ssl_loads) AS ratio FROM windowed WHERE non_ssl_loads + ssl_loads > 5000","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_new_profile_parquet_v2","text":"","title":"telemetry_new_profile_parquet_v2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_61","text":"-- Query generated by: templates/unnest_parquet_view.sql.py telemetry_new_profile_parquet_v2 telemetry_derived.telemetry_new_profile_parquet_v2 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_new_profile_parquet_v2` AS SELECT submission_date AS submission, * REPLACE ( (SELECT AS STRUCT environment.* REPLACE ((SELECT AS STRUCT environment.partner.* REPLACE (ARRAY(SELECT * FROM UNNEST(environment.partner.partner_names.list)) AS partner_names)) AS partner)) AS environment ) FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_new_profile_parquet_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#socorro_crash","text":"","title":"socorro_crash"},{"location":"moz-fx-data-shared-prod/telemetry/#view_62","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.socorro_crash` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.socorro_crash_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_search_aggregates_recents","text":"","title":"experiment_search_aggregates_recents"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_daily_histogram_aggregates_v1","text":"","title":"clients_daily_histogram_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_63","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily_histogram_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_daily_histogram_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#devtools_panel_usage","text":"","title":"devtools_panel_usage"},{"location":"moz-fx-data-shared-prod/telemetry/#view_64","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.devtools_panel_usage` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.devtools_panel_usage_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_day_2_7_activation","text":"","title":"firefox_nondesktop_day_2_7_activation"},{"location":"moz-fx-data-shared-prod/telemetry/#view_65","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_day_2_7_activation` AS SELECT DATE_SUB(submission_date, INTERVAL 6 DAY) AS cohort_date, * EXCEPT (submission_date) FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_nondesktop_day_2_7_activation_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#desktop_retention_1_week","text":"","title":"desktop_retention_1_week"},{"location":"moz-fx-data-shared-prod/telemetry/#metadata_1","text":"Friendly name : Desktop 1-Week Retention Description : Among profiles that were active at least once in the week starting on the specified day (days 0 through 6), whether each profile is active during the following week (days 7 through 13). This based on https://docs.telemetry.mozilla.org/cookbooks/retention.html#1-week-retention for the usage criterion \"Any Firefox Activity\" on Firefox (Desktop) Owners : dthorn@mozilla.com , jklukas@mozilla.com","title":"Metadata"},{"location":"moz-fx-data-shared-prod/telemetry/#view_66","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.desktop_retention_1_week` AS SELECT client_id, sample_id, DATE_SUB(submission_date, INTERVAL 13 DAY) AS `date`, -- active week 1 `moz-fx-data-shared-prod`.udf.active_n_weeks_ago(days_seen_bits, 0) AS retained, FROM `moz-fx-data-shared-prod.telemetry.clients_last_seen` WHERE -- active week 0 `moz-fx-data-shared-prod`.udf.active_n_weeks_ago(days_seen_bits, 1)","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#fenix_events_v1","text":"","title":"fenix_events_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_67","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.fenix_events_v1` AS SELECT submission_timestamp, client_info.client_id AS device_id, CONCAT(document_id, CAST(event.timestamp AS STRING)) AS insert_id, CONCAT(event.category, '.', event.name) AS event_type, TIMESTAMP_ADD(PARSE_TIMESTAMP('%Y-%m-%dT%H:%M%Ez', ping_info.start_time), INTERVAL event.timestamp SECOND) AS timestamp, client_info.app_display_version AS app_version, client_info.os AS platform, client_info.os AS os_name, client_info.os_version AS os_version, client_info.device_manufacturer AS device_manufacturer, client_info.device_model AS device_model, metadata.geo.country AS country, metadata.geo.subdivision1 AS region, metadata.geo.city AS city, ( -- direct insert of `udf.kv_array_to_json_string`, for use in a view SELECT CONCAT( '{', ARRAY_TO_STRING( ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')), \",\"), '}') FROM UNNEST(event.extra) ) AS event_properties, TO_JSON_STRING( STRUCT(client_info.architecture AS arch) ) AS user_properties FROM `moz-fx-data-shared-prod.org_mozilla_fenix_stable.events_v1` CROSS JOIN UNNEST(events) AS event","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_ip_privacy_parquet_v1","text":"","title":"telemetry_ip_privacy_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_68","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_ip_privacy_parquet_v1` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_ip_privacy_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#active_profiles","text":"","title":"active_profiles"},{"location":"moz-fx-data-shared-prod/telemetry/#view_69","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.active_profiles` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.active_profiles_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_core_parquet","text":"","title":"telemetry_core_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_70","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_core_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_core_parquet_v3`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#socorro_crash_v2","text":"","title":"socorro_crash_v2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_71","text":"-- Query generated by: templates/unnest_parquet_view.sql.py socorro_crash_v2 telemetry_derived.socorro_crash_v2 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.socorro_crash_v2` AS SELECT * REPLACE ( ARRAY(SELECT * FROM UNNEST(additional_minidumps.list)) AS additional_minidumps, ARRAY(SELECT * FROM UNNEST(addons.list)) AS addons, ( SELECT AS STRUCT json_dump.* REPLACE ( ( SELECT AS STRUCT json_dump.crashing_thread.* REPLACE ( ARRAY(SELECT * FROM UNNEST(json_dump.crashing_thread.frames.list)) AS frames ) ) AS crashing_thread, ARRAY(SELECT * FROM UNNEST(json_dump.modules.list)) AS modules, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (ARRAY(SELECT * FROM UNNEST(_0.element.frames.list)) AS frames) FROM UNNEST(json_dump.threads.list) AS _0 ) AS threads ) ) AS json_dump, ( SELECT AS STRUCT memory_report.* REPLACE (ARRAY(SELECT * FROM UNNEST(memory_report.reports.list)) AS reports) ) AS memory_report ) FROM `moz-fx-data-shared-prod.telemetry_derived.socorro_crash_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#nondesktop_clients_last_seen_v1","text":"","title":"nondesktop_clients_last_seen_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_72","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.nondesktop_clients_last_seen_v1` AS WITH glean_final AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry.fenix_clients_last_seen` UNION ALL SELECT *, 'Lockwise Baseline' AS app_name, FROM `moz-fx-data-shared-prod.mozilla_lockbox.baseline_clients_last_seen` UNION ALL SELECT *, 'Lockwise Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_ios_lockbox.baseline_clients_last_seen` UNION ALL SELECT *, 'Reference Browser Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_reference_browser.baseline_clients_last_seen` UNION ALL SELECT *, 'Firefox TV Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_tv_firefox.baseline_clients_last_seen` UNION ALL SELECT *, 'VR Browser Baseline' AS app_name, FROM `moz-fx-data-shared-prod.org_mozilla_vrbrowser.baseline_clients_last_seen` ) SELECT submission_date, client_id, days_seen_bits, days_since_seen, days_created_profile_bits, days_since_created_profile, app_name, os, osversion AS os_version, normalized_channel, campaign, country, locale, distribution_id, metadata_app_version AS app_version, mozfun.norm.product_info(app_name, os).*, FROM `moz-fx-data-shared-prod.telemetry.core_clients_last_seen` UNION ALL SELECT submission_date, client_id, days_seen_bits, days_since_seen, days_created_profile_bits, days_since_created_profile, app_name, normalized_os AS os, normalized_os_version AS os_version, normalized_channel, NULL AS campaign, country, locale, NULL AS distribution_id, app_display_version AS app_version, mozfun.norm.product_info(app_name, normalized_os).*, FROM glean_final","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#addon_aggregates_v2","text":"","title":"addon_aggregates_v2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_73","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.addon_aggregates_v2` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.addon_aggregates_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_daily","text":"","title":"clients_daily"},{"location":"moz-fx-data-shared-prod/telemetry/#view_74","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.clients_daily_v6`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_daily_v6","text":"","title":"clients_daily_v6"},{"location":"moz-fx-data-shared-prod/telemetry/#view_75","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_daily_v6` AS SELECT submission_date AS submission_date_s3, * EXCEPT ( active_experiment_id, active_experiment_branch, total_hours_sum, scalar_parent_dom_contentprocess_troubled_due_to_memory_sum, histogram_parent_devtools_developertoolbar_opened_count_sum ) REPLACE( IFNULL(country, '??') AS country, IFNULL(city, '??') AS city, IFNULL(geo_subdivision1, '??') AS geo_subdivision1, IFNULL(geo_subdivision2, '??') AS geo_subdivision2 ) FROM `moz-fx-data-shared-prod.telemetry_derived.clients_daily_v6`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#clients_last_seen_v1","text":"","title":"clients_last_seen_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_76","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.clients_last_seen_v1` AS WITH days_since AS ( SELECT DATE_DIFF(submission_date, first_seen_date, DAY) AS days_since_first_seen, DATE_DIFF(submission_date, second_seen_date, DAY) AS days_since_second_seen, mozfun.bits28.days_since_seen(days_seen_bits) AS days_since_seen, mozfun.bits28.days_since_seen(days_visited_1_uri_bits) AS days_since_visited_1_uri, mozfun.bits28.days_since_seen(days_visited_5_uri_bits) AS days_since_visited_5_uri, mozfun.bits28.days_since_seen(days_visited_10_uri_bits) AS days_since_visited_10_uri, mozfun.bits28.days_since_seen(days_had_8_active_ticks_bits) AS days_since_had_8_active_ticks, mozfun.bits28.days_since_seen(days_opened_dev_tools_bits) AS days_since_opened_dev_tools, mozfun.bits28.days_since_seen(days_created_profile_bits) AS days_since_created_profile, mozfun.bits28.days_since_seen(days_interacted_bits) AS days_since_interacted, * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_last_seen_v1` ) SELECT -- Segment definitions; see https://docs.telemetry.mozilla.org/concepts/segments.html -- 0x0FFFFFFE is a bitmask that accepts the previous 27 days, excluding the current day (rightmost bit) -- 0x183060C183 == 0b000001100000110000011000001100000110000011 is a bit mask that accepts a pair of -- consecutive days each week for six weeks; the current day and previous day are accepted. BIT_COUNT(days_seen_bits & 0x0FFFFFFE) >= 14 AS is_regular_user_v3, days_seen_bits & 0x0FFFFFFE = 0 AS is_new_or_resurrected_v3, BIT_COUNT(days_seen_bits & 0x0FFFFFFE) >= 14 AND ( ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date)) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) - 1) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) + 1) ) ) <= 1 ) ) AS is_weekday_regular_v1, BIT_COUNT(days_seen_bits & 0x0FFFFFFE) >= 14 AND NOT ( ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date)) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) - 1) ) ) <= 1 ) OR ( BIT_COUNT( days_seen_bits & 0x0FFFFFFE & ( 0x183060C183 >> (8 - EXTRACT(DAYOFWEEK FROM submission_date) + 1) ) ) <= 1 ) ) AS is_allweek_regular_v1, BIT_COUNT(days_visited_1_uri_bits) >= 21 AS is_core_active_v1, CASE WHEN BIT_COUNT(days_visited_1_uri_bits) BETWEEN 1 AND 6 THEN 'infrequent_user' WHEN BIT_COUNT(days_visited_1_uri_bits) BETWEEN 7 AND 13 THEN 'casual_user' WHEN BIT_COUNT(days_visited_1_uri_bits) BETWEEN 14 AND 20 THEN 'regular_user' WHEN BIT_COUNT(days_visited_1_uri_bits) >= 21 THEN 'core_user' ELSE 'other' END AS activity_segments_v1, ( days_since_first_seen = 6 -- 0x7F = mozfun.bits28.from_string('0000000000000000000001111111') AND BIT_COUNT(days_seen_bits & 0x7F) >= 5 ) AS new_profile_7_day_activated_v1, ( days_since_first_seen = 13 -- 0x3FFF = mozfun.bits28.from_string('0000000000000011111111111111') AND BIT_COUNT(days_seen_bits & 0x3FFF) >= 8 ) AS new_profile_14_day_activated_v1, ( days_since_first_seen = 20 -- 0x1FFFFF = mozfun.bits28.from_string('0000000111111111111111111111') AND BIT_COUNT(days_seen_bits & 0x1FFFFF) >= 12 ) AS new_profile_21_day_activated_v1, * EXCEPT ( active_experiment_id, scalar_parent_dom_contentprocess_troubled_due_to_memory_sum, total_hours_sum, histogram_parent_devtools_developertoolbar_opened_count_sum, active_experiment_branch ) REPLACE( IFNULL(country, '??') AS country, IFNULL(city, '??') AS city, IFNULL(geo_subdivision1, '??') AS geo_subdivision1, IFNULL(geo_subdivision2, '??') AS geo_subdivision2, ARRAY( SELECT AS STRUCT *, mozfun.bits28.days_since_seen(bits) AS days_since_seen FROM UNNEST(days_seen_in_experiment) ) AS days_seen_in_experiment ), -- TODO: Announce and remove this temporary field. CAST(sample_id AS STRING) AS _sample_id_string FROM days_since","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#fennec_ios_events_v1","text":"","title":"fennec_ios_events_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_77","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.fennec_ios_events_v1` AS WITH base_events AS ( SELECT *, event.f0_ AS timestamp, event.f0_ AS event_timestamp, event.f1_ AS event_category, event.f2_ AS event_method, event.f3_ AS event_object, event.f4_ AS event_value, event.f5_ AS event_map_values, metadata.uri.app_version, osversion AS os_version, metadata.geo.country, metadata.geo.city, metadata.uri.app_name FROM `moz-fx-data-shared-prod.telemetry.mobile_event` CROSS JOIN UNNEST(events) AS event ), all_events AS ( SELECT submission_timestamp, client_id AS device_id, ( created + COALESCE( SAFE_CAST(`moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'session_id') AS INT64), 0 ) ) AS session_id, CASE WHEN (event_category IN ('action')) AND (event_method IN ('foreground')) AND (event_object IN ('app')) THEN 'Fennec-iOS - App is foregrounded (session start)' WHEN (event_category IN ('action')) AND (event_method IN ('background')) AND (event_object IN ('app')) THEN 'Fennec-iOS - App is backgrounded (session end)' WHEN (event_category IN ('action')) AND (event_method IN ('view')) AND (event_object IN ('bookmarks-panel')) AND (event_value IN ('home-panel-tab-button')) THEN 'Fennec-iOS - View Bookmarks list from Home Panel tab button' WHEN (event_category IN ('action')) AND (event_method IN ('view')) AND (event_object IN ('bookmarks-panel')) AND (event_value IN ('app-menu')) THEN 'Fennec-iOS - View Bookmarks list from App Menu' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('bookmark')) AND (event_value IN ('page-action-menu')) THEN 'Fennec-iOS - Add Bookmark from Page Action Menu' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('bookmark')) AND (event_value IN ('share-menu')) THEN 'Fennec-iOS - Add Bookmark from Share Menu' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('bookmark')) AND (event_value IN ('activity-stream')) THEN 'Fennec-iOS - Add Bookmark from Activity Stream context menu' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('page-action-menu')) THEN 'Fennec-iOS - Delete Bookmark from Page Action Menu' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('activity-stream')) THEN 'Fennec-iOS - Delete Bookmark from Activity Stream context menu' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('bookmarks-panel')) THEN 'Fennec-iOS - Delete Bookmark from Home Panel via long-press' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('bookmark')) AND (event_value IN ('bookmarks-panel')) THEN 'Fennec-iOS - Delete Bookmark from Home Panel via swipe' WHEN (event_category IN ('action')) AND (event_method IN ('open')) AND (event_object IN ('bookmark')) AND (event_value IN ('awesomebar-results')) THEN 'Fennec-iOS - Open Bookmark from Awesomebar search results' WHEN (event_category IN ('action')) AND (event_method IN ('open')) AND (event_object IN ('bookmark')) AND (event_value IN ('bookmarks-panel')) THEN 'Fennec-iOS - Open Bookmark from Home Panel' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reader-mode-open-button')) THEN 'Fennec-iOS - Open Reader Mode' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reader-mode-close-button')) THEN 'Fennec-iOS - Leave Reader Mode' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('reader-mode-toolbar')) THEN 'Fennec-iOS - Add item to Reading List from Toolbar' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('share-extension')) THEN 'Fennec-iOS - Add item to Reading List from Share Extension' WHEN (event_category IN ('action')) AND (event_method IN ('add')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('page-action-menu')) THEN 'Fennec-iOS - Add item to Reading List from Page Action Menu' WHEN (event_category IN ('action')) AND (event_method IN ('open')) AND (event_object IN ('reading-list-item')) THEN 'Fennec-iOS - Open item from Reading List' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('reader-mode-toolbar')) THEN 'Fennec-iOS - Delete item from Reading List from Toolbar' WHEN (event_category IN ('action')) AND (event_method IN ('delete')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('reading-list-panel')) THEN 'Fennec-iOS - Delete item from Reading List from Home Panel' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('mark-as-read')) THEN 'Fennec-iOS - Mark Item As Read' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('reading-list-item')) AND (event_value IN ('mark-as-unread')) THEN 'Fennec-iOS - Mark Item As Unread' WHEN (event_category IN ('action')) AND (event_method IN ('change')) AND (event_object IN ('setting')) THEN 'Fennec-iOS - Setting changed' WHEN (event_category IN ('action')) AND (event_method IN ('scan')) AND (event_object IN ('qr-code-url')) THEN 'Fennec-iOS - URL-based QR code scanned' WHEN (event_category IN ('action')) AND (event_method IN ('scan')) AND (event_object IN ('qr-code-text')) THEN 'Fennec-iOS - Non-URL-based QR code scanned' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('send-to-device')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Send to device tapped' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('application-open-url')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Open in Firefox tapped (URL)' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('application-open-url')) AND (event_object IN ('searchText')) THEN 'Fennec-iOS - Open in Firefox tapped (search text)' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('bookmark-this-page')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Bookmark this page tapped' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('add-to-reading-list')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Add to reading list tapped' WHEN (event_category IN ('app-extension-action')) AND (event_method IN ('load-in-background')) AND (event_object IN ('url')) THEN 'Fennec-iOS - Load in Background tapped' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('website-data-button')) THEN 'Fennec-iOS - Tap Website Data in Data Management Menu' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('search-website-data')) THEN 'Fennec-iOS - Tap on the Search Bar in Website Data' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('clear-website-data-button')) THEN 'Fennec-iOS - Tap on \\'Clear All Website Data\\' button in Website Data' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-top-sites-button')) THEN 'Fennec-iOS - Tap Top Sites button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-blank-page-button')) THEN 'Fennec-iOS - Tap Blank Page button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-bookmarks-button')) THEN 'Fennec-iOS - Tap Bookmarks button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-history-button')) THEN 'Fennec-iOS - Tap History button in New Tab Settings' WHEN (event_category IN ('action')) AND (event_method IN ('tap')) AND (event_object IN ('show-homepage-button')) THEN 'Fennec-iOS - Tap Homepage button in New Tab Settings' WHEN (event_category IN ('prompt')) AND (event_method IN ('translate')) AND (event_object IN ('tab')) THEN 'Fennec-iOS - Prompt to translate tab to user\\'s native language' WHEN (event_category IN ('action')) AND (event_method IN ('translate')) AND (event_object IN ('tab')) THEN 'Fennec-iOS - Accept or decline offer to translate tab' WHEN (event_category IN ('action')) AND (event_method IN ('press')) AND (event_object IN ('dismissed-onboarding')) THEN 'Fennec-iOS - Dismiss onboarding screen' WHEN (event_category IN ('action')) AND (event_method IN ('press')) AND (event_object IN ('dismissed-onboarding-email-login')) THEN 'Fennec-iOS - Dismiss onboarding screen on email login card' WHEN (event_category IN ('action')) AND (event_method IN ('press')) AND (event_object IN ('dismissed-onboarding-sign-up')) THEN 'Fennec-iOS - Dismiss onboarding screen on sign up card' WHEN NOT ( -- events above are legacy definitions, moved from the previous Spark job. Following statement captures all new, non-ignored events (event_category = 'action' AND event_method = 'add' AND event_object = 'tab') OR (event_category = 'action' AND event_method = 'delete' AND event_object = 'tab') ) THEN CONCAT('Fennec-iOS - ', event_category, '.', event_method, '.', event_object) END AS event_name, event_timestamp AS timestamp, (event_timestamp + created) AS time, app_version, os AS os_name, os_version, country, city, ( SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM UNNEST(event_map_values) ) AS event_props_1, event_map_values, event_object, event_value, event_method, event_category, created, settings FROM base_events WHERE app_name IN ('Fennec') AND os IN ('iOS') -- bug 1636231 - disable background events in ios amplitude AND event_method != 'background' ), all_events_with_insert_ids AS ( SELECT * EXCEPT (event_category, created), CONCAT( device_id, \"-\", CAST(created AS STRING), \"-\", SPLIT(event_name, \" - \")[OFFSET(1)], \"-\", CAST(timestamp AS STRING), \"-\", event_category, \"-\", event_method, \"-\", event_object ) AS insert_id, event_name AS event_type FROM all_events WHERE event_name IS NOT NULL ), extra_props AS ( SELECT * EXCEPT (event_map_values, event_object, event_value, event_method, event_name), ( SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM ( SELECT 'gesture' AS key, CASE WHEN event_name = 'Fennec-iOS - Delete Bookmark from Home Panel via long-press' THEN 'long-press' WHEN event_name = 'Fennec-iOS - Delete Bookmark from Home Panel via swipe' THEN 'swipe' END AS value UNION ALL SELECT 'setting' AS key, CASE WHEN event_name = 'Fennec-iOS - Setting changed' THEN event_value END AS value UNION ALL SELECT 'to' AS key, CASE WHEN event_name = 'Fennec-iOS - Setting changed' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') WHEN event_name = 'Fennec-iOS - Prompt to translate tab to user\\'s native language' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') WHEN event_name = 'Fennec-iOS - Accept or decline offer to translate tab' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') END AS value UNION ALL SELECT 'from' AS key, CASE WHEN event_name = 'Fennec-iOS - Prompt to translate tab to user\\'s native language' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from') WHEN event_name = 'Fennec-iOS - Accept or decline offer to translate tab' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from') END AS value UNION ALL SELECT 'action' AS key, CASE WHEN event_name = 'Fennec-iOS - Accept or decline offer to translate tab' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'action') END AS value UNION ALL SELECT 'slide-num' AS key, CASE WHEN event_name = 'Fennec-iOS - Dismiss onboarding screen' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'slide-num') WHEN event_name = 'Fennec-iOS - Dismiss onboarding screen on email login card' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'slide-num') WHEN event_name = 'Fennec-iOS - Dismiss onboarding screen on sign up card' THEN `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'slide-num') END AS value UNION ALL SELECT 'event_value' AS key, event_value AS value ) WHERE VALUE IS NOT NULL ) AS event_props_2, ARRAY_CONCAT( ARRAY<STRING>[], ( SELECT ARRAY_AGG( CASE WHEN key = 'defaultSearchEngine' THEN CONCAT('\"', 'pref_default_search_engine', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'prefKeyAutomaticSliderValue' THEN CONCAT('\"', 'pref_automatic_slider_value', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'prefKeyAutomaticSwitchOnOff' THEN CONCAT('\"', 'pref_automatic_switch_on_off', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'prefKeyThemeName' THEN CONCAT('\"', 'pref_theme_name', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.ASBookmarkHighlightsVisible' THEN CONCAT( '\"', 'pref_activity_stream_bookmark_highlights_visible', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.ASPocketStoriesVisible' THEN CONCAT( '\"', 'pref_activity_stream_pocket_stories_visible', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.ASRecentHighlightsVisible' THEN CONCAT( '\"', 'pref_activity_stream_recent_highlights_visible', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.blockPopups' THEN CONCAT('\"', 'pref_block_popups', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key = 'profile.prefkey.trackingprotection.enabled' THEN CONCAT('\"', 'pref_tracking_protection_enabled', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.prefkey.trackingprotection.normalbrowsing' THEN CONCAT( '\"', 'pref_tracking_protection_normal_browsing', '\":\"', CAST(value AS STRING), '\"' ) WHEN key = 'profile.prefkey.trackingprotection.privatebrowsing' THEN CONCAT( '\"', 'pref_tracking_protection_private_browsing', '\":\"', CAST(value AS STRING), '\"' ) WHEN key = 'profile.prefkey.trackingprotection.strength' THEN CONCAT('\"', 'pref_tracking_protection_strength', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.saveLogins' THEN CONCAT('\"', 'pref_save_logins', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key = 'profile.settings.closePrivateTabs' THEN CONCAT( '\"', 'pref_settings_close_private_tabs', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'profile.show-translation' THEN CONCAT('\"', 'pref_show_translation', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'profile.showClipboardBar' THEN CONCAT( '\"', 'pref_show_clipboard_bar', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING) ) WHEN key = 'windowHeight' THEN CONCAT('\"', 'pref_window_height', '\":\"', CAST(value AS STRING), '\"') WHEN key = 'windowWidth' THEN CONCAT('\"', 'pref_window_width', '\":\"', CAST(value AS STRING), '\"') END IGNORE NULLS ) FROM UNNEST(SETTINGS) ) ) AS user_props FROM all_events_with_insert_ids ) SELECT * EXCEPT (event_props_1, event_props_2, user_props, settings), CONCAT( '{', ARRAY_TO_STRING( ( SELECT ARRAY_AGG(DISTINCT e) FROM UNNEST(ARRAY_CONCAT(IFNULL(event_props_1, []), IFNULL(event_props_2, []))) AS e ), \",\" ), '}' ) AS event_properties, CONCAT('{', ARRAY_TO_STRING(user_props, \",\"), '}') AS user_properties FROM extra_props","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_error_aggregates_v1","text":"","title":"experiment_error_aggregates_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_78","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_error_aggregates_v1` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_error_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_desktop_exact_mau28","text":"","title":"firefox_desktop_exact_mau28"},{"location":"moz-fx-data-shared-prod/telemetry/#view_79","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#eng_workflow_hgpush_parquet_v1","text":"","title":"eng_workflow_hgpush_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_80","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_hgpush_parquet_v1` AS SELECT submission_date AS submission_date_s3, * FROM `moz-fx-data-shared-prod.telemetry_derived.eng_workflow_hgpush_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_desktop_exact_mau28_by_client_count_dimensions","text":"","title":"firefox_desktop_exact_mau28_by_client_count_dimensions"},{"location":"moz-fx-data-shared-prod/telemetry/#view_81","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_client_count_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_desktop_exact_mau28_by_client_count_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#eng_workflow_build_parquet_v1","text":"","title":"eng_workflow_build_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_82","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_build_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date, DATE(submission_timestamp) AS submission_date_s3, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date` ) AS metadata, argv, build_opts, client_id, command, duration_ms, success, STRUCT( system.os, system.cpu_brand, system.drive_is_ssd, CAST(system.logical_cores AS int64) AS logical_cores, CAST(system.memory_gb AS int64) AS memory_gb, CAST(system.physical_cores AS int64) AS physical_cores, system.virtual_machine ) AS system, FORMAT_TIMESTAMP('%FT%X', time) AS time, exception, ARRAY( SELECT AS STRUCT u.* REPLACE (CAST(count AS int64) AS count) FROM UNNEST(file_types_changed) AS u ) AS file_types_changed, build_attrs FROM `moz-fx-data-shared-prod.eng_workflow.build`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_core_parquet_v3","text":"","title":"telemetry_core_parquet_v3"},{"location":"moz-fx-data-shared-prod/telemetry/#view_83","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_core_parquet_v3` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, metadata.uri.app_name, os, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id AS app_build_id, normalized_channel ) AS metadata, STRUCT( metadata.uri.app_name AS name ) AS application, v, client_id, seq, locale, osversion, device, arch, profile_date, default_search, distribution_id, created, tz, sessions, durations, searches, experiments, flash_usage, campaign, campaign AS campaign_id, default_browser, show_tracker_stats_share, accessibility_services, metadata.uri.app_version AS metadata_app_version, bug_1501329_affected FROM `moz-fx-data-shared-prod.telemetry.core`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_desktop_exact_mau28_by_dimensions_v1","text":"","title":"firefox_desktop_exact_mau28_by_dimensions_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_84","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_dimensions_v1` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.firefox_desktop_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_enrollment_overall","text":"","title":"experiment_enrollment_overall"},{"location":"moz-fx-data-shared-prod/telemetry/#view_85","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_overall` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_overall_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_enrollment_cumulative_population_estimate","text":"","title":"experiment_enrollment_cumulative_population_estimate"},{"location":"moz-fx-data-shared-prod/telemetry/#view_86","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_cumulative_population_estimate` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_cumulative_population_estimate_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#client_probe_counts_v1","text":"","title":"client_probe_counts_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_87","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.client_probe_counts` AS WITH all_counts AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_scalar_probe_counts_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.clients_histogram_probe_counts_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.scalar_percentiles_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.histogram_percentiles_v1` ) SELECT * FROM all_counts","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_downgrade_parquet_v1","text":"","title":"telemetry_downgrade_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_88","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_downgrade_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date, `id`, creation_date, application, client_id, version, STRUCT(payload.last_version, payload.last_build_id, payload.has_sync, CAST(NULL AS boolean) AS has_binary, CAST(payload.button AS int64) AS button ) AS payload FROM `moz-fx-data-shared-prod.telemetry.downgrade`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_unenrollment_overall","text":"","title":"experiment_unenrollment_overall"},{"location":"moz-fx-data-shared-prod/telemetry/#view_89","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_unenrollment_overall` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_unenrollment_overall_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#eng_workflow_hgpush_parquet","text":"","title":"eng_workflow_hgpush_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_90","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_hgpush_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.eng_workflow_hgpush_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#rocket_android_events_v1","text":"","title":"rocket_android_events_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_91","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.rocket_android_events_v1` AS WITH base_events AS ( SELECT *, event.f0_ AS timestamp, event.f0_ AS event_timestamp, event.f1_ AS event_category, event.f2_ AS event_method, event.f3_ AS event_object, event.f4_ AS event_value, event.f5_ AS event_map_values, metadata.uri.app_version, osversion AS os_version, metadata.geo.country, metadata.geo.city, metadata.uri.app_name FROM `moz-fx-data-shared-prod.telemetry.focus_event` CROSS JOIN UNNEST(events) AS event ), all_events AS ( SELECT submission_timestamp, client_id AS device_id, (created + COALESCE(SAFE_CAST(`moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'session_id') AS INT64), 0)) AS session_id, CASE WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('launcher') ) THEN 'Rocket - App is launched by Launcher' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('shortcut') ) THEN 'Rocket - App is launched by Shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('private_mode') ) THEN 'Rocket - App is launched from Private Shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('private_shortcut') ) AND event_value IS NULL THEN 'Rocket - Show private shortcut prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('private_shortcut') ) AND (event_value IN ('positive', 'negative', 'dismiss') ) THEN 'Rocket - Click private shortcut prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('setting') ) AND (event_value IN ('pref_private_shortcut') ) THEN 'Rocket - Users clicked on a Setting' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('private_mode') ) AND (event_value IN ('exit') ) THEN 'Rocket - Exit private mode' WHEN (event_category IN ('action') ) AND (event_method IN ('pin_shortcut') ) AND (event_object IN ('private_shortcut') ) AND event_value IS NULL THEN 'Rocket - Private shortcut created' WHEN (event_category IN ('action') ) AND (event_method IN ('kill') ) AND (event_object IN ('app') ) AND event_value IS NULL THEN 'Rocket - Kill app' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('external_app') ) THEN 'Rocket - App is launched by external app' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('setting') ) AND (event_value IN ('learn_more') ) THEN 'Rocket - Users clicked on the Learn More link in Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('pref_locale') ) THEN 'Rocket - Users change Locale in Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('foreground') ) AND (event_object IN ('app') ) AND event_value IS NULL THEN 'Rocket - Session starts' WHEN (event_category IN ('action') ) AND (event_method IN ('background') ) AND (event_object IN ('app') ) AND event_value IS NULL THEN 'Rocket - Session ends' WHEN (event_category IN ('action') ) AND (event_method IN ('long_press') ) AND (event_object IN ('browser') ) AND event_value IS NULL THEN 'Rocket - Long Press ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('cancel') ) AND (event_object IN ('browser_contextmenu') ) AND event_value IS NULL THEN 'Rocket - Cancel ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('link') ) THEN 'Rocket - Share link via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('image') ) THEN 'Rocket - Share image via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('save') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('image') ) THEN 'Rocket - Save image via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('copy') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('link') ) THEN 'Rocket - Copy link via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('copy') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('image') ) THEN 'Rocket - Copy image via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('browser_contextmenu') ) AND (event_value IN ('link') ) THEN 'Rocket - Add link via ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('permission') ) AND (event_object IN ('browser') ) AND (event_value IN ('geolocation') ) THEN 'Rocket - Permission-Geolocation' WHEN (event_category IN ('action') ) AND (event_method IN ('permission') ) AND (event_object IN ('browser') ) AND (event_value IN ('file') ) THEN 'Rocket - Permission-File' WHEN (event_category IN ('action') ) AND (event_method IN ('permission') ) AND (event_object IN ('browser') ) AND (event_value IN ('audio', 'video', 'eme', 'midi') ) THEN 'Rocket - Permission-Media' WHEN (event_category IN ('action') ) AND (event_method IN ('fullscreen') ) AND (event_object IN ('browser') ) AND (event_value IN ('enter') ) THEN 'Rocket - Enter full screen' WHEN (event_category IN ('action') ) AND (event_method IN ('fullscreen') ) AND (event_object IN ('browser') ) AND (event_value IN ('exit') ) THEN 'Rocket - Exit full screen' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('home') ) THEN 'Rocket - Show Menu from Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('tab_tray') ) AND (event_value IN ('home') ) THEN 'Rocket - Show TabTray from Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('tab_tray') ) AND (event_value IN ('toolbar') ) THEN 'Rocket - Show TabTray from Toolbar' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('toolbar') ) THEN 'Rocket - Show Menu from Toolbar' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('download') ) THEN 'Rocket - Click Menu - Downloads' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('history') ) THEN 'Rocket - Click Menu - History' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('capture') ) THEN 'Rocket - Click Menu - MyShots' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Click Panel - Bookmarks' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('download') ) THEN 'Rocket - Click Panel - Downloads' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('history') ) THEN 'Rocket - Click Panel - History' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('capture') ) THEN 'Rocket - Click Panel - MyShots' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('turbo') ) THEN 'Rocket - Click Menu - TurboMode' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('night_mode') ) THEN 'Rocket - Click Menu - Night Mode' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('block_image') ) THEN 'Rocket - Click Menu - Block Images' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('clear_cache') ) THEN 'Rocket - Click Menu - Clear cache' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('settings') ) THEN 'Rocket - Click Menu - Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('exit') ) THEN 'Rocket - Click Menu - Exit' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Click Menu - Bookmarks' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('theme') ) THEN 'Rocket - Click Menu - Theme' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('add_topsite') ) THEN 'Rocket - Click Menu - Add Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('menu') ) AND (event_value IN ('vertical') ) THEN 'Rocket - Click Menu - Vertical Toggle' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('forward') ) THEN 'Rocket - Click Toolbar - Forward' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('reload') ) THEN 'Rocket - Click Toolbar - Reload' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Toolbar - Share Link' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Click Toolbar - Add bookmark' WHEN (event_category IN ('action') ) AND (event_method IN ('pin_shortcut') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Toolbar - Pin shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('pin_shortcut') ) AND (event_object IN ('menu') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Menu - Pin shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('capture') ) THEN 'Rocket - Click Toolbar - Take Screenshot' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Click Top Site' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Remove Top Site' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Add Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('snackbar') ) AND (event_value IN ('add_topsite') ) THEN 'Rocket - Click Add Topsite Snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('panel') ) AND (event_value IN ('add_topsite') ) THEN 'Rocket - Select to Add Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('theme') ) THEN 'Rocket - Show Theme Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('theme') ) THEN 'Rocket - Click Theme Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('go_set_default') ) THEN 'Rocket - Show Go-Set-Default Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('go_set_default') ) THEN 'Rocket - Click Go-Set-Default Message' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('home') ) THEN 'Rocket - Search in Home and add a tab' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('link') ) THEN 'Rocket - Enter an url in SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('select_query') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Use SearchSuggestion SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('type_query') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Search with text in SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('private_mode') ) AND (event_value IN ('enter', 'exit') ) THEN 'Rocket - Toggle Private Mode' WHEN (event_category IN ('action') ) AND (event_method IN ('long_press') ) AND (event_object IN ('search_suggestion') ) AND event_value IS NULL THEN 'Rocket - Long click on Search Suggestion' WHEN (event_category IN ('action') ) AND (event_method IN ('clear') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Clear SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('cancel') ) AND (event_object IN ('search_bar') ) AND event_value IS NULL THEN 'Rocket - Dismiss SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('search_box') ) THEN 'Rocket - Show SearchBar from Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('mini_urlbar') ) THEN 'Rocket - Show SearchBar by clicking MINI_URLBAR' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('search_btn') ) THEN 'Rocket - Show SearchBar by clicking SEARCH_BUTTON' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('toolbar') ) THEN 'Rocket - Add Tab from Toolbar' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Add Tab from TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('private_mode') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Enter Private Mode from TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Switch Tab From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Remove Tab From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Swipe Tab From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('close_all') ) AND (event_value IN ('tab_tray') ) THEN 'Rocket - Close all From TabTray' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('panel') ) AND (event_value IN ('file') ) THEN 'Rocket - Remove Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('delete') ) AND (event_object IN ('panel') ) AND (event_value IN ('file') ) THEN 'Rocket - Delete Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('file') ) THEN 'Rocket - Open Download File via snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('download') ) THEN 'Rocket - Show File ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('link') ) THEN 'Rocket - History Open Link' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('panel') ) AND (event_value IN ('link') ) THEN 'Rocket - History Remove Link' WHEN (event_category IN ('action') ) AND (event_method IN ('remove') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Bookmark Remove Item' WHEN (event_category IN ('action') ) AND (event_method IN ('edit') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Bookmark Edit Item' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Bookmark Open Item' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('history') ) THEN 'Rocket - Show History ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('menu') ) AND (event_value IN ('bookmark') ) THEN 'Rocket - Show Bookmark ContextMenu' WHEN (event_category IN ('action') ) AND (event_method IN ('clear') ) AND (event_object IN ('panel') ) AND (event_value IN ('history') ) THEN 'Rocket - Clear History' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('panel') ) AND (event_value IN ('capture') ) THEN 'Rocket - Open Capture Item' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('capture') ) AND (event_value IN ('link') ) THEN 'Rocket - Open Capture Link' WHEN (event_category IN ('action') ) AND (event_method IN ('edit') ) AND (event_object IN ('capture') ) AND (event_value IN ('image') ) THEN 'Rocket - Edit Capture Image' WHEN (event_category IN ('action') ) AND (event_method IN ('share') ) AND (event_object IN ('capture') ) AND (event_value IN ('image') ) THEN 'Rocket - Share Capture Image' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('capture') ) AND (event_value IN ('info') ) THEN 'Rocket - Show Capture Info' WHEN (event_category IN ('action') ) AND (event_method IN ('delete') ) AND (event_object IN ('capture') ) AND (event_value IN ('image') ) THEN 'Rocket - Delete Capture Image' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('feedback') ) AND (event_value IN ('dismiss', 'positive', 'negative') OR event_value IS NULL) THEN 'Rocket - click Rate App' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('feedback') ) AND event_value IS NULL THEN 'Rocket - Show Rate App' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('default_browser') ) AND event_value IS NULL THEN 'Rocket - Default Browser Notification shown' WHEN (event_category IN ('action') ) AND (event_method IN ('get') ) AND (event_object IN ('firstrun_push') ) AND event_value IS NULL THEN 'Rocket - Receive Firstrun Push config' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('firstrun_push') ) AND event_value IS NULL THEN 'Rocket - Firstrun Push notification shown' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('default_browser') ) AND event_value IS NULL THEN 'Rocket - Default Browser Notification Clicked' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('promote_share') ) AND (event_value IN ('dismiss', 'share') ) THEN 'Rocket - Promote Share Dialog Clicked' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('promote_share') ) AND event_value IS NULL THEN 'Rocket - Promote Share Dialog shown' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('themetoy') ) AND event_value IS NULL THEN 'Rocket - Change Theme To' WHEN (event_category IN ('action') ) AND (event_method IN ('reset') ) AND (event_object IN ('themetoy') ) AND event_value IS NULL THEN 'Rocket - Reset Theme To' WHEN (event_category IN ('action') ) AND (event_method IN ('clear') ) AND (event_object IN ('private_mode') ) AND event_value IS NULL THEN 'Rocket - Erase Private Mode Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('home') ) AND event_value IS NULL THEN 'Rocket - Home Impression' WHEN (event_category IN ('Downloads') ) AND (event_method IN ('long_press') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('download') ) THEN 'Rocket - Long Press Toolbar Download Indicator' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('find_in_page') ) AND (event_value IN ('next') ) THEN 'Rocket - Click FindInPage Next' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('find_in_page') ) AND (event_value IN ('previous') ) THEN 'Rocket - Click FindInPage Previous' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('menu') ) AND (event_value IN ('find_in_page') ) THEN 'Rocket - Click Menu FindInPage' WHEN (event_category IN ('search') ) AND (event_method IN ('click') ) AND (event_object IN ('quicksearch') ) AND event_value IS NULL THEN 'Rocket - Click Quick Search' WHEN (event_category IN ('enter landscape mode') ) AND (event_method IN ('change') ) AND (event_object IN ('landscape_mode') ) AND (event_value IN ('enter') ) THEN 'Rocket - Enter Landscape Mode' WHEN (event_category IN ('enter landscape mode') ) AND (event_method IN ('change') ) AND (event_object IN ('landscape_mode') ) AND (event_value IN ('exit') ) THEN 'Rocket - Exit Landscape Mode' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('update_msg') ) AND event_value IS NULL THEN 'Rocket - Show in-app update intro dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('update') ) AND event_value IS NULL THEN 'Rocket - Show google play\\'s in-app update dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('update_msg') ) AND (event_value IN ('positive', 'negative') ) THEN 'Rocket - Click in-app update intro dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('update') ) AND (event_value IN ('positive', 'negative') ) THEN 'Rocket - Click google play\\'s in-app update dialog' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('update') ) AND (event_value IN ('downloaded') ) THEN 'Rocket - Show in-app update install prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('update') ) AND (event_value IN ('apply') ) THEN 'Rocket - Click in-app update install prompt' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Show Firstrun Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Click Firstrun Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('logoman') ) AND event_value IS NULL THEN 'Rocket - Show Logoman' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('logoman') ) AND event_value IS NULL THEN 'Rocket - Click Logoman' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('logoman') ) AND event_value IS NULL THEN 'Rocket - Swipe Logoman' WHEN (event_category IN ('action') ) AND (event_method IN ('get') ) AND (event_object IN ('notification') ) AND event_value IS NULL THEN 'Rocket - Get Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('notification') ) AND event_value IS NULL THEN 'Rocket - Show Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('notification') ) AND (event_value IN ('dismiss') ) THEN 'Rocket - Dismiss Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('swipe') ) AND (event_object IN ('firstrun_push') ) AND (event_value IN ('dismiss') ) THEN 'Rocket - Dismiss D1 Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('notification') ) AND event_value IS NULL THEN 'Rocket - Open Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('firstrun_push') ) AND event_value IS NULL THEN 'Rocket - Open D1 Notification' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('in_app_message') ) THEN 'Rocket - Show In-App Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('in_app_message') ) THEN 'Rocket - Click In-App Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('content_hub') ) AND event_value IS NULL THEN 'Rocket - Click Content Hub' WHEN (event_category IN ('action') ) AND (event_method IN ('reload') ) AND (event_object IN ('content_home') ) AND event_value IS NULL THEN 'Rocket - Reload Content Home' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('content_home') ) THEN 'Rocket - Show Content Home Search Bar' WHEN (event_category IN ('action') ) AND (event_method IN ('select_query') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('content_home') ) THEN 'Rocket - Select Query Content Home' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('category') ) AND event_value IS NULL THEN 'Rocket - Open Category' WHEN (event_category IN ('action') ) AND (event_method IN ('open') ) AND (event_object IN ('detail_page') ) AND (event_value IN ('more') ) THEN 'Rocket - Open Detail Page More' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('content_tab') ) AND event_value IS NULL THEN 'Rocket - Start Content Tab' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('content_tab') ) AND event_value IS NULL THEN 'Rocket - End Content Tab' WHEN (event_category IN ('action') ) AND (event_method IN ('impression') ) AND (event_object IN ('category') ) AND event_value IS NULL THEN 'Rocket - Category Impression' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('process') ) AND (event_value IN ('vertical') ) THEN 'Rocket - Start Vertical Process' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('process') ) AND (event_value IN ('vertical') ) THEN 'Rocket - End Vertical Process' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('vertical') ) THEN 'Rocket - Show Vertical Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('process') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Start Tab Swipe Process' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('process') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - End Tab Swipe Process' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('tab_swipe') ) AND event_value IS NULL THEN 'Rocket - Start Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('tab_swipe') ) AND event_value IS NULL THEN 'Rocket - End Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('share') ) THEN 'Rocket - Click Toolbar - Share' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('OPEN_IN_BROWSER') ) THEN 'Rocket - Click Toolbar - Open in browser' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('reload') ) THEN 'Rocket - Click Toolbar - Reload' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('back') ) THEN 'Rocket - Click Toolbar - Back' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('toolbar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Click Toolbar - Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('drawer') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Show Tab Swipe Drawer' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('drawer') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Click Tab Swipe Drawer' WHEN (event_category IN ('action') ) AND (event_method IN ('add') ) AND (event_object IN ('tab') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Add Tab Swipe Tab' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Change Tab Swipe Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Show SearchBar from Tab Swipe' WHEN (event_category IN ('action') ) AND (event_method IN ('show_keyboard') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Show Keyboard from Tab Swipe SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('start_typing') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Start Typing from Tab Swipe SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('type_query') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Search with text in SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('select_query') ) AND (event_object IN ('search_bar') ) AND (event_value IN ('tab_swipe') ) THEN 'Rocket - Use SearchSuggestion in Tab Swipe SearchBar' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('detail_page') ) THEN 'Rocket - Change Travel Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('personalization') ) THEN 'Rocket - Change Personalization in Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('language') ) THEN 'Rocket - Change Language in Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('setting') ) AND (event_value IN ('lifestyle') ) THEN 'Rocket - Click News Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('category') ) THEN 'Rocket - Change Category in Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('setting') ) AND (event_value IN ('lifestyle') ) THEN 'Rocket - Change News Settings' WHEN (event_category IN ('action') ) AND (event_method IN ('pin') ) AND (event_object IN ('home') ) AND (event_value IN ('link') ) THEN 'Rocket - Pin Topsite' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('challenge_page') ) AND (event_value IN ('join') ) THEN 'Rocket - Click Challenge Page Join' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('task') ) THEN 'Rocket - Show Task Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('task') ) AND event_value IS NULL THEN 'Rocket - End Task' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('challenge_complete') ) THEN 'Rocket - Show Challenge Complete Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('challenge_complete') ) THEN 'Rocket - Click Challenge Complete Message' WHEN (event_category IN ('action') ) AND (event_method IN ('sign_in') ) AND (event_object IN ('account') ) AND event_value IS NULL THEN 'Rocket - Account Sign In' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('redeem_page') ) AND event_value IS NULL THEN 'Rocket - Show Redeem Page' WHEN (event_category IN ('action') ) AND (event_method IN ('copy') ) AND (event_object IN ('redeem_page') ) AND (event_value IN ('code') ) THEN 'Rocket - Copy Code on Redeem Page' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('redeem_page') ) AND (event_value IN ('use') ) THEN 'Rocket - Click Redeem on Redeem Page' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('profile') ) AND (event_value IN ('reward') ) THEN 'Rocket - Click Reward Profile' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('content_home') ) AND (event_value IN ('item') ) THEN 'Rocket - Click Content Home Item' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('challenge_page') ) AND (event_value IN ('login') ) THEN 'Rocket - Click Chellenge Page Login' WHEN (event_category IN ('action') ) AND (event_method IN ('long_press') ) AND (event_object IN ('content_home') ) AND (event_value IN ('item') ) THEN 'Rocket - Long Press Content Home Item' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('content_home') ) AND (event_value IN ('contextmenu') ) THEN 'Rocket - Click Content Home Contextmenu' WHEN (event_category IN ('action') ) AND (event_method IN ('launch') ) AND (event_object IN ('app') ) AND (event_value IN ('game_shortcut') ) THEN 'Rocket - App is launched by Game Shortcut' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('update') ) THEN 'Rocket - Show Update Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('update') ) THEN 'Rocket - Click Update Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('game_shortcut') ) THEN 'Rocket - Show Game Shortcut Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('travel_search_result') ) THEN 'Rocket - Show Travel Search Result Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('travel_search_result') ) THEN 'Rocket - Click Travel Search Result Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('setdefault_travel_search') ) THEN 'Rocket - Show Set-default Travel Search Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('setdefault_travel_search') ) THEN 'Rocket - Click Set-default Travel Search Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('toast') ) AND (event_value IN ('exit_warning') ) THEN 'Rocket - Show Exit Warning Toast' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_settings') ) THEN 'Rocket - Show Set-Default by Settings Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_link') ) THEN 'Rocket - Show Set-Default by Link Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_settings') ) THEN 'Rocket - Click Set-Default by Settings Message' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('message') ) AND (event_value IN ('set_default_by_link') ) THEN 'Rocket - Click Set-Default by Link Message' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('toast') ) AND (event_value IN ('set_default_success') ) THEN 'Rocket - Show Set-Default Success Toast' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('snackbar') ) AND (event_value IN ('set_default_try_again') ) THEN 'Rocket - Show Set-Default Try-again Snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('snackbar') ) AND (event_value IN ('set_default_try_again') ) THEN 'Rocket - Click Set-Default Try-again Snackbar' WHEN (event_category IN ('action') ) AND (event_method IN ('start') ) AND (event_object IN ('download') ) AND (event_value IN ('file') ) THEN 'Rocket - Start Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('end') ) AND (event_object IN ('download') ) AND (event_value IN ('file') ) THEN 'Rocket - End Download File' WHEN (event_category IN ('action') ) AND (event_method IN ('change') ) AND (event_object IN ('firstrun') ) AND (event_value IN ('turbo') ) THEN 'Rocket - Turn on Turbo Mode in First Run' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('firstrun') ) AND (event_value IN ('finish') ) THEN 'Rocket - Finish First Run' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Show Whatsnew Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('onboarding') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Click Whatsnew Onboarding' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Show Firstrun Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('show') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Show Whatsnew Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('firstrun') ) THEN 'Rocket - Click Firstrun Contextual Hint' WHEN (event_category IN ('action') ) AND (event_method IN ('click') ) AND (event_object IN ('contextual_hint') ) AND (event_value IN ('whatsnew') ) THEN 'Rocket - Click Whatsnew Contextual Hint' END AS event_name, event_timestamp AS timestamp, (event_timestamp + created) AS time, app_version, os AS os_name, os_version, country, city, (SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM UNNEST(event_map_values)) AS event_props_1, event_map_values, event_object, event_value, event_method, event_category, created, settings FROM base_events WHERE app_name IN ('Zerda', 'OTHER') AND os IN ('Android') ), all_events_with_insert_ids AS ( SELECT * EXCEPT (event_category, created), CONCAT(device_id, \"-\", CAST(created AS STRING), \"-\", SPLIT(event_name, \" - \")[OFFSET(1)], \"-\", CAST(timestamp AS STRING), \"-\", event_category, \"-\", event_method, \"-\", event_object) AS insert_id, event_name AS event_type FROM all_events WHERE event_name IS NOT NULL ), extra_props AS ( SELECT * EXCEPT (event_map_values, event_object, event_value, event_method, event_name), (SELECT ARRAY_AGG(CONCAT('\"', CAST(key AS STRING), '\":\"', CAST(value AS STRING), '\"')) FROM ( SELECT 'to' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to') AS value UNION ALL SELECT 'on' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'on') AS value UNION ALL SELECT 'from' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from') AS value UNION ALL SELECT 'mode' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'mode') AS value UNION ALL SELECT 'type' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'type') AS value UNION ALL SELECT 'source' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'source') AS value UNION ALL SELECT 'default' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'default') AS value UNION ALL SELECT 'position' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'position') AS value UNION ALL SELECT 'version' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'version') AS value UNION ALL SELECT 'category' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'category') AS value UNION ALL SELECT 'category_versio' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'category_versio') AS value UNION ALL SELECT 'snackbar' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'snackbar') AS value UNION ALL SELECT 'success' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'success') AS value UNION ALL SELECT 'delay' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'delay') AS value UNION ALL SELECT 'message' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'message') AS value UNION ALL SELECT 'engine' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'engine') AS value UNION ALL SELECT 'duration' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'duration') AS value UNION ALL SELECT 'from_build' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'from_build') AS value UNION ALL SELECT 'to_build' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'to_build') AS value UNION ALL SELECT 'action' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'action') AS value UNION ALL SELECT 'finish' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'finish') AS value UNION ALL SELECT 'page' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'page') AS value UNION ALL SELECT 'message_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'message_id') AS value UNION ALL SELECT 'link' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'link') AS value UNION ALL SELECT 'background' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'background') AS value UNION ALL SELECT 'primary' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'primary') AS value UNION ALL SELECT 'vertical' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'vertical') AS value UNION ALL SELECT 'component_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'component_id') AS value UNION ALL SELECT 'feed' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'feed') AS value UNION ALL SELECT 'subcategory_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'subcategory_id') AS value UNION ALL SELECT 'version_id' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'version_id') AS value UNION ALL SELECT 'app_link' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'app_link') AS value UNION ALL SELECT 'session_time' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'session_time') AS value UNION ALL SELECT 'show_keyboard' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'show_keyboard') AS value UNION ALL SELECT 'url_counts' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'url_counts') AS value UNION ALL SELECT 'impression' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'impression') AS value UNION ALL SELECT 'loadtime' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'loadtime') AS value UNION ALL SELECT 'audience_name' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'audience_name') AS value UNION ALL SELECT 'finished' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'finished') AS value UNION ALL SELECT 'task' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'task') AS value UNION ALL SELECT 'item_name' AS key, `moz-fx-data-shared-prod.udf.get_key`(event_map_values, 'item_name') AS value ) WHERE VALUE IS NOT NULL) AS event_props_2, ARRAY_CONCAT(ARRAY<STRING>[], (SELECT ARRAY_AGG( CASE WHEN key='pref_search_engine' THEN CONCAT('\"', 'pref_search_engine', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_privacy_turbo_mode' THEN CONCAT('\"', 'pref_privacy_turbo_mode', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key='pref_performance_block_images' THEN CONCAT('\"', 'pref_performance_block_images', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key='pref_default_browser' THEN CONCAT('\"', 'pref_default_browser', '\":', CAST(SAFE_CAST(value AS BOOLEAN) AS STRING)) WHEN key='pref_save_downloads_to' THEN CONCAT('\"', 'pref_save_downloads_to', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_webview_version' THEN CONCAT('\"', 'pref_webview_version', '\":\"', CAST(value AS STRING), '\"') WHEN key='install_referrer' THEN CONCAT('\"', 'install_referrer', '\":\"', CAST(value AS STRING), '\"') WHEN key='experiment_name' THEN CONCAT('\"', 'experiment_name', '\":\"', CAST(value AS STRING), '\"') WHEN key='experiment_bucket' THEN CONCAT('\"', 'experiment_bucket', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_locale' THEN CONCAT('\"', 'pref_locale', '\":\"', CAST(value AS STRING), '\"') WHEN key='pref_key_s_tracker_token' THEN CONCAT('\"', 'pref_key_s_tracker_token', '\":\"', CAST(value AS STRING), '\"') END IGNORE NULLS) FROM UNNEST(SETTINGS) )) AS user_props FROM all_events_with_insert_ids ) SELECT * EXCEPT (event_props_1, event_props_2, user_props, settings), CONCAT('{', ARRAY_TO_STRING(( SELECT ARRAY_AGG(DISTINCT e) FROM UNNEST(ARRAY_CONCAT(IFNULL(event_props_1, []), IFNULL(event_props_2, []))) AS e ), \",\"), '}') AS event_properties, CONCAT('{', ARRAY_TO_STRING(user_props, \",\"), '}') AS user_properties FROM extra_props","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#windows_10_aggregate","text":"","title":"windows_10_aggregate"},{"location":"moz-fx-data-shared-prod/telemetry/#view_92","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.windows_10_aggregate` AS WITH aggregated AS ( SELECT os AS name, os_version AS version, windows_build_number AS build_number, CAST(windows_ubr AS STRING) AS ubr, CASE WHEN windows_build_number <= 10240 THEN '1507' WHEN windows_build_number <= 10586 THEN '1511' WHEN windows_build_number <= 14393 THEN '1607' WHEN windows_build_number <= 15063 THEN '1703' WHEN windows_build_number <= 16299 THEN '1709' WHEN windows_build_number <= 17134 THEN '1803' WHEN windows_build_number <= 17763 THEN '1809' WHEN windows_build_number <= 18362 THEN '1903' WHEN windows_build_number <= 18363 THEN '1909' WHEN windows_build_number <= 19041 THEN '2004' WHEN windows_build_number <= 19042 THEN '20H2' WHEN windows_build_number > 19042 THEN 'Insider' ELSE NULL END AS build_group, SPLIT(app_version, \".\")[OFFSET(0)] AS ff_build_version, normalized_channel, COUNT(*) AS `count` FROM `moz-fx-data-shared-prod.telemetry.clients_daily` WHERE submission_date > DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AND os = 'Windows_NT' AND STARTS_WITH(os_version, '10') AND SAFE_CAST(SPLIT(app_version, \".\")[OFFSET(0)] AS INT64) >= 47 AND sample_id = 42 GROUP BY name, version, build_number, ubr, build_group, ff_build_version, normalized_channel), total AS ( SELECT SUM(count) total_obs FROM aggregated) SELECT * FROM aggregated CROSS JOIN total","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_anonymous_parquet_v1","text":"","title":"telemetry_anonymous_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_93","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_anonymous_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date_s3, STRUCT( document_id, UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, metadata.uri.app_build_id, metadata.uri.app_name, metadata.uri.app_update_channel, normalized_channel ) AS metadata, application, creation_date, id, payload, type, version FROM `moz-fx-data-shared-prod.telemetry.anonymous`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#sync","text":"","title":"sync"},{"location":"moz-fx-data-shared-prod/telemetry/#view_94","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.sync` AS SELECT * REPLACE( `moz-fx-data-shared-prod.udf.normalize_metadata`(metadata) AS metadata) FROM `moz-fx-data-shared-prod.telemetry_stable.sync_v4`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_cumulative_search_count","text":"","title":"experiment_cumulative_search_count"},{"location":"moz-fx-data-shared-prod/telemetry/#view_95","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_cumulative_search_count` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_cumulative_search_count_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#events","text":"","title":"events"},{"location":"moz-fx-data-shared-prod/telemetry/#view_96","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.events` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.events_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_cumulative_ad_clicks","text":"","title":"experiment_cumulative_ad_clicks"},{"location":"moz-fx-data-shared-prod/telemetry/#view_97","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_cumulative_ad_clicks` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_cumulative_ad_clicks_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#crash_summary_v2","text":"","title":"crash_summary_v2"},{"location":"moz-fx-data-shared-prod/telemetry/#view_98","text":"-- Query generated by: templates/unnest_parquet_view.sql.py crash_summary_v2 telemetry_derived.crash_summary_v2 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.crash_summary_v2` AS SELECT * REPLACE ( experiments.key_value AS experiments, (SELECT AS STRUCT payload.* REPLACE (payload.metadata.key_value AS metadata)) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_derived.crash_summary_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_heartbeat_parquet_v1","text":"","title":"telemetry_heartbeat_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_99","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_heartbeat_parquet_v1` AS SELECT DATE(submission_timestamp) AS submission_date_s3, DATE(submission_timestamp) AS submission_date, type, id, creation_date, version, client_id, application, (SELECT AS STRUCT payload.* replace (CAST(version AS int64) AS version)) AS payload, STRUCT( UNIX_MICROS(submission_timestamp) * 1000 AS `timestamp`, metadata.header.date AS `date`, IFNULL(metadata.geo.country, '??') AS geo_country, IFNULL(metadata.geo.city, '??') AS geo_city, document_id, metadata.uri.app_build_id, metadata.uri.app_name ) AS metadata, engagement_type FROM `moz-fx-data-shared-prod.telemetry.heartbeat`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#smoot_usage_day_13","text":"","title":"smoot_usage_day_13"},{"location":"moz-fx-data-shared-prod/telemetry/#view_100","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.smoot_usage_day_13` AS WITH unioned AS ( SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_desktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_nondesktop_v2` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.smoot_usage_fxa_v2` ) -- SELECT DATE_SUB(submission_date, INTERVAL 13 DAY) AS `date`, usage, metrics.day_13.*, * EXCEPT (submission_date, usage, metrics) FROM unioned","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#lockwise_mobile_events_v1","text":"","title":"lockwise_mobile_events_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_101","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.lockwise_mobile_events_v1` AS -- WITH android AS ( SELECT os, client_id, submission_date_s3, timestamp_seconds(cast(substr(cast(metadata.timestamp AS string), 1, 10) AS int64)) AS submission_timestamp, device, metadata.app_build_id, e.* FROM `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet_v2`, UNNEST(events) AS e WHERE metadata.app_name = 'Lockbox' AND os = 'Android' -- Filter out test data before the Android launch date. AND submission_date_s3 >= '2019-03-25' ), -- ios AS ( SELECT os, client_id, submission_date_s3, timestamp_seconds(cast(substr(cast(metadata.timestamp AS string), 1, 10) AS int64)) AS submission_timestamp, device, metadata.app_build_id, e.* FROM `moz-fx-data-shared-prod.telemetry.telemetry_focus_event_parquet_v1`, UNNEST(events) AS e WHERE metadata.app_name = 'Lockbox' AND os = 'iOS' -- Filter out test data before the iOS launch date. AND submission_date_s3 >= '2018-07-09' ) -- SELECT * FROM android UNION ALL SELECT * FROM ios","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_shield_study_parquet_v1","text":"","title":"telemetry_shield_study_parquet_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_102","text":"-- Query generated by: templates/unnest_parquet_view.sql.py telemetry_shield_study_parquet_v1 telemetry_derived.telemetry_shield_study_parquet_v1 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_shield_study_parquet_v1` AS SELECT submission_date AS submission, * REPLACE ( (SELECT AS STRUCT application.* REPLACE ((SELECT AS STRUCT application.addons.* REPLACE (application.addons.active_addons.key_value AS active_addons, application.addons.active_gmplugins.key_value AS active_gmplugins)) AS addons)) AS application, (SELECT AS STRUCT payload.* REPLACE ((SELECT AS STRUCT payload.data.* REPLACE (payload.data.attributes.key_value AS attributes)) AS data)) AS payload ) FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_shield_study_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28_by_product_v1","text":"","title":"firefox_nondesktop_exact_mau28_by_product_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_103","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_product_v1` AS SELECT submission_date, product, SUM(mau) AS mau, SUM(wau) AS wau, SUM(dau) AS dau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), mau, 0)) AS tier1_mau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), wau, 0)) AS tier1_wau, SUM(IF(country IN ('US', 'FR', 'DE', 'GB', 'CA'), dau, 0)) AS tier1_dau FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_dimensions_v1` GROUP BY submission_date, product","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_anonymous_parquet","text":"","title":"telemetry_anonymous_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_104","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_anonymous_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.telemetry_anonymous_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#events_v1","text":"","title":"events_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_105","text":"-- Creates a union view to provide continuity between legacy parquet events view and new -- all-gcp events tables CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.events_v1` AS WITH parquet_events AS ( SELECT * EXCEPT ( -- These are old fields that were removed in the parquet job but resurfaced in the BQ import e10s_enabled, e10s_cohort, subsession_start_date, subsession_length, sync_configured, sync_count_desktop, sync_count_mobile, active_experiment_id, active_experiment_branch ) REPLACE( event_map_values.key_value AS event_map_values, -- experiments struct in new events includes enrollment_id and type subfields ( SELECT ARRAY_AGG( STRUCT( e.key AS key, STRUCT( e.value AS branch, CAST(NULL AS string) AS enrollment_id, CAST(NULL AS string) AS `type` ) AS value ) ) FROM UNNEST(experiments.key_value) e ) AS experiments, -- Bug 1525620: fix inconsistencies in timestamp resolution for main vs event events CASE WHEN doc_type = 'main' THEN SAFE.TIMESTAMP_MICROS(CAST(`timestamp` / 1000 AS INT64)) ELSE SAFE.TIMESTAMP_SECONDS(`timestamp`) END AS `timestamp`, SAFE.TIMESTAMP_MILLIS(session_start_time) AS session_start_time ), CAST(NULL AS STRING) AS build_id FROM `moz-fx-data-shared-prod.telemetry_derived.events_v1` WHERE submission_date < '2019-10-31' ), main_events AS ( SELECT submission_date, 'main' AS doc_type, document_id, client_id, normalized_channel, country, locale, app_name, app_version, os, os_version, `timestamp`, sample_id, event_timestamp, event_category, event_method, event_object, event_string_value, event_map_values, experiments, event_process, subsession_id, session_start_time, session_id, build_id FROM `moz-fx-data-shared-prod`.telemetry_derived.main_events_v1 WHERE submission_date >= '2019-10-31' ), event_events AS ( SELECT submission_date, 'event' AS doc_type, document_id, client_id, normalized_channel, country, locale, app_name, app_version, os, os_version, `timestamp`, sample_id, event_timestamp, event_category, event_method, event_object, event_string_value, event_map_values, experiments, event_process, subsession_id, session_start_time, session_id, build_id FROM `moz-fx-data-shared-prod`.telemetry_derived.event_events_v1 WHERE submission_date >= '2019-10-31' ) SELECT * FROM parquet_events UNION ALL SELECT * FROM main_events UNION ALL SELECT * FROM event_events","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#ssl_ratios","text":"","title":"ssl_ratios"},{"location":"moz-fx-data-shared-prod/telemetry/#view_106","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.ssl_ratios` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.ssl_ratios_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#accessibility_clients","text":"","title":"accessibility_clients"},{"location":"moz-fx-data-shared-prod/telemetry/#view_107","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.accessibility_clients` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.accessibility_clients_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiment_enrollment_aggregates_hourly","text":"","title":"experiment_enrollment_aggregates_hourly"},{"location":"moz-fx-data-shared-prod/telemetry/#view_108","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiment_enrollment_aggregates_hourly` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.experiment_enrollment_aggregates_hourly_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_accounts_exact_mau28_by_dimensions","text":"","title":"firefox_accounts_exact_mau28_by_dimensions"},{"location":"moz-fx-data-shared-prod/telemetry/#view_109","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_nondesktop_exact_mau28_by_product","text":"","title":"firefox_nondesktop_exact_mau28_by_product"},{"location":"moz-fx-data-shared-prod/telemetry/#view_110","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_product` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_nondesktop_exact_mau28_by_product_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#first_shutdown_summary","text":"","title":"first_shutdown_summary"},{"location":"moz-fx-data-shared-prod/telemetry/#view_111","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.first_shutdown_summary` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.first_shutdown_summary_v4`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#main_nightly","text":"","title":"main_nightly"},{"location":"moz-fx-data-shared-prod/telemetry/#view_112","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.main_nightly` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.main_nightly_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_accounts_exact_mau28_by_dimensions_v1","text":"","title":"firefox_accounts_exact_mau28_by_dimensions_v1"},{"location":"moz-fx-data-shared-prod/telemetry/#view_113","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_accounts_exact_mau28_by_dimensions_v1` AS SELECT raw.* EXCEPT (mau_tier1_inclusive), -- We rename this column here to match the new standard of prefixing _mau -- with the usage criterion; we can refactor to have the correct name in -- the raw table the next time we need to make a change and backfill. mau_tier1_inclusive AS seen_in_tier1_country_mau, COALESCE(cn.code, raw.country) AS country_code FROM `moz-fx-data-shared-prod.firefox_accounts_derived.exact_mau28_v1` AS raw LEFT JOIN `moz-fx-data-shared-prod.static.country_names_v1` cn ON (raw.country = cn.name)","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_new_profile_parquet","text":"","title":"telemetry_new_profile_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_114","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_new_profile_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_new_profile_parquet_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#firefox_desktop_exact_mau28_by_dimensions","text":"","title":"firefox_desktop_exact_mau28_by_dimensions"},{"location":"moz-fx-data-shared-prod/telemetry/#view_115","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_dimensions` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.firefox_desktop_exact_mau28_by_dimensions_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#origin_content_blocking","text":"","title":"origin_content_blocking"},{"location":"moz-fx-data-shared-prod/telemetry/#view_116","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.origin_content_blocking` AS WITH most_recent AS ( SELECT * EXCEPT(_n) FROM ( SELECT *, ROW_NUMBER() OVER ( PARTITION BY submission_date, batch_id, origin ORDER BY TIMESTAMP DESC ) AS _n FROM `moz-fx-data-shared-prod.telemetry_derived.origin_content_blocking` ) WHERE _n = 1 ) SELECT submission_date, batch_id, origin, aggregate FROM most_recent","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#first_shutdown_summary_v4","text":"","title":"first_shutdown_summary_v4"},{"location":"moz-fx-data-shared-prod/telemetry/#view_117","text":"-- Query generated by: templates/unnest_parquet_view.sql.py first_shutdown_summary_v4 telemetry_derived.first_shutdown_summary_v4 CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.first_shutdown_summary_v4` AS SELECT submission_date AS submission_date_s3, * REPLACE ( ARRAY(SELECT * FROM UNNEST(active_addons.list)) AS active_addons, ARRAY(SELECT * FROM UNNEST(antispyware.list)) AS antispyware, ARRAY(SELECT * FROM UNNEST(antivirus.list)) AS antivirus, boolean_addon_scalars.key_value AS boolean_addon_scalars, ARRAY(SELECT * FROM UNNEST(disabled_addons_ids.list)) AS disabled_addons_ids, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_accept_languages.list) ) AS environment_settings_intl_accept_languages, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_app_locales.list) ) AS environment_settings_intl_app_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_available_locales.list) ) AS environment_settings_intl_available_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_regional_prefs_locales.list) ) AS environment_settings_intl_regional_prefs_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_requested_locales.list) ) AS environment_settings_intl_requested_locales, ARRAY( SELECT * FROM UNNEST(environment_settings_intl_system_locales.list) ) AS environment_settings_intl_system_locales, ARRAY( SELECT AS STRUCT _0.element.* REPLACE (_0.element.map_values.key_value AS map_values) FROM UNNEST(events.list) AS _0 ) AS events, experiments.key_value AS experiments, ARRAY(SELECT * FROM UNNEST(firewall.list)) AS firewall, histogram_content_a11y_consumers.key_value AS histogram_content_a11y_consumers, histogram_content_a11y_instantiated_flag.key_value AS histogram_content_a11y_instantiated_flag, histogram_content_cert_validation_success_by_ca.key_value AS histogram_content_cert_validation_success_by_ca, histogram_content_checkerboard_severity.key_value AS histogram_content_checkerboard_severity, histogram_content_composite_time.key_value AS histogram_content_composite_time, histogram_content_content_paint_time.key_value AS histogram_content_content_paint_time, histogram_content_cycle_collector_max_pause.key_value AS histogram_content_cycle_collector_max_pause, histogram_content_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_content_devtools_accessibility_picker_time_active_seconds, histogram_content_devtools_accessibility_service_time_active_seconds.key_value AS histogram_content_devtools_accessibility_service_time_active_seconds, histogram_content_devtools_accessibility_time_active_seconds.key_value AS histogram_content_devtools_accessibility_time_active_seconds, histogram_content_devtools_toolbox_time_active_seconds.key_value AS histogram_content_devtools_toolbox_time_active_seconds, histogram_content_fx_new_window_ms.key_value AS histogram_content_fx_new_window_ms, histogram_content_fx_page_load_ms_2.key_value AS histogram_content_fx_page_load_ms_2, histogram_content_fx_searchbar_selected_result_method.key_value AS histogram_content_fx_searchbar_selected_result_method, histogram_content_fx_session_restore_restore_window_ms.key_value AS histogram_content_fx_session_restore_restore_window_ms, histogram_content_fx_session_restore_startup_init_session_ms.key_value AS histogram_content_fx_session_restore_startup_init_session_ms, histogram_content_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_content_fx_session_restore_startup_onload_initial_window_ms, histogram_content_fx_tab_close_time_anim_ms.key_value AS histogram_content_fx_tab_close_time_anim_ms, histogram_content_fx_tab_switch_update_ms.key_value AS histogram_content_fx_tab_switch_update_ms, histogram_content_fx_urlbar_selected_result_index.key_value AS histogram_content_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_content_fx_urlbar_selected_result_index_by_type, histogram_content_fx_urlbar_selected_result_method.key_value AS histogram_content_fx_urlbar_selected_result_method, histogram_content_fx_urlbar_selected_result_type.key_value AS histogram_content_fx_urlbar_selected_result_type, histogram_content_gc_animation_ms.key_value AS histogram_content_gc_animation_ms, histogram_content_gc_max_pause_ms.key_value AS histogram_content_gc_max_pause_ms, histogram_content_gc_max_pause_ms_2.key_value AS histogram_content_gc_max_pause_ms_2, histogram_content_geolocation_request_granted.key_value AS histogram_content_geolocation_request_granted, histogram_content_ghost_windows.key_value AS histogram_content_ghost_windows, histogram_content_gpu_process_initialization_time_ms.key_value AS histogram_content_gpu_process_initialization_time_ms, histogram_content_gpu_process_launch_time_ms_2.key_value AS histogram_content_gpu_process_launch_time_ms_2, histogram_content_http_channel_disposition.key_value AS histogram_content_http_channel_disposition, histogram_content_http_pageload_is_ssl.key_value AS histogram_content_http_pageload_is_ssl, histogram_content_http_transaction_is_ssl.key_value AS histogram_content_http_transaction_is_ssl, histogram_content_input_event_response_coalesced_ms.key_value AS histogram_content_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_content_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_memory_distribution_among_content.key_value) AS _0 ) AS histogram_content_memory_distribution_among_content, histogram_content_memory_heap_allocated.key_value AS histogram_content_memory_heap_allocated, histogram_content_memory_resident_fast.key_value AS histogram_content_memory_resident_fast, histogram_content_memory_total.key_value AS histogram_content_memory_total, histogram_content_memory_unique.key_value AS histogram_content_memory_unique, histogram_content_memory_unique_content_startup.key_value AS histogram_content_memory_unique_content_startup, histogram_content_memory_vsize.key_value AS histogram_content_memory_vsize, histogram_content_memory_vsize_max_contiguous.key_value AS histogram_content_memory_vsize_max_contiguous, histogram_content_network_cache_metadata_first_read_time_ms.key_value AS histogram_content_network_cache_metadata_first_read_time_ms, histogram_content_network_cache_v2_hit_time_ms.key_value AS histogram_content_network_cache_v2_hit_time_ms, histogram_content_network_cache_v2_miss_time_ms.key_value AS histogram_content_network_cache_v2_miss_time_ms, histogram_content_places_autocomplete_6_first_results_time_ms.key_value AS histogram_content_places_autocomplete_6_first_results_time_ms, histogram_content_plugin_shutdown_ms.key_value AS histogram_content_plugin_shutdown_ms, histogram_content_pwmgr_form_autofill_result.key_value AS histogram_content_pwmgr_form_autofill_result, histogram_content_pwmgr_login_page_safety.key_value AS histogram_content_pwmgr_login_page_safety, histogram_content_sandbox_rejected_syscalls.key_value AS histogram_content_sandbox_rejected_syscalls, histogram_content_search_reset_result.key_value AS histogram_content_search_reset_result, histogram_content_search_service_init_ms.key_value AS histogram_content_search_service_init_ms, histogram_content_ssl_handshake_result.key_value AS histogram_content_ssl_handshake_result, histogram_content_ssl_handshake_version.key_value AS histogram_content_ssl_handshake_version, histogram_content_ssl_tls12_intolerance_reason_pre.key_value AS histogram_content_ssl_tls12_intolerance_reason_pre, histogram_content_ssl_tls13_intolerance_reason_pre.key_value AS histogram_content_ssl_tls13_intolerance_reason_pre, histogram_content_time_to_dom_complete_ms.key_value AS histogram_content_time_to_dom_complete_ms, histogram_content_time_to_dom_content_loaded_end_ms.key_value AS histogram_content_time_to_dom_content_loaded_end_ms, histogram_content_time_to_dom_content_loaded_start_ms.key_value AS histogram_content_time_to_dom_content_loaded_start_ms, histogram_content_time_to_dom_interactive_ms.key_value AS histogram_content_time_to_dom_interactive_ms, histogram_content_time_to_dom_loading_ms.key_value AS histogram_content_time_to_dom_loading_ms, histogram_content_time_to_first_click_ms.key_value AS histogram_content_time_to_first_click_ms, histogram_content_time_to_first_interaction_ms.key_value AS histogram_content_time_to_first_interaction_ms, histogram_content_time_to_first_key_input_ms.key_value AS histogram_content_time_to_first_key_input_ms, histogram_content_time_to_first_mouse_move_ms.key_value AS histogram_content_time_to_first_mouse_move_ms, histogram_content_time_to_first_scroll_ms.key_value AS histogram_content_time_to_first_scroll_ms, histogram_content_time_to_load_event_end_ms.key_value AS histogram_content_time_to_load_event_end_ms, histogram_content_time_to_load_event_start_ms.key_value AS histogram_content_time_to_load_event_start_ms, histogram_content_time_to_non_blank_paint_ms.key_value AS histogram_content_time_to_non_blank_paint_ms, histogram_content_time_to_response_start_ms.key_value AS histogram_content_time_to_response_start_ms, histogram_content_touch_enabled_device.key_value AS histogram_content_touch_enabled_device, histogram_content_tracking_protection_enabled.key_value AS histogram_content_tracking_protection_enabled, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_content_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_content_uptake_remote_content_result_1, histogram_content_webext_content_script_injection_ms.key_value AS histogram_content_webext_content_script_injection_ms, histogram_content_webext_storage_local_get_ms.key_value AS histogram_content_webext_storage_local_get_ms, histogram_content_webext_storage_local_set_ms.key_value AS histogram_content_webext_storage_local_set_ms, histogram_content_webvr_time_spent_viewing_in_2d.key_value AS histogram_content_webvr_time_spent_viewing_in_2d, histogram_content_webvr_users_view_in.key_value AS histogram_content_webvr_users_view_in, histogram_gpu_a11y_consumers.key_value AS histogram_gpu_a11y_consumers, histogram_gpu_a11y_instantiated_flag.key_value AS histogram_gpu_a11y_instantiated_flag, histogram_gpu_cert_validation_success_by_ca.key_value AS histogram_gpu_cert_validation_success_by_ca, histogram_gpu_checkerboard_severity.key_value AS histogram_gpu_checkerboard_severity, histogram_gpu_composite_time.key_value AS histogram_gpu_composite_time, histogram_gpu_content_frame_time.key_value AS histogram_gpu_content_frame_time, histogram_gpu_cycle_collector_max_pause.key_value AS histogram_gpu_cycle_collector_max_pause, histogram_gpu_fx_urlbar_selected_result_index.key_value AS histogram_gpu_fx_urlbar_selected_result_index, histogram_gpu_fx_urlbar_selected_result_type.key_value AS histogram_gpu_fx_urlbar_selected_result_type, histogram_gpu_gc_max_pause_ms.key_value AS histogram_gpu_gc_max_pause_ms, histogram_gpu_ghost_windows.key_value AS histogram_gpu_ghost_windows, histogram_gpu_gpu_process_initialization_time_ms.key_value AS histogram_gpu_gpu_process_initialization_time_ms, histogram_gpu_http_channel_disposition.key_value AS histogram_gpu_http_channel_disposition, histogram_gpu_http_pageload_is_ssl.key_value AS histogram_gpu_http_pageload_is_ssl, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_gpu_ipc_read_main_thread_latency_ms, histogram_gpu_search_reset_result.key_value AS histogram_gpu_search_reset_result, histogram_gpu_ssl_handshake_result.key_value AS histogram_gpu_ssl_handshake_result, histogram_gpu_ssl_handshake_version.key_value AS histogram_gpu_ssl_handshake_version, histogram_gpu_ssl_tls12_intolerance_reason_pre.key_value AS histogram_gpu_ssl_tls12_intolerance_reason_pre, histogram_gpu_ssl_tls13_intolerance_reason_pre.key_value AS histogram_gpu_ssl_tls13_intolerance_reason_pre, histogram_gpu_time_to_first_click_ms.key_value AS histogram_gpu_time_to_first_click_ms, histogram_gpu_time_to_first_interaction_ms.key_value AS histogram_gpu_time_to_first_interaction_ms, histogram_gpu_time_to_first_key_input_ms.key_value AS histogram_gpu_time_to_first_key_input_ms, histogram_gpu_time_to_first_mouse_move_ms.key_value AS histogram_gpu_time_to_first_mouse_move_ms, histogram_gpu_time_to_first_scroll_ms.key_value AS histogram_gpu_time_to_first_scroll_ms, histogram_gpu_time_to_non_blank_paint_ms.key_value AS histogram_gpu_time_to_non_blank_paint_ms, histogram_gpu_touch_enabled_device.key_value AS histogram_gpu_touch_enabled_device, histogram_gpu_tracking_protection_enabled.key_value AS histogram_gpu_tracking_protection_enabled, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_gpu_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_gpu_uptake_remote_content_result_1, histogram_gpu_webvr_time_spent_viewing_in_oculus.key_value AS histogram_gpu_webvr_time_spent_viewing_in_oculus, histogram_gpu_webvr_time_spent_viewing_in_openvr.key_value AS histogram_gpu_webvr_time_spent_viewing_in_openvr, histogram_gpu_webvr_users_view_in.key_value AS histogram_gpu_webvr_users_view_in, histogram_parent_a11y_consumers.key_value AS histogram_parent_a11y_consumers, histogram_parent_a11y_instantiated_flag.key_value AS histogram_parent_a11y_instantiated_flag, histogram_parent_cert_validation_success_by_ca.key_value AS histogram_parent_cert_validation_success_by_ca, histogram_parent_checkerboard_severity.key_value AS histogram_parent_checkerboard_severity, histogram_parent_composite_time.key_value AS histogram_parent_composite_time, histogram_parent_content_frame_time.key_value AS histogram_parent_content_frame_time, histogram_parent_content_paint_time.key_value AS histogram_parent_content_paint_time, histogram_parent_cookie_behavior.key_value AS histogram_parent_cookie_behavior, histogram_parent_cycle_collector_max_pause.key_value AS histogram_parent_cycle_collector_max_pause, histogram_parent_devtools_about_devtools_opened_key.key_value AS histogram_parent_devtools_about_devtools_opened_key, histogram_parent_devtools_about_devtools_opened_reason.key_value AS histogram_parent_devtools_about_devtools_opened_reason, histogram_parent_devtools_accessibility_picker_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_picker_time_active_seconds, histogram_parent_devtools_accessibility_service_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_service_time_active_seconds, histogram_parent_devtools_accessibility_time_active_seconds.key_value AS histogram_parent_devtools_accessibility_time_active_seconds, histogram_parent_devtools_entry_point.key_value AS histogram_parent_devtools_entry_point, histogram_parent_devtools_fonteditor_font_type_displayed.key_value AS histogram_parent_devtools_fonteditor_font_type_displayed, histogram_parent_devtools_fonteditor_n_font_axes.key_value AS histogram_parent_devtools_fonteditor_n_font_axes, histogram_parent_devtools_fonteditor_n_fonts_rendered.key_value AS histogram_parent_devtools_fonteditor_n_fonts_rendered, histogram_parent_devtools_toolbox_time_active_seconds.key_value AS histogram_parent_devtools_toolbox_time_active_seconds, histogram_parent_dns_failed_lookup_time.key_value AS histogram_parent_dns_failed_lookup_time, histogram_parent_dns_lookup_time.key_value AS histogram_parent_dns_lookup_time, histogram_parent_fx_new_window_ms.key_value AS histogram_parent_fx_new_window_ms, histogram_parent_fx_page_load_ms_2.key_value AS histogram_parent_fx_page_load_ms_2, histogram_parent_fx_searchbar_selected_result_method.key_value AS histogram_parent_fx_searchbar_selected_result_method, histogram_parent_fx_session_restore_restore_window_ms.key_value AS histogram_parent_fx_session_restore_restore_window_ms, histogram_parent_fx_session_restore_startup_init_session_ms.key_value AS histogram_parent_fx_session_restore_startup_init_session_ms, histogram_parent_fx_session_restore_startup_onload_initial_window_ms.key_value AS histogram_parent_fx_session_restore_startup_onload_initial_window_ms, histogram_parent_fx_tab_close_time_anim_ms.key_value AS histogram_parent_fx_tab_close_time_anim_ms, histogram_parent_fx_tab_switch_total_e10s_ms.key_value AS histogram_parent_fx_tab_switch_total_e10s_ms, histogram_parent_fx_tab_switch_update_ms.key_value AS histogram_parent_fx_tab_switch_update_ms, histogram_parent_fx_urlbar_selected_result_index.key_value AS histogram_parent_fx_urlbar_selected_result_index, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_fx_urlbar_selected_result_index_by_type.key_value) AS _0 ) AS histogram_parent_fx_urlbar_selected_result_index_by_type, histogram_parent_fx_urlbar_selected_result_method.key_value AS histogram_parent_fx_urlbar_selected_result_method, histogram_parent_fx_urlbar_selected_result_type.key_value AS histogram_parent_fx_urlbar_selected_result_type, histogram_parent_gc_animation_ms.key_value AS histogram_parent_gc_animation_ms, histogram_parent_gc_max_pause_ms.key_value AS histogram_parent_gc_max_pause_ms, histogram_parent_gc_max_pause_ms_2.key_value AS histogram_parent_gc_max_pause_ms_2, histogram_parent_geolocation_request_granted.key_value AS histogram_parent_geolocation_request_granted, histogram_parent_ghost_windows.key_value AS histogram_parent_ghost_windows, histogram_parent_gpu_process_initialization_time_ms.key_value AS histogram_parent_gpu_process_initialization_time_ms, histogram_parent_gpu_process_launch_time_ms_2.key_value AS histogram_parent_gpu_process_launch_time_ms_2, histogram_parent_http_channel_disposition.key_value AS histogram_parent_http_channel_disposition, histogram_parent_http_pageload_is_ssl.key_value AS histogram_parent_http_pageload_is_ssl, histogram_parent_http_transaction_is_ssl.key_value AS histogram_parent_http_transaction_is_ssl, histogram_parent_input_event_response_coalesced_ms.key_value AS histogram_parent_input_event_response_coalesced_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_ipc_read_main_thread_latency_ms.key_value) AS _0 ) AS histogram_parent_ipc_read_main_thread_latency_ms, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_memory_distribution_among_content.key_value) AS _0 ) AS histogram_parent_memory_distribution_among_content, histogram_parent_memory_heap_allocated.key_value AS histogram_parent_memory_heap_allocated, histogram_parent_memory_resident_fast.key_value AS histogram_parent_memory_resident_fast, histogram_parent_memory_total.key_value AS histogram_parent_memory_total, histogram_parent_memory_unique.key_value AS histogram_parent_memory_unique, histogram_parent_memory_vsize.key_value AS histogram_parent_memory_vsize, histogram_parent_memory_vsize_max_contiguous.key_value AS histogram_parent_memory_vsize_max_contiguous, histogram_parent_network_cache_metadata_first_read_time_ms.key_value AS histogram_parent_network_cache_metadata_first_read_time_ms, histogram_parent_network_cache_v2_hit_time_ms.key_value AS histogram_parent_network_cache_v2_hit_time_ms, histogram_parent_network_cache_v2_miss_time_ms.key_value AS histogram_parent_network_cache_v2_miss_time_ms, histogram_parent_places_autocomplete_6_first_results_time_ms.key_value AS histogram_parent_places_autocomplete_6_first_results_time_ms, histogram_parent_plugin_shutdown_ms.key_value AS histogram_parent_plugin_shutdown_ms, histogram_parent_pwmgr_blocklist_num_sites.key_value AS histogram_parent_pwmgr_blocklist_num_sites, histogram_parent_pwmgr_form_autofill_result.key_value AS histogram_parent_pwmgr_form_autofill_result, histogram_parent_pwmgr_login_last_used_days.key_value AS histogram_parent_pwmgr_login_last_used_days, histogram_parent_pwmgr_login_page_safety.key_value AS histogram_parent_pwmgr_login_page_safety, histogram_parent_pwmgr_manage_opened.key_value AS histogram_parent_pwmgr_manage_opened, histogram_parent_pwmgr_manage_visibility_toggled.key_value AS histogram_parent_pwmgr_manage_visibility_toggled, histogram_parent_pwmgr_num_passwords_per_hostname.key_value AS histogram_parent_pwmgr_num_passwords_per_hostname, histogram_parent_pwmgr_num_saved_passwords.key_value AS histogram_parent_pwmgr_num_saved_passwords, histogram_parent_pwmgr_prompt_remember_action.key_value AS histogram_parent_pwmgr_prompt_remember_action, histogram_parent_pwmgr_prompt_update_action.key_value AS histogram_parent_pwmgr_prompt_update_action, histogram_parent_pwmgr_saving_enabled.key_value AS histogram_parent_pwmgr_saving_enabled, histogram_parent_sandbox_rejected_syscalls.key_value AS histogram_parent_sandbox_rejected_syscalls, histogram_parent_search_reset_result.key_value AS histogram_parent_search_reset_result, histogram_parent_search_service_init_ms.key_value AS histogram_parent_search_service_init_ms, histogram_parent_ssl_handshake_result.key_value AS histogram_parent_ssl_handshake_result, histogram_parent_ssl_handshake_version.key_value AS histogram_parent_ssl_handshake_version, histogram_parent_ssl_tls12_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls12_intolerance_reason_pre, histogram_parent_ssl_tls13_intolerance_reason_pre.key_value AS histogram_parent_ssl_tls13_intolerance_reason_pre, histogram_parent_time_to_first_click_ms.key_value AS histogram_parent_time_to_first_click_ms, histogram_parent_time_to_first_interaction_ms.key_value AS histogram_parent_time_to_first_interaction_ms, histogram_parent_time_to_first_key_input_ms.key_value AS histogram_parent_time_to_first_key_input_ms, histogram_parent_time_to_first_mouse_move_ms.key_value AS histogram_parent_time_to_first_mouse_move_ms, histogram_parent_time_to_first_scroll_ms.key_value AS histogram_parent_time_to_first_scroll_ms, histogram_parent_time_to_non_blank_paint_ms.key_value AS histogram_parent_time_to_non_blank_paint_ms, histogram_parent_time_to_response_start_ms.key_value AS histogram_parent_time_to_response_start_ms, histogram_parent_touch_enabled_device.key_value AS histogram_parent_touch_enabled_device, histogram_parent_tracking_protection_enabled.key_value AS histogram_parent_tracking_protection_enabled, histogram_parent_update_bits_result_complete.key_value AS histogram_parent_update_bits_result_complete, histogram_parent_update_bits_result_partial.key_value AS histogram_parent_update_bits_result_partial, histogram_parent_update_can_use_bits_notify.key_value AS histogram_parent_update_can_use_bits_notify, histogram_parent_update_download_code_complete.key_value AS histogram_parent_update_download_code_complete, histogram_parent_update_download_code_partial.key_value AS histogram_parent_update_download_code_partial, histogram_parent_update_state_code_complete_stage.key_value AS histogram_parent_update_state_code_complete_stage, histogram_parent_update_state_code_complete_startup.key_value AS histogram_parent_update_state_code_complete_startup, histogram_parent_update_state_code_partial_stage.key_value AS histogram_parent_update_state_code_partial_stage, histogram_parent_update_state_code_partial_startup.key_value AS histogram_parent_update_state_code_partial_startup, histogram_parent_update_status_error_code_complete_stage.key_value AS histogram_parent_update_status_error_code_complete_stage, histogram_parent_update_status_error_code_complete_startup.key_value AS histogram_parent_update_status_error_code_complete_startup, histogram_parent_update_status_error_code_partial_stage.key_value AS histogram_parent_update_status_error_code_partial_stage, histogram_parent_update_status_error_code_partial_startup.key_value AS histogram_parent_update_status_error_code_partial_startup, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(histogram_parent_uptake_remote_content_result_1.key_value) AS _0 ) AS histogram_parent_uptake_remote_content_result_1, histogram_parent_webext_background_page_load_ms.key_value AS histogram_parent_webext_background_page_load_ms, histogram_parent_webext_browseraction_popup_open_ms.key_value AS histogram_parent_webext_browseraction_popup_open_ms, histogram_parent_webext_browseraction_popup_preload_result_count.key_value AS histogram_parent_webext_browseraction_popup_preload_result_count, histogram_parent_webext_content_script_injection_ms.key_value AS histogram_parent_webext_content_script_injection_ms, histogram_parent_webext_extension_startup_ms.key_value AS histogram_parent_webext_extension_startup_ms, histogram_parent_webext_pageaction_popup_open_ms.key_value AS histogram_parent_webext_pageaction_popup_open_ms, histogram_parent_webext_storage_local_get_ms.key_value AS histogram_parent_webext_storage_local_get_ms, histogram_parent_webext_storage_local_set_ms.key_value AS histogram_parent_webext_storage_local_set_ms, histogram_parent_webvr_time_spent_viewing_in_2d.key_value AS histogram_parent_webvr_time_spent_viewing_in_2d, histogram_parent_webvr_time_spent_viewing_in_oculus.key_value AS histogram_parent_webvr_time_spent_viewing_in_oculus, histogram_parent_webvr_time_spent_viewing_in_openvr.key_value AS histogram_parent_webvr_time_spent_viewing_in_openvr, histogram_parent_webvr_users_view_in.key_value AS histogram_parent_webvr_users_view_in, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_boolean_addon_scalars.key_value) AS _0 ) AS keyed_boolean_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_string_addon_scalars.key_value) AS _0 ) AS keyed_string_addon_scalars, ARRAY( SELECT AS STRUCT * REPLACE (_0.value.key_value AS value) FROM UNNEST(keyed_uint_addon_scalars.key_value) AS _0 ) AS keyed_uint_addon_scalars, popup_notification_stats.key_value AS popup_notification_stats, scalar_content_dom_event_confluence_load_count.key_value AS scalar_content_dom_event_confluence_load_count, scalar_content_dom_event_office_online_load_count.key_value AS scalar_content_dom_event_office_online_load_count, scalar_content_gfx_small_paint_phase_weight.key_value AS scalar_content_gfx_small_paint_phase_weight, scalar_content_images_webp_content_frequency.key_value AS scalar_content_images_webp_content_frequency, scalar_content_pictureinpicture_opened_method.key_value AS scalar_content_pictureinpicture_opened_method, scalar_content_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_content_telemetry_accumulate_unknown_histogram_keys, scalar_content_telemetry_event_counts.key_value AS scalar_content_telemetry_event_counts, scalar_content_webrtc_sdp_parser_diff.key_value AS scalar_content_webrtc_sdp_parser_diff, scalar_content_webrtc_video_recv_codec_used.key_value AS scalar_content_webrtc_video_recv_codec_used, scalar_content_webrtc_video_send_codec_used.key_value AS scalar_content_webrtc_video_send_codec_used, scalar_gpu_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_gpu_telemetry_accumulate_unknown_histogram_keys, scalar_gpu_telemetry_event_counts.key_value AS scalar_gpu_telemetry_event_counts, scalar_parent_a11y_theme.key_value AS scalar_parent_a11y_theme, scalar_parent_browser_engagement_navigation_about_home.key_value AS scalar_parent_browser_engagement_navigation_about_home, scalar_parent_browser_engagement_navigation_about_newtab.key_value AS scalar_parent_browser_engagement_navigation_about_newtab, scalar_parent_browser_engagement_navigation_contextmenu.key_value AS scalar_parent_browser_engagement_navigation_contextmenu, scalar_parent_browser_engagement_navigation_searchbar.key_value AS scalar_parent_browser_engagement_navigation_searchbar, scalar_parent_browser_engagement_navigation_urlbar.key_value AS scalar_parent_browser_engagement_navigation_urlbar, scalar_parent_browser_engagement_navigation_webextension.key_value AS scalar_parent_browser_engagement_navigation_webextension, scalar_parent_browser_errors_collected_count_by_filename.key_value AS scalar_parent_browser_errors_collected_count_by_filename, scalar_parent_browser_search_ad_clicks.key_value AS scalar_parent_browser_search_ad_clicks, scalar_parent_browser_search_with_ads.key_value AS scalar_parent_browser_search_with_ads, scalar_parent_devtools_accessibility_accessible_context_menu_item_activated.key_value AS scalar_parent_devtools_accessibility_accessible_context_menu_item_activated, scalar_parent_devtools_accessibility_audit_activated.key_value AS scalar_parent_devtools_accessibility_audit_activated, scalar_parent_devtools_accessibility_select_accessible_for_node.key_value AS scalar_parent_devtools_accessibility_select_accessible_for_node, scalar_parent_devtools_current_theme.key_value AS scalar_parent_devtools_current_theme, scalar_parent_devtools_inspector_three_pane_enabled.key_value AS scalar_parent_devtools_inspector_three_pane_enabled, scalar_parent_devtools_responsive_open_trigger.key_value AS scalar_parent_devtools_responsive_open_trigger, scalar_parent_devtools_tool_registered.key_value AS scalar_parent_devtools_tool_registered, scalar_parent_devtools_toolbox_tabs_reordered.key_value AS scalar_parent_devtools_toolbox_tabs_reordered, scalar_parent_devtools_tooltip_shown.key_value AS scalar_parent_devtools_tooltip_shown, scalar_parent_extensions_updates_rdf.key_value AS scalar_parent_extensions_updates_rdf, scalar_parent_gfx_advanced_layers_failure_id.key_value AS scalar_parent_gfx_advanced_layers_failure_id, scalar_parent_images_webp_content_frequency.key_value AS scalar_parent_images_webp_content_frequency, scalar_parent_networking_data_transferred.key_value AS scalar_parent_networking_data_transferred, scalar_parent_networking_data_transferred_kb.key_value AS scalar_parent_networking_data_transferred_kb, scalar_parent_networking_data_transferred_v3_kb.key_value AS scalar_parent_networking_data_transferred_v3_kb, scalar_parent_normandy_recipe_freshness.key_value AS scalar_parent_normandy_recipe_freshness, scalar_parent_pictureinpicture_closed_method.key_value AS scalar_parent_pictureinpicture_closed_method, scalar_parent_preferences_browser_home_page_change.key_value AS scalar_parent_preferences_browser_home_page_change, scalar_parent_preferences_browser_home_page_count.key_value AS scalar_parent_preferences_browser_home_page_count, scalar_parent_preferences_search_query.key_value AS scalar_parent_preferences_search_query, scalar_parent_preferences_use_bookmark.key_value AS scalar_parent_preferences_use_bookmark, scalar_parent_preferences_use_current_page.key_value AS scalar_parent_preferences_use_current_page, scalar_parent_qm_origin_directory_unexpected_filename.key_value AS scalar_parent_qm_origin_directory_unexpected_filename, scalar_parent_resistfingerprinting_content_window_size.key_value AS scalar_parent_resistfingerprinting_content_window_size, scalar_parent_sandbox_no_job.key_value AS scalar_parent_sandbox_no_job, scalar_parent_security_client_cert.key_value AS scalar_parent_security_client_cert, scalar_parent_security_pkcs11_modules_loaded.key_value AS scalar_parent_security_pkcs11_modules_loaded, scalar_parent_security_webauthn_used.key_value AS scalar_parent_security_webauthn_used, scalar_parent_services_sync_sync_login_state_transitions.key_value AS scalar_parent_services_sync_sync_login_state_transitions, scalar_parent_storage_sync_api_usage_items_stored.key_value AS scalar_parent_storage_sync_api_usage_items_stored, scalar_parent_storage_sync_api_usage_storage_consumed.key_value AS scalar_parent_storage_sync_api_usage_storage_consumed, scalar_parent_telemetry_accumulate_clamped_values.key_value AS scalar_parent_telemetry_accumulate_clamped_values, scalar_parent_telemetry_accumulate_unknown_histogram_keys.key_value AS scalar_parent_telemetry_accumulate_unknown_histogram_keys, scalar_parent_telemetry_event_counts.key_value AS scalar_parent_telemetry_event_counts, scalar_parent_telemetry_keyed_scalars_exceed_limit.key_value AS scalar_parent_telemetry_keyed_scalars_exceed_limit, scalar_parent_update_binarytransparencyresult.key_value AS scalar_parent_update_binarytransparencyresult, scalar_parent_update_bitshresult.key_value AS scalar_parent_update_bitshresult, scalar_parent_widget_ime_name_on_linux.key_value AS scalar_parent_widget_ime_name_on_linux, scalar_parent_widget_ime_name_on_mac.key_value AS scalar_parent_widget_ime_name_on_mac, scalar_parent_widget_ime_name_on_windows.key_value AS scalar_parent_widget_ime_name_on_windows, ARRAY(SELECT * FROM UNNEST(search_counts.list)) AS search_counts, ssl_handshake_result.key_value AS ssl_handshake_result, string_addon_scalars.key_value AS string_addon_scalars, uint_addon_scalars.key_value AS uint_addon_scalars ) FROM `moz-fx-data-shared-prod.telemetry_derived.first_shutdown_summary_v4`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#telemetry_mobile_event_parquet","text":"","title":"telemetry_mobile_event_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_118","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.telemetry_mobile_event_parquet_v2`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#simpleprophet_forecasts","text":"","title":"simpleprophet_forecasts"},{"location":"moz-fx-data-shared-prod/telemetry/#view_119","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.simpleprophet_forecasts` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.simpleprophet_forecasts_desktop_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.simpleprophet_forecasts_mobile_v1` UNION ALL SELECT * FROM `moz-fx-data-shared-prod.telemetry_derived.simpleprophet_forecasts_fxa_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#eng_workflow_build_parquet","text":"","title":"eng_workflow_build_parquet"},{"location":"moz-fx-data-shared-prod/telemetry/#view_120","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.eng_workflow_build_parquet` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.eng_workflow_build_parquet_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/telemetry/#experiments_aggregates","text":"","title":"experiments_aggregates"},{"location":"moz-fx-data-shared-prod/telemetry/#view_121","text":"CREATE OR REPLACE VIEW `moz-fx-data-shared-prod.telemetry.experiments_aggregates` AS SELECT * FROM `moz-fx-data-shared-prod.telemetry.experiments_aggregates_v1`","title":"View"},{"location":"moz-fx-data-shared-prod/udf/","text":"days_since_created_profile_as_28_bits Metadata Description : Takes in a difference between submission date and profile creation date and returns a bit pattern representing the profile creation date IFF the profile date is the same as the submission date or no more than 6 days earlier. Analysis has shown that client-reported profile creation dates are much less reliable outside of this range and cannot be used as reliable indicators of new profile creation. Friendly name : Days Since Created Profile As 28 Bits active_values_from_days_seen_map Metadata Description : Given a map of representing activity for STRING key s, this function returns an array of which key s were active for the time period in question. start_offset should be at most 0. n_bits should be at most the remaining bits. Friendly name : Active Values From Days Seen Map parquet_array_sum Metadata Description : Sum an array from a parquet-derived field. These are lists of an element that contain the field value. Friendly name : Parquet Array Sum coalesce_adjacent_days_28_bits Metadata Description : We generally want to believe only the first reasonable profile creation date that we receive from a client. Given bits representing usage from the previous day and the current day, this function shifts the first argument by one day and returns either that value if non-zero and non-null, the current day value if non-zero and non-null, or else 0. Friendly name : Coalesce Adjacent Days 28 Bits json_mode_last Metadata Description : Friendly name : Json Mode Last bits_to_days_since_seen Metadata Description : Given a BYTES, return the number of days since the client was last seen. If no bits are set, returns NULL, indicating we don't know. Otherwise the results are 0-indexed, meaning \\x01 will return 0. Tests showed this being 5-10x faster than the simpler alternative: CREATE OR REPLACE FUNCTION udf.bits_to_days_since_seen(b BYTES) AS (( SELECT MIN(n) FROM UNNEST(GENERATE_ARRAY(0, 364)) AS n WHERE BIT_COUNT(SUBSTR(b >> n, -1) & b'\\x01') > 0)); See also: bits_to_days_since_first_seen.sql Friendly name : Bits To Days Since Seen bits28_days_since_seen Metadata Description : Friendly name : Bits28 Days Since Seen histogram_to_mean Metadata Description : Friendly name : Histogram To Mean glean_timespan_nanos Metadata Description : Friendly name : Glean Timespan Nanos null_if_empty_list Metadata Description : Return NULL if list is empty, otherwise return list. This cannot be done with NULLIF because NULLIF does not support arrays. Friendly name : Null If Empty List country_code_to_flag Metadata Description : For a given two-letter ISO 3166-1 alpha-2 country code, returns a string consisting of two Unicode regional indicator symbols, which is rendered in supporting fonts (such as in the BigQuery console or STMO) as flag emoji. This is just for fun. See: - https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2 - https://en.wikipedia.org/wiki/Regional_Indicator_Symbol Friendly name : Country Code To Flag add_searches_by_index Metadata Description : Return sums of each search type grouped by the index. Results are ordered by index. Friendly name : Add Searches By Index array_of_12_zeroes Metadata Description : An array of 12 zeroes Friendly name : Array Of 12 Zeroes new_monthly_engine_searches_struct Metadata Description : This struct represents the past year's worth of searches. Each month has its own entry, hence 12. Friendly name : New Monthly Engine Searches Struct normalize_metadata Metadata Description : Friendly name : Normalize Metadata pos_of_leading_set_bit Metadata Description : Returns the 0-based index of the first set bit. No set bits returns NULL. Friendly name : Pos Of Leading Set Bit shift_28_bits_one_day Metadata Description : Shift input bits one day left and drop any bits beyond 28 days. Friendly name : Shift 28 Bits One Day bits28_to_string Metadata Description : Friendly name : Bits28 To String kv_array_append_to_json_string Metadata Description : Returns a JSON string which has the pair appended to the provided input JSON string. NULL is also valid for input . Examples: udf.kv_array_append_to_json_string('{\"foo\":\"bar\"}', [STRUCT(\"baz\" AS key, \"boo\" AS value)]) '{\"foo\":\"bar\",\"baz\":\"boo\"}' udf.kv_array_append_to_json_string('{}', [STRUCT(\"baz\" AS key, \"boo\" AS value)]) '{\"baz\": \"boo\"}' Friendly name : Kv Array Append To Json String combine_experiment_days Metadata Description : The \"clients_last_seen\" class of tables represent various types of client activity within a 28-day window as bit patterns. This function takes in two arrays of structs where each entry gives the bit pattern for days in which we saw a ping for a given user in a given experiment. We combine the bit patterns for the previous day and the current day, returning a single array of experiment structs. Friendly name : Combine Experiment Days normalize_glean_ping_info Metadata Description : Friendly name : Normalize Glean Ping Info shift_one_day Metadata Description : Returns the bitfield shifted by one day, 0 for NULL Friendly name : Shift One Day bits_to_days_seen Metadata Description : Given a BYTE, get the number of days the user was seen. NULL input returns NULL output. Friendly name : Bits To Days Seen bitcount_lowest_7 Metadata Description : This function counts the 1s in lowest 7 bits of an INT64 Friendly name : Bitcount Lowest 7 bits28_range Metadata Description : Friendly name : Bits28 Range histogram_to_threshold_count Metadata Description : Friendly name : Histogram To Threshold Count get_key_with_null Metadata Description : Friendly name : Get Key With Null normalize_os Metadata Description : Friendly name : Normalize Os active_n_weeks_ago Metadata Description : Friendly name : Active N Weeks Ago main_summary_scalars Metadata Description : Friendly name : Main Summary Scalars histogram_max_key_with_nonzero_value Metadata Description : Find the largest numeric bucket that contains a value greater than zero. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L253-L266 Friendly name : Histogram Max Key With Nonzero Value aggregate_map_first Metadata Description : Returns an aggregated map with all the keys and the first corresponding value from the given maps Friendly name : Aggregate Map First bits28_to_dates Metadata Description : Friendly name : Bits28 To Dates vector_add Metadata Description : This function adds two vectors. The two vectors can have different length. If one vector is null, the other vector will be returned directly. Friendly name : Vector Add keyed_histogram_get_sum Metadata Description : Take a keyed histogram of type STRUCT , extract the histogram of the given key, and return the sum value Friendly name : Keyed Histogram Get Sum round_timestamp_to_minute Metadata Description : Floor a timestamp object to the given minute interval. Friendly name : Round Timestamp To Minute add_monthly_searches Metadata Description : Adds together two engine searches structs. Each engine searches struct has a MAP[engine -> search_counts_struct]. We want to add add together the prev and curr's values for a certain engine. This allows us to be flexible with the number of engines we're using. Friendly name : Add Monthly Searches map_sum Metadata Description : Friendly name : Map Sum int_to_365_bits Metadata Description : Friendly name : Int To 365 Bits decode_int64 Metadata Description : Friendly name : Decode Int64 smoot_usage_from_28_bits Metadata Description : Calculates a variety of metrics based on bit patterns of daily usage for the smoot_usage_* tables. Friendly name : Smoot Usage From 28 Bits extract_count_histogram_value Metadata Description : Friendly name : Extract Count Histogram Value array_slice Metadata Description : Friendly name : Array Slice dedupe_array Metadata Description : Return an array containing only distinct values of the given array Friendly name : Dedupe Array histogram_merge Metadata Description : Friendly name : Histogram Merge mode_last_retain_nulls Metadata Description : Friendly name : Mode Last Retain Nulls bits_to_active_n_weeks_ago Metadata Description : Given a BYTE and an INT64, return whether the user was active that many weeks ago. NULL input returns NULL output. Friendly name : Bits To Active N Weeks Ago event_code_points_to_string days_seen_bytes_to_rfm Metadata Description : Return the frequency, recency, and T from a BYTE array, as defined in https://lifetimes.readthedocs.io/en/latest/Quickstart.html#the-shape-of-your-data RFM refers to Recency, Frequency, and Monetary value. Friendly name : Days Seen Bytes To Rfm bits28_active_in_range Metadata Description : Friendly name : Bits28 Active In Range mode_last Metadata Description : Friendly name : Mode Last geo_struct Metadata Description : Convert geoip lookup fields to a struct, replacing '??' with NULL. Returns NULL if if required field country would be NULL. Replaces '??' with NULL because '??' is a placeholder that may be used if there was an issue during geoip lookup in hindsight. Friendly name : Geo Struct aggregate_search_map Metadata Description : Aggregates the total counts of the given search counters Friendly name : Aggregate Search Map quantile_search_metric_contribution Metadata Description : This function returns how much of one metric is contributed by the quantile of another metric. Quantile variable should add an offset to get the requried percentile value. Example: udf.quantile_search_metric_contribution(sap, search_with_ads, sap_percentiles[OFFSET(9)]) It returns search_with_ads if sap value in top 10% volumn else null. Friendly name : Quantile Search Metric Contribution array_11_zeroes_then Metadata Description : An array of 11 zeroes, followed by a supplied value Friendly name : Array 11 Zeroes Then aggregate_active_addons Metadata Description : This function selects most frequently occuring value for each addon_id, using the latest value in the input among ties. The type for active_addons is ARRAY >, i.e. the output of SELECT ARRAY_CONCAT_AGG(active_addons) FROM telemetry.main_summary_v4 , and is left unspecified to allow changes to the fields of the STRUCT. Friendly name : Aggregate Active Addons extract_document_type Metadata Description : Extract the document type from a table name e.g. _TABLE_SUFFIX. Friendly name : Extract Document Type pos_of_trailing_set_bit Metadata Description : Identical to bits28_days_since_seen. Returns a 0-based index of the rightmost set bit in the passed bit pattern or null if no bits are set (bits = 0). To determine this position, we take a bitwise AND of the bit pattern and its complement, then we determine the position of the bit via base-2 logarithm; see https://stackoverflow.com/a/42747608/1260237 Friendly name : Pos Of Trailing Set Bit bool_to_365_bits Metadata Description : Convert a boolean to 365 bit byte array Friendly name : Bool To 365 Bits bits28_retention Metadata Description : Friendly name : Bits28 Retention combine_days_seen_maps Metadata Description : The \"clients_last_seen\" class of tables represent various types of client activity within a 28-day window as bit patterns. This function takes in two arrays of structs (aka maps) where each entry gives the bit pattern for days in which we saw a ping for a given user in a given key. We combine the bit patterns for the previous day and the current day, returning a single map. See udf.combine_experiment_days for a more specific example of this approach. Friendly name : Combine Days Seen Maps boolean_histogram_to_boolean Metadata Description : Given histogram h, return TRUE if it has a value in the \"true\" bucket, or FALSE if it has a value in the \"false\" bucket, or NULL otherwise. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L309-L317 Friendly name : Boolean Histogram To Boolean zeroed_array Metadata Description : Generates an array if all zeroes, of arbitrary length Friendly name : Zeroed Array extract_schema_validation_path Metadata Description : Return a path derived from an error message in payload_bytes_error Friendly name : Extract Schema Validation Path bitmask_lowest_7 Metadata Description : Friendly name : Bitmask Lowest 7 pack_event_properties bits_to_days_since_first_seen Metadata Description : Given a BYTES, return the number of days since the client was first seen. If no bits are set, returns NULL, indicating we don't know. Otherwise the result is 0-indexed, meaning that for \\x01, it will return 0. Results showed this being between 5-10x faster than the simpler alternative: CREATE OR REPLACE FUNCTION udf.bits_to_days_since_first_seen(b BYTES) AS (( SELECT MAX(n) FROM UNNEST(GENERATE_ARRAY( 0, 8 * BYTE_LENGTH(b))) AS n WHERE BIT_COUNT(SUBSTR(b >> n, -1) & b'\\x01') > 0)); See also: bits_to_days_since_seen.sql Friendly name : Bits To Days Since First Seen coalesce_adjacent_days_365_bits Metadata Description : Coalesce previous data's PCD with the new data's PCD. We generally want to believe only the first reasonable profile creation date that we receive from a client. Given bytes representing usage from the previous day and the current day, this function shifts the first argument by one day and returns either that value if non-zero and non-null, the current day value if non-zero and non-null, or else 0. Friendly name : Coalesce Adjacent Days 365 Bits combine_adjacent_days_28_bits Metadata Description : Combines two bit patterns. The first pattern represents activity over a 28-day period ending \"yesterday\". The second pattern represents activity as observed today (usually just 0 or 1). We shift the bits in the first pattern by one to set the new baseline as \"today\", then perform a bitwise OR of the two patterns. Friendly name : Combine Adjacent Days 28 Bits extract_document_version Metadata Description : Extract the document version from a table name e.g. _TABLE_SUFFIX. Friendly name : Extract Document Version normalize_fenix_metrics Metadata Description : Accepts a glean metrics struct as input and returns a modified struct that nulls out histograms for older versions of the Glean SDK that reported pathological binning; see https://bugzilla.mozilla.org/show_bug.cgi?id=1592930 Friendly name : Normalize Fenix Metrics bitmask_365 Metadata Description : A bitmask for 365 bits Friendly name : Bitmask 365 array_drop_first_and_append Metadata Description : Drop the first element of an array, and append the given element. Result is an array with the same length as the input. Friendly name : Array Drop First And Append gzip_length_footer Metadata Description : Given a gzip compressed byte string, extract the uncompressed size from the footer. WARNING: THIS FUNCTION IS NOT RELIABLE FOR ARBITRARY GZIP STREAMS. It should, however, be safe to use for checking the decompressed size of payload in payload_bytes_decoded (and NOT payload_bytes_raw) because that payload is produced by the decoder and limited to conditions where the footer is accurate. From https://stackoverflow.com/a/9213826 First, the only information about the uncompressed length is four bytes at the end of the gzip file (stored in little-endian order). By necessity, that is the length modulo 232. So if the uncompressed length is 4 GB or more, you won't know what the length is. You can only be certain that the uncompressed length is less than 4 GB if the compressed length is less than something like 232 / 1032 + 18, or around 4 MB. (1032 is the maximum compression factor of deflate.) Second, and this is worse, a gzip file may actually be a concatenation of multiple gzip streams. Other than decoding, there is no way to find where each gzip stream ends in order to look at the four-byte uncompressed length of that piece. (Which may be wrong anyway due to the first reason.) Third, gzip files will sometimes have junk after the end of the gzip stream (usually zeros). Then the last four bytes are not the length. Friendly name : Gzip Length Footer json_extract_histogram Metadata Description : Friendly name : Json Extract Histogram zero_as_365_bits Metadata Description : Zero represented as a 365-bit byte array Friendly name : Zero As 365 Bits parse_iso8601_date Metadata Description : Take a ISO 8601 date or date and time string and return a DATE. Return null if parse fails. Possible formats: 2019-11-04, 2019-11-04T21:15:00+00:00, 2019-11-04T21:15:00Z, 20191104T211500Z Friendly name : Parse Iso8601 Date map_bing_revenue_country_to_country_code Metadata Description : For use by LTV revenue join only. Maps the Bing country to a country code. Only keeps the country codes we want to aggregate on. Friendly name : Map Bing Revenue Country To Country Code int_to_hex_string Metadata Description : Friendly name : Int To Hex String safe_sample_id Metadata Description : Stably hash a client_id to an integer between 0 and 99, or NULL if client_id isn't 36 bytes Friendly name : Safe Sample Id get_key Metadata Description : Friendly name : Get Key hmac_sha256 Metadata Description : Given a key and message, return the HMAC-SHA256 hash. This algorithm can be found in Wikipedia: https://en.wikipedia.org/wiki/HMAC#Implementation This implentation is validated against the NIST test vectors. See test/validation/hmac_sha256.py for more information. Friendly name : Hmac Sha256 bits28_from_string Metadata Description : Friendly name : Bits28 From String merge_scalar_user_data Metadata Description : Given an array of scalar metric data that might have duplicate values for a metric, merge them into one value. Friendly name : Merge Scalar User Data bitmask_range Metadata Description : Returns a bitmask that can be used to return a subset of an integer representing a bit array. The start_ordinal argument is an integer specifying the starting position of the slice, with start_ordinal = 1 indicating the first bit. The length argument is the number of bits to include in the mask. The arguments were chosen to match the semantics of the SUBSTR function; see https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators#substr Friendly name : Bitmask Range map_mode_last Metadata Description : Friendly name : Map Mode Last ga_is_mozilla_browser Metadata Description : Determine if a browser in a Google Analytics data is produced by Mozilla Friendly name : Is Mozilla Browser fenix_build_to_datetime Metadata Friendly name : Fenix Build To Datetime Description : Convert the Fenix client_info.app_build-format string to a DATETIME. May return NULL on failure. Fenix originally used an 8-digit app_build format In short it is yDDDHHmm : y is years since 2018 DDD is day of year, 0-padded, 001-366 HH is hour of day, 00-23 mm is minute of hour, 00-59 The last date seen with an 8-digit build ID is 2020-08-10. Newer builds use a 10-digit format where the integer represents a pattern consisting of 32 bits. The 17 bits starting 13 bits from the left represent a number of hours since UTC midnight beginning 2014-12-28. This function tolerates both formats. After using this you may wish to DATETIME_TRUNC(result, DAY) for grouping by build date. bitmask_lowest_28 Metadata Description : Friendly name : Bitmask Lowest 28 bits_from_offsets Metadata Friendly name : Bits From Offsets Description : Returns a bit pattern of type BYTES compactly encoding the given array of positive integer offsets. This is primarily useful to generate a compact encoding of dates on which a feature was used, with arbitrarily long history. Example aggregation: sql bits_from_offsets( ARRAY_AGG(IF(foo, DATE_DIFF(anchor_date, submission_date, DAY), NULL) IGNORE NULLS) ) The resulting value can be cast to an INT64 representing the most recent 64 days via: sql CAST(CONCAT('0x', TO_HEX(RIGHT(bits >> i, 4))) AS INT64) Or representing the most recent 28 days (compatible with bits28 functions) via: sql CAST(CONCAT('0x', TO_HEX(RIGHT(bits >> i, 4))) AS INT64) << 36 >> 36 normalize_glean_baseline_client_info Metadata Description : Friendly name : Normalize Glean Baseline Client Info normalize_monthly_searches Metadata Description : Sum up the monthy search count arrays by normalized engine Friendly name : Normalize Monthly Searches parse_desktop_telemetry_uri Metadata Description : Parses and labels the components of a telemetry desktop ping submission uri Per https://docs.telemetry.mozilla.org/concepts/pipeline/http_edge_spec.html#special-handling-for-firefox-desktop-telemetry the format is /submit/telemetry/docId/docType/appName/appVersion/appUpdateChannel/appBuildID e.g. /submit/telemetry/ce39b608-f595-4c69-b6a6-f7a436604648/main/Firefox/61.0a1/nightly/20180328030202 Friendly name : Parse Desktop Telemetry Uri normalize_main_payload Metadata Description : Accepts a pipeline metadata struct as input and returns a modified struct that includes a few parsed or normalized variants of the input metadata fields. Friendly name : Normalize Main Payload map_revenue_country Metadata Description : Only for use by the LTV Revenue join. Maps country codes to the codes we have in the revenue dataset. Buckets small Bing countries into \"other\". Friendly name : Map Revenue Country glean_timespan_seconds Metadata Description : Friendly name : Glean Timespan Seconds aggregate_search_counts Metadata Description : Friendly name : Aggregate Search Counts kv_array_to_json_string Metadata Description : Returns a JSON string representing the input key-value array. Value type must be able to be represented as a string - this function will cast to a string. At Mozilla, the schema for a map is STRUCT >>. To use this with that representation, it should be as udf.kv_array_to_json_string(struct.key_value) . Friendly name : Kv Array To Json String combine_adjacent_days_365_bits Metadata Description : Friendly name : Combine Adjacent Days 365 Bits one_as_365_bits Metadata Description : One represented as a byte array of 365 bits Friendly name : One As 365 Bits deanonymize_event Metadata Description : Rename struct fields in anonymous event tuples to meaningful names. Friendly name : Deanonymize Event mod_uint128 Metadata Description : This function returns \"dividend mod divisor\" where the dividend and the result is encoded in bytes, and divisor is an integer. Friendly name : Mod Uint128 add_monthly_engine_searches Metadata Description : This function specifically windows searches into calendar-month windows. This means groups are not necessarily directly comparable, since different months have different numbers of days. On the first of each month, a new month is appended, and the first month is dropped. If the date is not the first of the month, the new entry is added to the last element in the array. For example, if we were adding 12 to [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]: On the first of the month, the result would be [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 12] On any other day of the month, the result would be [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 24] This happens for every aggregate (searches, ad clicks, etc.) Friendly name : Add Monthly Engine Searches shift_365_bits_one_day Metadata Description : Shift input bits one day left and drop any bits beyond 365 days. Friendly name : Shift 365 Bits One Day json_extract_int_map Metadata Description : Friendly name : Json Extract Int Map histogram_percentiles Metadata Description : Friendly name : Histogram Percentiles normalize_search_engine Metadata Description : Return normalized engine name for recognized engines Friendly name : Normalize Search Engine safe_crc32_uuid Metadata Description : Calculate the CRC-32 hash of a 36-byte UUID, or NULL if the value isn't 36 bytes. This implementation is limited to an exact length because recursion does not work. Based on https://stackoverflow.com/a/18639999/1260237 See https://en.wikipedia.org/wiki/Cyclic_redundancy_check Friendly name : Safe CRC-32 Uuid extract_histogram_sum Metadata Description : This is a performance optimization compared to the more general mozfun.hist.extract for cases where only the histogram sum is needed. It must support all the same format variants as mozfun.hist.extract but this simplification is necessary to keep the main_summary query complexity in check. Friendly name : Extract Histogram Sum histogram_normalize Metadata Description : Friendly name : Histogram Normalize","title":"udf"},{"location":"moz-fx-data-shared-prod/udf/#days_since_created_profile_as_28_bits","text":"","title":"days_since_created_profile_as_28_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata","text":"Description : Takes in a difference between submission date and profile creation date and returns a bit pattern representing the profile creation date IFF the profile date is the same as the submission date or no more than 6 days earlier. Analysis has shown that client-reported profile creation dates are much less reliable outside of this range and cannot be used as reliable indicators of new profile creation. Friendly name : Days Since Created Profile As 28 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#active_values_from_days_seen_map","text":"","title":"active_values_from_days_seen_map"},{"location":"moz-fx-data-shared-prod/udf/#metadata_1","text":"Description : Given a map of representing activity for STRING key s, this function returns an array of which key s were active for the time period in question. start_offset should be at most 0. n_bits should be at most the remaining bits. Friendly name : Active Values From Days Seen Map","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#parquet_array_sum","text":"","title":"parquet_array_sum"},{"location":"moz-fx-data-shared-prod/udf/#metadata_2","text":"Description : Sum an array from a parquet-derived field. These are lists of an element that contain the field value. Friendly name : Parquet Array Sum","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#coalesce_adjacent_days_28_bits","text":"","title":"coalesce_adjacent_days_28_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_3","text":"Description : We generally want to believe only the first reasonable profile creation date that we receive from a client. Given bits representing usage from the previous day and the current day, this function shifts the first argument by one day and returns either that value if non-zero and non-null, the current day value if non-zero and non-null, or else 0. Friendly name : Coalesce Adjacent Days 28 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#json_mode_last","text":"","title":"json_mode_last"},{"location":"moz-fx-data-shared-prod/udf/#metadata_4","text":"Description : Friendly name : Json Mode Last","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits_to_days_since_seen","text":"","title":"bits_to_days_since_seen"},{"location":"moz-fx-data-shared-prod/udf/#metadata_5","text":"Description : Given a BYTES, return the number of days since the client was last seen. If no bits are set, returns NULL, indicating we don't know. Otherwise the results are 0-indexed, meaning \\x01 will return 0. Tests showed this being 5-10x faster than the simpler alternative: CREATE OR REPLACE FUNCTION udf.bits_to_days_since_seen(b BYTES) AS (( SELECT MIN(n) FROM UNNEST(GENERATE_ARRAY(0, 364)) AS n WHERE BIT_COUNT(SUBSTR(b >> n, -1) & b'\\x01') > 0)); See also: bits_to_days_since_first_seen.sql Friendly name : Bits To Days Since Seen","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_days_since_seen","text":"","title":"bits28_days_since_seen"},{"location":"moz-fx-data-shared-prod/udf/#metadata_6","text":"Description : Friendly name : Bits28 Days Since Seen","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#histogram_to_mean","text":"","title":"histogram_to_mean"},{"location":"moz-fx-data-shared-prod/udf/#metadata_7","text":"Description : Friendly name : Histogram To Mean","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#glean_timespan_nanos","text":"","title":"glean_timespan_nanos"},{"location":"moz-fx-data-shared-prod/udf/#metadata_8","text":"Description : Friendly name : Glean Timespan Nanos","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#null_if_empty_list","text":"","title":"null_if_empty_list"},{"location":"moz-fx-data-shared-prod/udf/#metadata_9","text":"Description : Return NULL if list is empty, otherwise return list. This cannot be done with NULLIF because NULLIF does not support arrays. Friendly name : Null If Empty List","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#country_code_to_flag","text":"","title":"country_code_to_flag"},{"location":"moz-fx-data-shared-prod/udf/#metadata_10","text":"Description : For a given two-letter ISO 3166-1 alpha-2 country code, returns a string consisting of two Unicode regional indicator symbols, which is rendered in supporting fonts (such as in the BigQuery console or STMO) as flag emoji. This is just for fun. See: - https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2 - https://en.wikipedia.org/wiki/Regional_Indicator_Symbol Friendly name : Country Code To Flag","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#add_searches_by_index","text":"","title":"add_searches_by_index"},{"location":"moz-fx-data-shared-prod/udf/#metadata_11","text":"Description : Return sums of each search type grouped by the index. Results are ordered by index. Friendly name : Add Searches By Index","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#array_of_12_zeroes","text":"","title":"array_of_12_zeroes"},{"location":"moz-fx-data-shared-prod/udf/#metadata_12","text":"Description : An array of 12 zeroes Friendly name : Array Of 12 Zeroes","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#new_monthly_engine_searches_struct","text":"","title":"new_monthly_engine_searches_struct"},{"location":"moz-fx-data-shared-prod/udf/#metadata_13","text":"Description : This struct represents the past year's worth of searches. Each month has its own entry, hence 12. Friendly name : New Monthly Engine Searches Struct","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_metadata","text":"","title":"normalize_metadata"},{"location":"moz-fx-data-shared-prod/udf/#metadata_14","text":"Description : Friendly name : Normalize Metadata","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#pos_of_leading_set_bit","text":"","title":"pos_of_leading_set_bit"},{"location":"moz-fx-data-shared-prod/udf/#metadata_15","text":"Description : Returns the 0-based index of the first set bit. No set bits returns NULL. Friendly name : Pos Of Leading Set Bit","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#shift_28_bits_one_day","text":"","title":"shift_28_bits_one_day"},{"location":"moz-fx-data-shared-prod/udf/#metadata_16","text":"Description : Shift input bits one day left and drop any bits beyond 28 days. Friendly name : Shift 28 Bits One Day","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_to_string","text":"","title":"bits28_to_string"},{"location":"moz-fx-data-shared-prod/udf/#metadata_17","text":"Description : Friendly name : Bits28 To String","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#kv_array_append_to_json_string","text":"","title":"kv_array_append_to_json_string"},{"location":"moz-fx-data-shared-prod/udf/#metadata_18","text":"Description : Returns a JSON string which has the pair appended to the provided input JSON string. NULL is also valid for input . Examples: udf.kv_array_append_to_json_string('{\"foo\":\"bar\"}', [STRUCT(\"baz\" AS key, \"boo\" AS value)]) '{\"foo\":\"bar\",\"baz\":\"boo\"}' udf.kv_array_append_to_json_string('{}', [STRUCT(\"baz\" AS key, \"boo\" AS value)]) '{\"baz\": \"boo\"}' Friendly name : Kv Array Append To Json String","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#combine_experiment_days","text":"","title":"combine_experiment_days"},{"location":"moz-fx-data-shared-prod/udf/#metadata_19","text":"Description : The \"clients_last_seen\" class of tables represent various types of client activity within a 28-day window as bit patterns. This function takes in two arrays of structs where each entry gives the bit pattern for days in which we saw a ping for a given user in a given experiment. We combine the bit patterns for the previous day and the current day, returning a single array of experiment structs. Friendly name : Combine Experiment Days","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_glean_ping_info","text":"","title":"normalize_glean_ping_info"},{"location":"moz-fx-data-shared-prod/udf/#metadata_20","text":"Description : Friendly name : Normalize Glean Ping Info","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#shift_one_day","text":"","title":"shift_one_day"},{"location":"moz-fx-data-shared-prod/udf/#metadata_21","text":"Description : Returns the bitfield shifted by one day, 0 for NULL Friendly name : Shift One Day","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits_to_days_seen","text":"","title":"bits_to_days_seen"},{"location":"moz-fx-data-shared-prod/udf/#metadata_22","text":"Description : Given a BYTE, get the number of days the user was seen. NULL input returns NULL output. Friendly name : Bits To Days Seen","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bitcount_lowest_7","text":"","title":"bitcount_lowest_7"},{"location":"moz-fx-data-shared-prod/udf/#metadata_23","text":"Description : This function counts the 1s in lowest 7 bits of an INT64 Friendly name : Bitcount Lowest 7","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_range","text":"","title":"bits28_range"},{"location":"moz-fx-data-shared-prod/udf/#metadata_24","text":"Description : Friendly name : Bits28 Range","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#histogram_to_threshold_count","text":"","title":"histogram_to_threshold_count"},{"location":"moz-fx-data-shared-prod/udf/#metadata_25","text":"Description : Friendly name : Histogram To Threshold Count","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#get_key_with_null","text":"","title":"get_key_with_null"},{"location":"moz-fx-data-shared-prod/udf/#metadata_26","text":"Description : Friendly name : Get Key With Null","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_os","text":"","title":"normalize_os"},{"location":"moz-fx-data-shared-prod/udf/#metadata_27","text":"Description : Friendly name : Normalize Os","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#active_n_weeks_ago","text":"","title":"active_n_weeks_ago"},{"location":"moz-fx-data-shared-prod/udf/#metadata_28","text":"Description : Friendly name : Active N Weeks Ago","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#main_summary_scalars","text":"","title":"main_summary_scalars"},{"location":"moz-fx-data-shared-prod/udf/#metadata_29","text":"Description : Friendly name : Main Summary Scalars","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#histogram_max_key_with_nonzero_value","text":"","title":"histogram_max_key_with_nonzero_value"},{"location":"moz-fx-data-shared-prod/udf/#metadata_30","text":"Description : Find the largest numeric bucket that contains a value greater than zero. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L253-L266 Friendly name : Histogram Max Key With Nonzero Value","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#aggregate_map_first","text":"","title":"aggregate_map_first"},{"location":"moz-fx-data-shared-prod/udf/#metadata_31","text":"Description : Returns an aggregated map with all the keys and the first corresponding value from the given maps Friendly name : Aggregate Map First","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_to_dates","text":"","title":"bits28_to_dates"},{"location":"moz-fx-data-shared-prod/udf/#metadata_32","text":"Description : Friendly name : Bits28 To Dates","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#vector_add","text":"","title":"vector_add"},{"location":"moz-fx-data-shared-prod/udf/#metadata_33","text":"Description : This function adds two vectors. The two vectors can have different length. If one vector is null, the other vector will be returned directly. Friendly name : Vector Add","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#keyed_histogram_get_sum","text":"","title":"keyed_histogram_get_sum"},{"location":"moz-fx-data-shared-prod/udf/#metadata_34","text":"Description : Take a keyed histogram of type STRUCT , extract the histogram of the given key, and return the sum value Friendly name : Keyed Histogram Get Sum","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#round_timestamp_to_minute","text":"","title":"round_timestamp_to_minute"},{"location":"moz-fx-data-shared-prod/udf/#metadata_35","text":"Description : Floor a timestamp object to the given minute interval. Friendly name : Round Timestamp To Minute","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#add_monthly_searches","text":"","title":"add_monthly_searches"},{"location":"moz-fx-data-shared-prod/udf/#metadata_36","text":"Description : Adds together two engine searches structs. Each engine searches struct has a MAP[engine -> search_counts_struct]. We want to add add together the prev and curr's values for a certain engine. This allows us to be flexible with the number of engines we're using. Friendly name : Add Monthly Searches","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#map_sum","text":"","title":"map_sum"},{"location":"moz-fx-data-shared-prod/udf/#metadata_37","text":"Description : Friendly name : Map Sum","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#int_to_365_bits","text":"","title":"int_to_365_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_38","text":"Description : Friendly name : Int To 365 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#decode_int64","text":"","title":"decode_int64"},{"location":"moz-fx-data-shared-prod/udf/#metadata_39","text":"Description : Friendly name : Decode Int64","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#smoot_usage_from_28_bits","text":"","title":"smoot_usage_from_28_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_40","text":"Description : Calculates a variety of metrics based on bit patterns of daily usage for the smoot_usage_* tables. Friendly name : Smoot Usage From 28 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#extract_count_histogram_value","text":"","title":"extract_count_histogram_value"},{"location":"moz-fx-data-shared-prod/udf/#metadata_41","text":"Description : Friendly name : Extract Count Histogram Value","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#array_slice","text":"","title":"array_slice"},{"location":"moz-fx-data-shared-prod/udf/#metadata_42","text":"Description : Friendly name : Array Slice","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#dedupe_array","text":"","title":"dedupe_array"},{"location":"moz-fx-data-shared-prod/udf/#metadata_43","text":"Description : Return an array containing only distinct values of the given array Friendly name : Dedupe Array","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#histogram_merge","text":"","title":"histogram_merge"},{"location":"moz-fx-data-shared-prod/udf/#metadata_44","text":"Description : Friendly name : Histogram Merge","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#mode_last_retain_nulls","text":"","title":"mode_last_retain_nulls"},{"location":"moz-fx-data-shared-prod/udf/#metadata_45","text":"Description : Friendly name : Mode Last Retain Nulls","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits_to_active_n_weeks_ago","text":"","title":"bits_to_active_n_weeks_ago"},{"location":"moz-fx-data-shared-prod/udf/#metadata_46","text":"Description : Given a BYTE and an INT64, return whether the user was active that many weeks ago. NULL input returns NULL output. Friendly name : Bits To Active N Weeks Ago","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#event_code_points_to_string","text":"","title":"event_code_points_to_string"},{"location":"moz-fx-data-shared-prod/udf/#days_seen_bytes_to_rfm","text":"","title":"days_seen_bytes_to_rfm"},{"location":"moz-fx-data-shared-prod/udf/#metadata_47","text":"Description : Return the frequency, recency, and T from a BYTE array, as defined in https://lifetimes.readthedocs.io/en/latest/Quickstart.html#the-shape-of-your-data RFM refers to Recency, Frequency, and Monetary value. Friendly name : Days Seen Bytes To Rfm","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_active_in_range","text":"","title":"bits28_active_in_range"},{"location":"moz-fx-data-shared-prod/udf/#metadata_48","text":"Description : Friendly name : Bits28 Active In Range","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#mode_last","text":"","title":"mode_last"},{"location":"moz-fx-data-shared-prod/udf/#metadata_49","text":"Description : Friendly name : Mode Last","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#geo_struct","text":"","title":"geo_struct"},{"location":"moz-fx-data-shared-prod/udf/#metadata_50","text":"Description : Convert geoip lookup fields to a struct, replacing '??' with NULL. Returns NULL if if required field country would be NULL. Replaces '??' with NULL because '??' is a placeholder that may be used if there was an issue during geoip lookup in hindsight. Friendly name : Geo Struct","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#aggregate_search_map","text":"","title":"aggregate_search_map"},{"location":"moz-fx-data-shared-prod/udf/#metadata_51","text":"Description : Aggregates the total counts of the given search counters Friendly name : Aggregate Search Map","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#quantile_search_metric_contribution","text":"","title":"quantile_search_metric_contribution"},{"location":"moz-fx-data-shared-prod/udf/#metadata_52","text":"Description : This function returns how much of one metric is contributed by the quantile of another metric. Quantile variable should add an offset to get the requried percentile value. Example: udf.quantile_search_metric_contribution(sap, search_with_ads, sap_percentiles[OFFSET(9)]) It returns search_with_ads if sap value in top 10% volumn else null. Friendly name : Quantile Search Metric Contribution","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#array_11_zeroes_then","text":"","title":"array_11_zeroes_then"},{"location":"moz-fx-data-shared-prod/udf/#metadata_53","text":"Description : An array of 11 zeroes, followed by a supplied value Friendly name : Array 11 Zeroes Then","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#aggregate_active_addons","text":"","title":"aggregate_active_addons"},{"location":"moz-fx-data-shared-prod/udf/#metadata_54","text":"Description : This function selects most frequently occuring value for each addon_id, using the latest value in the input among ties. The type for active_addons is ARRAY >, i.e. the output of SELECT ARRAY_CONCAT_AGG(active_addons) FROM telemetry.main_summary_v4 , and is left unspecified to allow changes to the fields of the STRUCT. Friendly name : Aggregate Active Addons","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#extract_document_type","text":"","title":"extract_document_type"},{"location":"moz-fx-data-shared-prod/udf/#metadata_55","text":"Description : Extract the document type from a table name e.g. _TABLE_SUFFIX. Friendly name : Extract Document Type","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#pos_of_trailing_set_bit","text":"","title":"pos_of_trailing_set_bit"},{"location":"moz-fx-data-shared-prod/udf/#metadata_56","text":"Description : Identical to bits28_days_since_seen. Returns a 0-based index of the rightmost set bit in the passed bit pattern or null if no bits are set (bits = 0). To determine this position, we take a bitwise AND of the bit pattern and its complement, then we determine the position of the bit via base-2 logarithm; see https://stackoverflow.com/a/42747608/1260237 Friendly name : Pos Of Trailing Set Bit","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bool_to_365_bits","text":"","title":"bool_to_365_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_57","text":"Description : Convert a boolean to 365 bit byte array Friendly name : Bool To 365 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_retention","text":"","title":"bits28_retention"},{"location":"moz-fx-data-shared-prod/udf/#metadata_58","text":"Description : Friendly name : Bits28 Retention","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#combine_days_seen_maps","text":"","title":"combine_days_seen_maps"},{"location":"moz-fx-data-shared-prod/udf/#metadata_59","text":"Description : The \"clients_last_seen\" class of tables represent various types of client activity within a 28-day window as bit patterns. This function takes in two arrays of structs (aka maps) where each entry gives the bit pattern for days in which we saw a ping for a given user in a given key. We combine the bit patterns for the previous day and the current day, returning a single map. See udf.combine_experiment_days for a more specific example of this approach. Friendly name : Combine Days Seen Maps","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#boolean_histogram_to_boolean","text":"","title":"boolean_histogram_to_boolean"},{"location":"moz-fx-data-shared-prod/udf/#metadata_60","text":"Description : Given histogram h, return TRUE if it has a value in the \"true\" bucket, or FALSE if it has a value in the \"false\" bucket, or NULL otherwise. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L309-L317 Friendly name : Boolean Histogram To Boolean","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#zeroed_array","text":"","title":"zeroed_array"},{"location":"moz-fx-data-shared-prod/udf/#metadata_61","text":"Description : Generates an array if all zeroes, of arbitrary length Friendly name : Zeroed Array","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#extract_schema_validation_path","text":"","title":"extract_schema_validation_path"},{"location":"moz-fx-data-shared-prod/udf/#metadata_62","text":"Description : Return a path derived from an error message in payload_bytes_error Friendly name : Extract Schema Validation Path","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bitmask_lowest_7","text":"","title":"bitmask_lowest_7"},{"location":"moz-fx-data-shared-prod/udf/#metadata_63","text":"Description : Friendly name : Bitmask Lowest 7","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#pack_event_properties","text":"","title":"pack_event_properties"},{"location":"moz-fx-data-shared-prod/udf/#bits_to_days_since_first_seen","text":"","title":"bits_to_days_since_first_seen"},{"location":"moz-fx-data-shared-prod/udf/#metadata_64","text":"Description : Given a BYTES, return the number of days since the client was first seen. If no bits are set, returns NULL, indicating we don't know. Otherwise the result is 0-indexed, meaning that for \\x01, it will return 0. Results showed this being between 5-10x faster than the simpler alternative: CREATE OR REPLACE FUNCTION udf.bits_to_days_since_first_seen(b BYTES) AS (( SELECT MAX(n) FROM UNNEST(GENERATE_ARRAY( 0, 8 * BYTE_LENGTH(b))) AS n WHERE BIT_COUNT(SUBSTR(b >> n, -1) & b'\\x01') > 0)); See also: bits_to_days_since_seen.sql Friendly name : Bits To Days Since First Seen","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#coalesce_adjacent_days_365_bits","text":"","title":"coalesce_adjacent_days_365_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_65","text":"Description : Coalesce previous data's PCD with the new data's PCD. We generally want to believe only the first reasonable profile creation date that we receive from a client. Given bytes representing usage from the previous day and the current day, this function shifts the first argument by one day and returns either that value if non-zero and non-null, the current day value if non-zero and non-null, or else 0. Friendly name : Coalesce Adjacent Days 365 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#combine_adjacent_days_28_bits","text":"","title":"combine_adjacent_days_28_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_66","text":"Description : Combines two bit patterns. The first pattern represents activity over a 28-day period ending \"yesterday\". The second pattern represents activity as observed today (usually just 0 or 1). We shift the bits in the first pattern by one to set the new baseline as \"today\", then perform a bitwise OR of the two patterns. Friendly name : Combine Adjacent Days 28 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#extract_document_version","text":"","title":"extract_document_version"},{"location":"moz-fx-data-shared-prod/udf/#metadata_67","text":"Description : Extract the document version from a table name e.g. _TABLE_SUFFIX. Friendly name : Extract Document Version","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_fenix_metrics","text":"","title":"normalize_fenix_metrics"},{"location":"moz-fx-data-shared-prod/udf/#metadata_68","text":"Description : Accepts a glean metrics struct as input and returns a modified struct that nulls out histograms for older versions of the Glean SDK that reported pathological binning; see https://bugzilla.mozilla.org/show_bug.cgi?id=1592930 Friendly name : Normalize Fenix Metrics","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bitmask_365","text":"","title":"bitmask_365"},{"location":"moz-fx-data-shared-prod/udf/#metadata_69","text":"Description : A bitmask for 365 bits Friendly name : Bitmask 365","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#array_drop_first_and_append","text":"","title":"array_drop_first_and_append"},{"location":"moz-fx-data-shared-prod/udf/#metadata_70","text":"Description : Drop the first element of an array, and append the given element. Result is an array with the same length as the input. Friendly name : Array Drop First And Append","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#gzip_length_footer","text":"","title":"gzip_length_footer"},{"location":"moz-fx-data-shared-prod/udf/#metadata_71","text":"Description : Given a gzip compressed byte string, extract the uncompressed size from the footer. WARNING: THIS FUNCTION IS NOT RELIABLE FOR ARBITRARY GZIP STREAMS. It should, however, be safe to use for checking the decompressed size of payload in payload_bytes_decoded (and NOT payload_bytes_raw) because that payload is produced by the decoder and limited to conditions where the footer is accurate. From https://stackoverflow.com/a/9213826 First, the only information about the uncompressed length is four bytes at the end of the gzip file (stored in little-endian order). By necessity, that is the length modulo 232. So if the uncompressed length is 4 GB or more, you won't know what the length is. You can only be certain that the uncompressed length is less than 4 GB if the compressed length is less than something like 232 / 1032 + 18, or around 4 MB. (1032 is the maximum compression factor of deflate.) Second, and this is worse, a gzip file may actually be a concatenation of multiple gzip streams. Other than decoding, there is no way to find where each gzip stream ends in order to look at the four-byte uncompressed length of that piece. (Which may be wrong anyway due to the first reason.) Third, gzip files will sometimes have junk after the end of the gzip stream (usually zeros). Then the last four bytes are not the length. Friendly name : Gzip Length Footer","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#json_extract_histogram","text":"","title":"json_extract_histogram"},{"location":"moz-fx-data-shared-prod/udf/#metadata_72","text":"Description : Friendly name : Json Extract Histogram","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#zero_as_365_bits","text":"","title":"zero_as_365_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_73","text":"Description : Zero represented as a 365-bit byte array Friendly name : Zero As 365 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#parse_iso8601_date","text":"","title":"parse_iso8601_date"},{"location":"moz-fx-data-shared-prod/udf/#metadata_74","text":"Description : Take a ISO 8601 date or date and time string and return a DATE. Return null if parse fails. Possible formats: 2019-11-04, 2019-11-04T21:15:00+00:00, 2019-11-04T21:15:00Z, 20191104T211500Z Friendly name : Parse Iso8601 Date","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#map_bing_revenue_country_to_country_code","text":"","title":"map_bing_revenue_country_to_country_code"},{"location":"moz-fx-data-shared-prod/udf/#metadata_75","text":"Description : For use by LTV revenue join only. Maps the Bing country to a country code. Only keeps the country codes we want to aggregate on. Friendly name : Map Bing Revenue Country To Country Code","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#int_to_hex_string","text":"","title":"int_to_hex_string"},{"location":"moz-fx-data-shared-prod/udf/#metadata_76","text":"Description : Friendly name : Int To Hex String","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#safe_sample_id","text":"","title":"safe_sample_id"},{"location":"moz-fx-data-shared-prod/udf/#metadata_77","text":"Description : Stably hash a client_id to an integer between 0 and 99, or NULL if client_id isn't 36 bytes Friendly name : Safe Sample Id","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#get_key","text":"","title":"get_key"},{"location":"moz-fx-data-shared-prod/udf/#metadata_78","text":"Description : Friendly name : Get Key","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#hmac_sha256","text":"","title":"hmac_sha256"},{"location":"moz-fx-data-shared-prod/udf/#metadata_79","text":"Description : Given a key and message, return the HMAC-SHA256 hash. This algorithm can be found in Wikipedia: https://en.wikipedia.org/wiki/HMAC#Implementation This implentation is validated against the NIST test vectors. See test/validation/hmac_sha256.py for more information. Friendly name : Hmac Sha256","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits28_from_string","text":"","title":"bits28_from_string"},{"location":"moz-fx-data-shared-prod/udf/#metadata_80","text":"Description : Friendly name : Bits28 From String","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#merge_scalar_user_data","text":"","title":"merge_scalar_user_data"},{"location":"moz-fx-data-shared-prod/udf/#metadata_81","text":"Description : Given an array of scalar metric data that might have duplicate values for a metric, merge them into one value. Friendly name : Merge Scalar User Data","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bitmask_range","text":"","title":"bitmask_range"},{"location":"moz-fx-data-shared-prod/udf/#metadata_82","text":"Description : Returns a bitmask that can be used to return a subset of an integer representing a bit array. The start_ordinal argument is an integer specifying the starting position of the slice, with start_ordinal = 1 indicating the first bit. The length argument is the number of bits to include in the mask. The arguments were chosen to match the semantics of the SUBSTR function; see https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators#substr Friendly name : Bitmask Range","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#map_mode_last","text":"","title":"map_mode_last"},{"location":"moz-fx-data-shared-prod/udf/#metadata_83","text":"Description : Friendly name : Map Mode Last","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#ga_is_mozilla_browser","text":"","title":"ga_is_mozilla_browser"},{"location":"moz-fx-data-shared-prod/udf/#metadata_84","text":"Description : Determine if a browser in a Google Analytics data is produced by Mozilla Friendly name : Is Mozilla Browser","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#fenix_build_to_datetime","text":"","title":"fenix_build_to_datetime"},{"location":"moz-fx-data-shared-prod/udf/#metadata_85","text":"Friendly name : Fenix Build To Datetime Description : Convert the Fenix client_info.app_build-format string to a DATETIME. May return NULL on failure. Fenix originally used an 8-digit app_build format In short it is yDDDHHmm : y is years since 2018 DDD is day of year, 0-padded, 001-366 HH is hour of day, 00-23 mm is minute of hour, 00-59 The last date seen with an 8-digit build ID is 2020-08-10. Newer builds use a 10-digit format where the integer represents a pattern consisting of 32 bits. The 17 bits starting 13 bits from the left represent a number of hours since UTC midnight beginning 2014-12-28. This function tolerates both formats. After using this you may wish to DATETIME_TRUNC(result, DAY) for grouping by build date.","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bitmask_lowest_28","text":"","title":"bitmask_lowest_28"},{"location":"moz-fx-data-shared-prod/udf/#metadata_86","text":"Description : Friendly name : Bitmask Lowest 28","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#bits_from_offsets","text":"","title":"bits_from_offsets"},{"location":"moz-fx-data-shared-prod/udf/#metadata_87","text":"Friendly name : Bits From Offsets Description : Returns a bit pattern of type BYTES compactly encoding the given array of positive integer offsets. This is primarily useful to generate a compact encoding of dates on which a feature was used, with arbitrarily long history. Example aggregation: sql bits_from_offsets( ARRAY_AGG(IF(foo, DATE_DIFF(anchor_date, submission_date, DAY), NULL) IGNORE NULLS) ) The resulting value can be cast to an INT64 representing the most recent 64 days via: sql CAST(CONCAT('0x', TO_HEX(RIGHT(bits >> i, 4))) AS INT64) Or representing the most recent 28 days (compatible with bits28 functions) via: sql CAST(CONCAT('0x', TO_HEX(RIGHT(bits >> i, 4))) AS INT64) << 36 >> 36","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_glean_baseline_client_info","text":"","title":"normalize_glean_baseline_client_info"},{"location":"moz-fx-data-shared-prod/udf/#metadata_88","text":"Description : Friendly name : Normalize Glean Baseline Client Info","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_monthly_searches","text":"","title":"normalize_monthly_searches"},{"location":"moz-fx-data-shared-prod/udf/#metadata_89","text":"Description : Sum up the monthy search count arrays by normalized engine Friendly name : Normalize Monthly Searches","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#parse_desktop_telemetry_uri","text":"","title":"parse_desktop_telemetry_uri"},{"location":"moz-fx-data-shared-prod/udf/#metadata_90","text":"Description : Parses and labels the components of a telemetry desktop ping submission uri Per https://docs.telemetry.mozilla.org/concepts/pipeline/http_edge_spec.html#special-handling-for-firefox-desktop-telemetry the format is /submit/telemetry/docId/docType/appName/appVersion/appUpdateChannel/appBuildID e.g. /submit/telemetry/ce39b608-f595-4c69-b6a6-f7a436604648/main/Firefox/61.0a1/nightly/20180328030202 Friendly name : Parse Desktop Telemetry Uri","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_main_payload","text":"","title":"normalize_main_payload"},{"location":"moz-fx-data-shared-prod/udf/#metadata_91","text":"Description : Accepts a pipeline metadata struct as input and returns a modified struct that includes a few parsed or normalized variants of the input metadata fields. Friendly name : Normalize Main Payload","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#map_revenue_country","text":"","title":"map_revenue_country"},{"location":"moz-fx-data-shared-prod/udf/#metadata_92","text":"Description : Only for use by the LTV Revenue join. Maps country codes to the codes we have in the revenue dataset. Buckets small Bing countries into \"other\". Friendly name : Map Revenue Country","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#glean_timespan_seconds","text":"","title":"glean_timespan_seconds"},{"location":"moz-fx-data-shared-prod/udf/#metadata_93","text":"Description : Friendly name : Glean Timespan Seconds","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#aggregate_search_counts","text":"","title":"aggregate_search_counts"},{"location":"moz-fx-data-shared-prod/udf/#metadata_94","text":"Description : Friendly name : Aggregate Search Counts","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#kv_array_to_json_string","text":"","title":"kv_array_to_json_string"},{"location":"moz-fx-data-shared-prod/udf/#metadata_95","text":"Description : Returns a JSON string representing the input key-value array. Value type must be able to be represented as a string - this function will cast to a string. At Mozilla, the schema for a map is STRUCT >>. To use this with that representation, it should be as udf.kv_array_to_json_string(struct.key_value) . Friendly name : Kv Array To Json String","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#combine_adjacent_days_365_bits","text":"","title":"combine_adjacent_days_365_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_96","text":"Description : Friendly name : Combine Adjacent Days 365 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#one_as_365_bits","text":"","title":"one_as_365_bits"},{"location":"moz-fx-data-shared-prod/udf/#metadata_97","text":"Description : One represented as a byte array of 365 bits Friendly name : One As 365 Bits","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#deanonymize_event","text":"","title":"deanonymize_event"},{"location":"moz-fx-data-shared-prod/udf/#metadata_98","text":"Description : Rename struct fields in anonymous event tuples to meaningful names. Friendly name : Deanonymize Event","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#mod_uint128","text":"","title":"mod_uint128"},{"location":"moz-fx-data-shared-prod/udf/#metadata_99","text":"Description : This function returns \"dividend mod divisor\" where the dividend and the result is encoded in bytes, and divisor is an integer. Friendly name : Mod Uint128","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#add_monthly_engine_searches","text":"","title":"add_monthly_engine_searches"},{"location":"moz-fx-data-shared-prod/udf/#metadata_100","text":"Description : This function specifically windows searches into calendar-month windows. This means groups are not necessarily directly comparable, since different months have different numbers of days. On the first of each month, a new month is appended, and the first month is dropped. If the date is not the first of the month, the new entry is added to the last element in the array. For example, if we were adding 12 to [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]: On the first of the month, the result would be [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 12] On any other day of the month, the result would be [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 24] This happens for every aggregate (searches, ad clicks, etc.) Friendly name : Add Monthly Engine Searches","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#shift_365_bits_one_day","text":"","title":"shift_365_bits_one_day"},{"location":"moz-fx-data-shared-prod/udf/#metadata_101","text":"Description : Shift input bits one day left and drop any bits beyond 365 days. Friendly name : Shift 365 Bits One Day","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#json_extract_int_map","text":"","title":"json_extract_int_map"},{"location":"moz-fx-data-shared-prod/udf/#metadata_102","text":"Description : Friendly name : Json Extract Int Map","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#histogram_percentiles","text":"","title":"histogram_percentiles"},{"location":"moz-fx-data-shared-prod/udf/#metadata_103","text":"Description : Friendly name : Histogram Percentiles","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#normalize_search_engine","text":"","title":"normalize_search_engine"},{"location":"moz-fx-data-shared-prod/udf/#metadata_104","text":"Description : Return normalized engine name for recognized engines Friendly name : Normalize Search Engine","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#safe_crc32_uuid","text":"","title":"safe_crc32_uuid"},{"location":"moz-fx-data-shared-prod/udf/#metadata_105","text":"Description : Calculate the CRC-32 hash of a 36-byte UUID, or NULL if the value isn't 36 bytes. This implementation is limited to an exact length because recursion does not work. Based on https://stackoverflow.com/a/18639999/1260237 See https://en.wikipedia.org/wiki/Cyclic_redundancy_check Friendly name : Safe CRC-32 Uuid","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#extract_histogram_sum","text":"","title":"extract_histogram_sum"},{"location":"moz-fx-data-shared-prod/udf/#metadata_106","text":"Description : This is a performance optimization compared to the more general mozfun.hist.extract for cases where only the histogram sum is needed. It must support all the same format variants as mozfun.hist.extract but this simplification is necessary to keep the main_summary query complexity in check. Friendly name : Extract Histogram Sum","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf/#histogram_normalize","text":"","title":"histogram_normalize"},{"location":"moz-fx-data-shared-prod/udf/#metadata_107","text":"Description : Friendly name : Histogram Normalize","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/","text":"jackknife_sum_ci Metadata Description : Calculates a confidence interval using a jackknife resampling technique for the sum of an array of counts for various buckets; see https://en.wikipedia.org/wiki/Jackknife_resampling Users must specify the number of expected buckets as the first parameter to guard against the case where empty buckets lead to an array with missing elements. Usage generally involves first calculating an aggregate count per bucket, then aggregating over buckets, passing ARRAY_AGG(metric) to this function. Example: WITH bucketed AS ( SELECT submission_date, SUM(dau) AS dau_sum FROM mytable GROUP BY submission_date, bucket_id ) SELECT submission_date, udf_js.jackknife_sum_ci(ARRAY_AGG(dau_sum)).* FROM bucketed GROUP BY submission_date Friendly name : Jackknife Sum Ci json_extract_keyed_histogram Metadata Description : Returns an array of parsed structs from a JSON string representing a keyed histogram. This is likely only useful for histograms that weren't properly parsed to fields, so ended up embedded in an additional_properties JSON blob. Normally, keyed histograms will be modeled as a key/value struct where the values are JSON representations of single histograms. There is no pure SQL equivalent to this function, since BigQuery does not provide any functions for listing or iterating over keysn in a JSON map. Friendly name : Json Extract Keyed Histogram main_summary_addon_scalars Metadata Description : Parse scalars from payload.processes.dynamic into map columns for each value type. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c00df191501b39d2c4e2ece3fe703a0ef3/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L385-L399 Friendly name : Main Summary Addon Scalars jackknife_ratio_ci Metadata Description : Calculates a confidence interval using a jackknife resampling technique for the weighted mean of an array of ratios for various buckets; see https://en.wikipedia.org/wiki/Jackknife_resampling Users must specify the number of expected buckets as the first parameter to guard against the case where empty buckets lead to an array with missing elements. Usage generally involves first calculating an aggregate per bucket, then aggregating over buckets, passing ARRAY_AGG(metric) to this function. Example: WITH bucketed AS ( SELECT submission_date, SUM(active_days_in_week) AS active_days_in_week, SUM(wau) AS wau FROM mytable GROUP BY submission_date, bucket_id ) SELECT submission_date, udf_js.jackknife_ratio_ci(20, ARRAY_AGG(STRUCT(CAST(active_days_in_week AS float64), CAST(wau as FLOAT64)))) AS intensity FROM bucketed GROUP BY submission_date Friendly name : Jackknife Ratio Ci json_extract_events Metadata Description : Friendly name : Json Extract Events json_extract_missing_cols Metadata Description : Extract missing columns from additional properties. More generally, get a list of nodes from a JSON blob. Array elements are indicated as [...]. param input: The JSON blob to explode param indicates_node: An array of strings. If a key's value is an object, and contains one of these values, that key is returned as a node. param known_nodes: An array of strings. If a key is in this array, it is returned as a node. Notes: - Use indicates_node for things like histograms. For example ['histogram_type'] will ensure that each histogram will be returned as a missing node, rather than the subvalues within the histogram (e.g. values, sum, etc.) - Use known_nodes if you're aware of a missing section, like ['simpleMeasurements'] See here for an example usage https://sql.telemetry.mozilla.org/queries/64460/source Friendly name : Json Extract Missing Cols crc32 Metadata Description : Calculate the CRC-32 hash of an input string. The implementation here could be optimized. In particular, it calculates a lookup table on every invocation which could be cached and reused. In practice, though, this implementation appears to be fast enough that further optimization is not yet warranted. Based on https://stackoverflow.com/a/18639999/1260237 See https://en.wikipedia.org/wiki/Cyclic_redundancy_check Friendly name : CRC-32 jackknife_mean_ci Metadata Description : Calculates a confidence interval using a jackknife resampling technique for the mean of an array of values for various buckets; see https://en.wikipedia.org/wiki/Jackknife_resampling Users must specify the number of expected buckets as the first parameter to guard against the case where empty buckets lead to an array with missing elements. Usage generally involves first calculating an aggregate per bucket, then aggregating over buckets, passing ARRAY_AGG(metric) to this function. Friendly name : Jackknife Mean Ci main_summary_disabled_addons Metadata Description : Report the ids of the addons which are in the addonDetails but not in the activeAddons. They are the disabled addons (possibly because they are legacy). We need this as addonDetails may contain both disabled and active addons. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c00df191501b39d2c4e2ece3fe703a0ef3/src/main/scala/com/mozilla/telemetry/views/MainSummaryView.scala#L451-L464 Friendly name : Main Summary Disabled Addons json_extract_histogram Metadata Description : Returns a parsed struct from a JSON string representing a histogram. This implementation uses JavaScript and is provided for performance comparison; see udf/udf_json_extract_histogram for a pure SQL implementation that will likely be more usable in practice. Friendly name : Json Extract Histogram main_summary_active_addons Metadata Description : Add fields from additional_attributes to active_addons in main_v4. Return an array instead of a \"map\" for backwards compatibility. The INT64 columns from BigQuery may be passed as strings, so parseInt before returning them if they will be coerced to BOOL. The fields from additional_attributes due to union types: integer or boolean for foreignInstall and userDisabled; string or number for version. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c00df191501b39d2c4e2ece3fe703a0ef3/src/main/scala/com/mozilla/telemetry/views/MainSummaryView.scala#L422-L449 Friendly name : Main Summary Active Addons sample_id Metadata Description : Stably hash a client_id to an integer between 0 and 99. This function is technically defined in SQL, but it calls a JS UDF implementation of a CRC-32 hash, so we defined it here to make it clear that its performance may be limited by BigQuery's JavaScript UDF environment. Friendly name : Sample Id gunzip Metadata Description : Unzips a GZIP string. This implementation relies on the zlib.js library (https://github.com/imaya/zlib.js) and the atob function for decoding base64. Friendly name : Gunzip","title":"udf_js"},{"location":"moz-fx-data-shared-prod/udf_js/#jackknife_sum_ci","text":"","title":"jackknife_sum_ci"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata","text":"Description : Calculates a confidence interval using a jackknife resampling technique for the sum of an array of counts for various buckets; see https://en.wikipedia.org/wiki/Jackknife_resampling Users must specify the number of expected buckets as the first parameter to guard against the case where empty buckets lead to an array with missing elements. Usage generally involves first calculating an aggregate count per bucket, then aggregating over buckets, passing ARRAY_AGG(metric) to this function. Example: WITH bucketed AS ( SELECT submission_date, SUM(dau) AS dau_sum FROM mytable GROUP BY submission_date, bucket_id ) SELECT submission_date, udf_js.jackknife_sum_ci(ARRAY_AGG(dau_sum)).* FROM bucketed GROUP BY submission_date Friendly name : Jackknife Sum Ci","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#json_extract_keyed_histogram","text":"","title":"json_extract_keyed_histogram"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_1","text":"Description : Returns an array of parsed structs from a JSON string representing a keyed histogram. This is likely only useful for histograms that weren't properly parsed to fields, so ended up embedded in an additional_properties JSON blob. Normally, keyed histograms will be modeled as a key/value struct where the values are JSON representations of single histograms. There is no pure SQL equivalent to this function, since BigQuery does not provide any functions for listing or iterating over keysn in a JSON map. Friendly name : Json Extract Keyed Histogram","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#main_summary_addon_scalars","text":"","title":"main_summary_addon_scalars"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_2","text":"Description : Parse scalars from payload.processes.dynamic into map columns for each value type. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c00df191501b39d2c4e2ece3fe703a0ef3/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L385-L399 Friendly name : Main Summary Addon Scalars","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#jackknife_ratio_ci","text":"","title":"jackknife_ratio_ci"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_3","text":"Description : Calculates a confidence interval using a jackknife resampling technique for the weighted mean of an array of ratios for various buckets; see https://en.wikipedia.org/wiki/Jackknife_resampling Users must specify the number of expected buckets as the first parameter to guard against the case where empty buckets lead to an array with missing elements. Usage generally involves first calculating an aggregate per bucket, then aggregating over buckets, passing ARRAY_AGG(metric) to this function. Example: WITH bucketed AS ( SELECT submission_date, SUM(active_days_in_week) AS active_days_in_week, SUM(wau) AS wau FROM mytable GROUP BY submission_date, bucket_id ) SELECT submission_date, udf_js.jackknife_ratio_ci(20, ARRAY_AGG(STRUCT(CAST(active_days_in_week AS float64), CAST(wau as FLOAT64)))) AS intensity FROM bucketed GROUP BY submission_date Friendly name : Jackknife Ratio Ci","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#json_extract_events","text":"","title":"json_extract_events"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_4","text":"Description : Friendly name : Json Extract Events","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#json_extract_missing_cols","text":"","title":"json_extract_missing_cols"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_5","text":"Description : Extract missing columns from additional properties. More generally, get a list of nodes from a JSON blob. Array elements are indicated as [...]. param input: The JSON blob to explode param indicates_node: An array of strings. If a key's value is an object, and contains one of these values, that key is returned as a node. param known_nodes: An array of strings. If a key is in this array, it is returned as a node. Notes: - Use indicates_node for things like histograms. For example ['histogram_type'] will ensure that each histogram will be returned as a missing node, rather than the subvalues within the histogram (e.g. values, sum, etc.) - Use known_nodes if you're aware of a missing section, like ['simpleMeasurements'] See here for an example usage https://sql.telemetry.mozilla.org/queries/64460/source Friendly name : Json Extract Missing Cols","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#crc32","text":"","title":"crc32"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_6","text":"Description : Calculate the CRC-32 hash of an input string. The implementation here could be optimized. In particular, it calculates a lookup table on every invocation which could be cached and reused. In practice, though, this implementation appears to be fast enough that further optimization is not yet warranted. Based on https://stackoverflow.com/a/18639999/1260237 See https://en.wikipedia.org/wiki/Cyclic_redundancy_check Friendly name : CRC-32","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#jackknife_mean_ci","text":"","title":"jackknife_mean_ci"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_7","text":"Description : Calculates a confidence interval using a jackknife resampling technique for the mean of an array of values for various buckets; see https://en.wikipedia.org/wiki/Jackknife_resampling Users must specify the number of expected buckets as the first parameter to guard against the case where empty buckets lead to an array with missing elements. Usage generally involves first calculating an aggregate per bucket, then aggregating over buckets, passing ARRAY_AGG(metric) to this function. Friendly name : Jackknife Mean Ci","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#main_summary_disabled_addons","text":"","title":"main_summary_disabled_addons"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_8","text":"Description : Report the ids of the addons which are in the addonDetails but not in the activeAddons. They are the disabled addons (possibly because they are legacy). We need this as addonDetails may contain both disabled and active addons. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c00df191501b39d2c4e2ece3fe703a0ef3/src/main/scala/com/mozilla/telemetry/views/MainSummaryView.scala#L451-L464 Friendly name : Main Summary Disabled Addons","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#json_extract_histogram","text":"","title":"json_extract_histogram"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_9","text":"Description : Returns a parsed struct from a JSON string representing a histogram. This implementation uses JavaScript and is provided for performance comparison; see udf/udf_json_extract_histogram for a pure SQL implementation that will likely be more usable in practice. Friendly name : Json Extract Histogram","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#main_summary_active_addons","text":"","title":"main_summary_active_addons"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_10","text":"Description : Add fields from additional_attributes to active_addons in main_v4. Return an array instead of a \"map\" for backwards compatibility. The INT64 columns from BigQuery may be passed as strings, so parseInt before returning them if they will be coerced to BOOL. The fields from additional_attributes due to union types: integer or boolean for foreignInstall and userDisabled; string or number for version. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c00df191501b39d2c4e2ece3fe703a0ef3/src/main/scala/com/mozilla/telemetry/views/MainSummaryView.scala#L422-L449 Friendly name : Main Summary Active Addons","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#sample_id","text":"","title":"sample_id"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_11","text":"Description : Stably hash a client_id to an integer between 0 and 99. This function is technically defined in SQL, but it calls a JS UDF implementation of a CRC-32 hash, so we defined it here to make it clear that its performance may be limited by BigQuery's JavaScript UDF environment. Friendly name : Sample Id","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js/#gunzip","text":"","title":"gunzip"},{"location":"moz-fx-data-shared-prod/udf_js/#metadata_12","text":"Description : Unzips a GZIP string. This implementation relies on the zlib.js library (https://github.com/imaya/zlib.js) and the atob function for decoding base64. Friendly name : Gunzip","title":"Metadata"},{"location":"moz-fx-data-shared-prod/udf_js_lib/","text":"udf_js_lib","title":"udf_js_lib"},{"location":"moz-fx-data-shared-prod/udf_js_lib/#udf_js_lib","text":"","title":"udf_js_lib"},{"location":"moz-fx-data-shared-prod/udf_legacy/","text":"udf_legacy","title":"udf_legacy"},{"location":"moz-fx-data-shared-prod/udf_legacy/#udf_legacy","text":"","title":"udf_legacy"},{"location":"mozfun/about/","text":"mozfun mozfun is a public GCP project provisioning publicly accessible user-defined functions (UDFs) and other function-like resources.","title":"mozfun"},{"location":"mozfun/about/#mozfun","text":"mozfun is a public GCP project provisioning publicly accessible user-defined functions (UDFs) and other function-like resources.","title":"mozfun"},{"location":"mozfun/bits28/","text":"bits28 The bits28 functions provide an API for working with \"bit pattern\" INT64 fields, as used in the clients_last_seen dataset for desktop Firefox and similar datasets for other applications. A powerful feature of the clients_last_seen methodology is that it doesn't record specific metrics like MAU and WAU directly, but rather each row stores a history of the discrete days on which a client was active in the past 28 days. We could calculate active users in a 10 day or 25 day window just as efficiently as a 7 day (WAU) or 28 day (MAU) window. But we can also define completely new metrics based on these usage histories, such as various retention definitions. The usage history is encoded as a \"bit pattern\" where the physical type of the field is a BigQuery INT64, but logically the integer represents an array of bits, with each 1 indicating a day where the given clients was active and each 0 indicating a day where the client was inactive. to_string (UDF) Convert an INT64 field into a 28-character string representing the individual bits. Implementation based on https://stackoverflow.com/a/51600210/1260237 See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference SELECT [mozfun.bits28.to_string(1), mozfun.bits28.to_string(2), mozfun.bits28.to_string(3)] -- >>> ['0000000000000000000000000001', -- '0000000000000000000000000010', -- '0000000000000000000000000011'] Source | Edit days_since_seen (UDF) Return the position of the rightmost set bit in an INT64 bit pattern. To determine this position, we take a bitwise AND of the bit pattern and its complement, then we determine the position of the bit via base-2 logarithm; see https://stackoverflow.com/a/42747608/1260237 See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference SELECT mozfun.bits28.days_since_seen(18) -- >> 1 Source | Edit retention (UDF) Return a nested struct providing booleans indicating whether a given client was active various time periods based on the passed bit pattern. Source | Edit active_in_range (UDF) Return a boolean indicating if any bits are set in the specified range of a bit pattern. The start_offset must be zero or a negative number indicating an offset from the rightmost bit in the pattern. n_bits is the number of bits to consider, counting right from the bit at start_offset . See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference Source | Edit to_dates (UDF) Convert a bit pattern into an array of the dates is represents. See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference Source | Edit range (UDF) Return an INT64 representing a range of bits from a source bit pattern. The start_offset must be zero or a negative number indicating an offset from the rightmost bit in the pattern. n_bits is the number of bits to consider, counting right from the bit at start_offset. See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference SELECT -- Signature is bits28.range(offset_to_day_0, start_bit, number_of_bits) mozfun.bits28.range(days_seen_bits, -13 + 0, 7) AS week_0_bits, mozfun.bits28.range(days_seen_bits, -13 + 7, 7) AS week_1_bits FROM telemetry.clients_last_seen WHERE submission_date > '2020-01-01' Source | Edit from_string (UDF) Convert a string representing individual bits into an INT64. Implementation based on https://stackoverflow.com/a/51600210/1260237 See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference Source | Edit","title":"bits28"},{"location":"mozfun/bits28/#bits28","text":"The bits28 functions provide an API for working with \"bit pattern\" INT64 fields, as used in the clients_last_seen dataset for desktop Firefox and similar datasets for other applications. A powerful feature of the clients_last_seen methodology is that it doesn't record specific metrics like MAU and WAU directly, but rather each row stores a history of the discrete days on which a client was active in the past 28 days. We could calculate active users in a 10 day or 25 day window just as efficiently as a 7 day (WAU) or 28 day (MAU) window. But we can also define completely new metrics based on these usage histories, such as various retention definitions. The usage history is encoded as a \"bit pattern\" where the physical type of the field is a BigQuery INT64, but logically the integer represents an array of bits, with each 1 indicating a day where the given clients was active and each 0 indicating a day where the client was inactive.","title":"bits28"},{"location":"mozfun/bits28/#to_string-udf","text":"Convert an INT64 field into a 28-character string representing the individual bits. Implementation based on https://stackoverflow.com/a/51600210/1260237 See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference SELECT [mozfun.bits28.to_string(1), mozfun.bits28.to_string(2), mozfun.bits28.to_string(3)] -- >>> ['0000000000000000000000000001', -- '0000000000000000000000000010', -- '0000000000000000000000000011'] Source | Edit","title":"to_string (UDF)"},{"location":"mozfun/bits28/#days_since_seen-udf","text":"Return the position of the rightmost set bit in an INT64 bit pattern. To determine this position, we take a bitwise AND of the bit pattern and its complement, then we determine the position of the bit via base-2 logarithm; see https://stackoverflow.com/a/42747608/1260237 See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference SELECT mozfun.bits28.days_since_seen(18) -- >> 1 Source | Edit","title":"days_since_seen (UDF)"},{"location":"mozfun/bits28/#retention-udf","text":"Return a nested struct providing booleans indicating whether a given client was active various time periods based on the passed bit pattern. Source | Edit","title":"retention (UDF)"},{"location":"mozfun/bits28/#active_in_range-udf","text":"Return a boolean indicating if any bits are set in the specified range of a bit pattern. The start_offset must be zero or a negative number indicating an offset from the rightmost bit in the pattern. n_bits is the number of bits to consider, counting right from the bit at start_offset . See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference Source | Edit","title":"active_in_range (UDF)"},{"location":"mozfun/bits28/#to_dates-udf","text":"Convert a bit pattern into an array of the dates is represents. See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference Source | Edit","title":"to_dates (UDF)"},{"location":"mozfun/bits28/#range-udf","text":"Return an INT64 representing a range of bits from a source bit pattern. The start_offset must be zero or a negative number indicating an offset from the rightmost bit in the pattern. n_bits is the number of bits to consider, counting right from the bit at start_offset. See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference SELECT -- Signature is bits28.range(offset_to_day_0, start_bit, number_of_bits) mozfun.bits28.range(days_seen_bits, -13 + 0, 7) AS week_0_bits, mozfun.bits28.range(days_seen_bits, -13 + 7, 7) AS week_1_bits FROM telemetry.clients_last_seen WHERE submission_date > '2020-01-01' Source | Edit","title":"range (UDF)"},{"location":"mozfun/bits28/#from_string-udf","text":"Convert a string representing individual bits into an INT64. Implementation based on https://stackoverflow.com/a/51600210/1260237 See detailed docs for the bits28 suite of functions: https://docs.telemetry.mozilla.org/cookbooks/clients_last_seen_bits.html#udf-reference Source | Edit","title":"from_string (UDF)"},{"location":"mozfun/event_analysis/","text":"event_analysis These functions are specific for use with the events_daily and event_types tables. By themselves, these two tables are nearly impossible to use since the event history is compressed; however, these stored procedures should make the data accessible. The events_daily table is created as a result of two steps: 1. Map each event to a single UTF8 char which will represent it 2. Group each client-day and store a string that records, using the compressed format, that clients' event history for that day. The characters are ordered by the timestamp which they appeared that day. The best way to access this data is to create a view to do the heavy lifting. For example, to see which clients completed a certain action, you can create a view using these functions that knows what that action's representation is (using the compressed mapping from 1.) and create a regex string that checks for the presence of that event. The view makes this transparent, and allows users to simply query a boolean field representing the presence of that event on that day. create_events_view (Stored Procedure) Create a view that queries the events_daily table. This view currently supports both funnels and event counts. Funnels are created as a struct, with each step in the funnel as a boolean column in the struct, indicating whether the user completed that step on that day. Event counts are simply integers. Usage create_events_view( view_name STRING, project STRING, dataset STRING, funnels ARRAY<STRUCT< funnel_name STRING, funnel ARRAY<STRUCT< step_name STRING, events ARRAY<STRUCT< category STRING, event_name STRING>>>>>>, counts ARRAY<STRUCT< count_name STRING, events ARRAY<STRUCT< category STRING, event_name STRING>>>> ) view_name : The name of the view that will be created. This view will be in the shared-prod project, in the analysis bucket, and so will be queryable at: sql `moz-fx-data-shared-prod`.analysis.{view_name} project : The project where the dataset is located. dataset : The dataset that must contain both the events_daily and event_types tables. funnels : An array of funnels that will be created. Each funnel has two parts: funnel_name : The name of the funnel is what the column representing the funnel will be named in the view. For example, with the value \"onboarding\" , the view can be selected as follows: sql SELECT onboarding FROM `moz-fx-data-shared-prod`.analysis.{view_name} funnel : The ordered series of steps that make up a funnel. Each step also has: step_name : Used to name the column within the funnel and represents whether the user completed that step on that day. For example, within onboarding a user may have completed_first_card as a step; this can be queried at sql SELECT onboarding.completed_first_step FROM `moz-fx-data-shared-prod`.analysis.{view_name} events : The set of events which indicate the user completed that step of the funnel. Most of the time this is a single event. Each event has a category and event_name . counts : An array of counts. Each count has two parts, similar to funnel steps: count_name : Used to name the column representing the event count. E.g. \"clicked_settings_count\" would be queried at sql SELECT clicked_settings_count FROM `moz-fx-data-shared-prod`.analysis.{view_name} events : The set of events you want to count. Each event has a category and event_name . Recommended Pattern Because the view definitions themselves are not informative about the contents of the events fields, it is best to put your query immediately after the procedure invocation, rather than invoking the procedure and running a separate query. This STMO query is an example of doing so. This allows viewers of the query to easily interpret what the funnel and count columns represent. Structure of the Resulting View The view will be created at `moz-fx-data-shared-prod`.analysis.{event_name}. The view will have a schema roughly matching the following: root |-- submission_date: date |-- client_id: string |-- {funnel_1_name}: record | |-- {funnel_step_1_name} boolean | |-- {funnel_step_2_name} boolean ... |-- {funnel_N_name}: record | |-- {funnel_step_M_name}: boolean |-- {count_1_name}: integer ... |-- {count_N_name}: integer ...dimensions... Funnels Each funnel will be a STRUCT with nested columns representing completion of each step The types of those columns are boolean, and represent whether the user completed that step on that day. STRUCT( completed_step_1 BOOLEAN, completed_step_2 BOOLEAN, ... ) AS funnel_name With one row per-user per-day, you can use COUNTIF(funnel_name.completed_step_N) to query these fields. See below for an example. Event Counts Each event count is simply an INT64 representing the number of times the user completed those events on that day. If there are multiple events represented within one count, the values are summed. For example, if you wanted to know the number of times a user opened or closed the app, you could create a single event count with those two events. event_count_name INT64 Examples The following creates a few fields: - collection_flow is a funnel for those that started creating a collection within Fenix, and then finished, either by adding those tabs to an existing collection or saving it as a new collection. - collection_flow_saved represents users who started the collection flow then saved it as a new collection. - number_of_collections_created is the number of collections created - number_of_collections_deleted is the number of collections deleted CALL mozfun.event_analysis.create_events_view( 'fenix_collection_funnels', 'moz-fx-data-shared-prod', 'org_mozilla_firefox', -- Funnels [ STRUCT( \"collection_flow\" AS funnel_name, [STRUCT( \"started_collection_creation\" AS step_name, [STRUCT('collections' AS category, 'tab_select_opened' AS event_name)] AS events), STRUCT( \"completed_collection_creation\" AS step_name, [STRUCT('collections' AS category, 'saved' AS event_name), STRUCT('collections' AS category, 'tabs_added' AS event_name)] AS events) ] AS funnel), STRUCT( \"collection_flow_saved\" AS funnel_name, [STRUCT( \"started_collection_creation\" AS step_name, [STRUCT('collections' AS category, 'tab_select_opened' AS event_name)] AS events), STRUCT( \"saved_collection\" AS step_name, [STRUCT('collections' AS category, 'saved' AS event_name)] AS events) ] AS funnel) ], -- Event Counts [ STRUCT( \"number_of_collections_created\" AS count_name, [STRUCT('collections' AS category, 'saved' AS event_name)] AS events ), STRUCT( \"number_of_collections_deleted\" AS count_name, [STRUCT('collections' AS category, 'removed' AS event_name)] AS events ) ] ); From there, you can query a few things. For example, the fraction of users who completed each step of the collection flow over time: SELECT submission_date, COUNTIF(collection_flow.started_collection_creation) / COUNT(*) AS started_collection_creation, COUNTIF(collection_flow.completed_collection_creation) / COUNT(*) AS completed_collection_creation, FROM `moz-fx-data-shared-prod`.analysis.fenix_collection_funnels WHERE submission_date >= DATE_SUB(current_date, INTERVAL 28 DAY) GROUP BY submission_date Or you can see the number of collections created and deleted: SELECT submission_date, SUM(number_of_collections_created) AS number_of_collections_created, SUM(number_of_collections_deleted) AS number_of_collections_deleted, FROM `moz-fx-data-shared-prod`.analysis.fenix_collection_funnels WHERE submission_date >= DATE_SUB(current_date, INTERVAL 28 DAY) GROUP BY submission_date Source | Edit extract_event_counts (UDF) Extract the events and their counts from an events string. This function explicitly ignores event properties, and retrieves just the counts of the top-level events. Usage extract_event_counts( events STRING ) events - A comma-separated events string, where each event is represented as a string of unicode chars. Example See this dashboard for example usage. Source | Edit extract_event_counts_with_properties (UDF) Extract events with event properties and their associated counts. Also extracts raw events and their counts. This allows for querying with and without properties in the same dashboard. Usage extract_event_counts_with_properties( events STRING ) events - A comma-separated events string, where each event is represented as a string of unicode chars. Example See this query for example usage. Caveats This function extracts both counts for events with each property, and for all events without their properties. This allows us to include both total counts for an event (with any property value), and events that don't have properties. Source | Edit","title":"event_analysis"},{"location":"mozfun/event_analysis/#event_analysis","text":"These functions are specific for use with the events_daily and event_types tables. By themselves, these two tables are nearly impossible to use since the event history is compressed; however, these stored procedures should make the data accessible. The events_daily table is created as a result of two steps: 1. Map each event to a single UTF8 char which will represent it 2. Group each client-day and store a string that records, using the compressed format, that clients' event history for that day. The characters are ordered by the timestamp which they appeared that day. The best way to access this data is to create a view to do the heavy lifting. For example, to see which clients completed a certain action, you can create a view using these functions that knows what that action's representation is (using the compressed mapping from 1.) and create a regex string that checks for the presence of that event. The view makes this transparent, and allows users to simply query a boolean field representing the presence of that event on that day.","title":"event_analysis"},{"location":"mozfun/event_analysis/#create_events_view-stored-procedure","text":"Create a view that queries the events_daily table. This view currently supports both funnels and event counts. Funnels are created as a struct, with each step in the funnel as a boolean column in the struct, indicating whether the user completed that step on that day. Event counts are simply integers.","title":"create_events_view (Stored Procedure)"},{"location":"mozfun/event_analysis/#usage","text":"create_events_view( view_name STRING, project STRING, dataset STRING, funnels ARRAY<STRUCT< funnel_name STRING, funnel ARRAY<STRUCT< step_name STRING, events ARRAY<STRUCT< category STRING, event_name STRING>>>>>>, counts ARRAY<STRUCT< count_name STRING, events ARRAY<STRUCT< category STRING, event_name STRING>>>> ) view_name : The name of the view that will be created. This view will be in the shared-prod project, in the analysis bucket, and so will be queryable at: sql `moz-fx-data-shared-prod`.analysis.{view_name} project : The project where the dataset is located. dataset : The dataset that must contain both the events_daily and event_types tables. funnels : An array of funnels that will be created. Each funnel has two parts: funnel_name : The name of the funnel is what the column representing the funnel will be named in the view. For example, with the value \"onboarding\" , the view can be selected as follows: sql SELECT onboarding FROM `moz-fx-data-shared-prod`.analysis.{view_name} funnel : The ordered series of steps that make up a funnel. Each step also has: step_name : Used to name the column within the funnel and represents whether the user completed that step on that day. For example, within onboarding a user may have completed_first_card as a step; this can be queried at sql SELECT onboarding.completed_first_step FROM `moz-fx-data-shared-prod`.analysis.{view_name} events : The set of events which indicate the user completed that step of the funnel. Most of the time this is a single event. Each event has a category and event_name . counts : An array of counts. Each count has two parts, similar to funnel steps: count_name : Used to name the column representing the event count. E.g. \"clicked_settings_count\" would be queried at sql SELECT clicked_settings_count FROM `moz-fx-data-shared-prod`.analysis.{view_name} events : The set of events you want to count. Each event has a category and event_name .","title":"Usage"},{"location":"mozfun/event_analysis/#recommended-pattern","text":"Because the view definitions themselves are not informative about the contents of the events fields, it is best to put your query immediately after the procedure invocation, rather than invoking the procedure and running a separate query. This STMO query is an example of doing so. This allows viewers of the query to easily interpret what the funnel and count columns represent.","title":"Recommended Pattern"},{"location":"mozfun/event_analysis/#structure-of-the-resulting-view","text":"The view will be created at `moz-fx-data-shared-prod`.analysis.{event_name}. The view will have a schema roughly matching the following: root |-- submission_date: date |-- client_id: string |-- {funnel_1_name}: record | |-- {funnel_step_1_name} boolean | |-- {funnel_step_2_name} boolean ... |-- {funnel_N_name}: record | |-- {funnel_step_M_name}: boolean |-- {count_1_name}: integer ... |-- {count_N_name}: integer ...dimensions...","title":"Structure of the Resulting View"},{"location":"mozfun/event_analysis/#funnels","text":"Each funnel will be a STRUCT with nested columns representing completion of each step The types of those columns are boolean, and represent whether the user completed that step on that day. STRUCT( completed_step_1 BOOLEAN, completed_step_2 BOOLEAN, ... ) AS funnel_name With one row per-user per-day, you can use COUNTIF(funnel_name.completed_step_N) to query these fields. See below for an example.","title":"Funnels"},{"location":"mozfun/event_analysis/#event-counts","text":"Each event count is simply an INT64 representing the number of times the user completed those events on that day. If there are multiple events represented within one count, the values are summed. For example, if you wanted to know the number of times a user opened or closed the app, you could create a single event count with those two events. event_count_name INT64","title":"Event Counts"},{"location":"mozfun/event_analysis/#examples","text":"The following creates a few fields: - collection_flow is a funnel for those that started creating a collection within Fenix, and then finished, either by adding those tabs to an existing collection or saving it as a new collection. - collection_flow_saved represents users who started the collection flow then saved it as a new collection. - number_of_collections_created is the number of collections created - number_of_collections_deleted is the number of collections deleted CALL mozfun.event_analysis.create_events_view( 'fenix_collection_funnels', 'moz-fx-data-shared-prod', 'org_mozilla_firefox', -- Funnels [ STRUCT( \"collection_flow\" AS funnel_name, [STRUCT( \"started_collection_creation\" AS step_name, [STRUCT('collections' AS category, 'tab_select_opened' AS event_name)] AS events), STRUCT( \"completed_collection_creation\" AS step_name, [STRUCT('collections' AS category, 'saved' AS event_name), STRUCT('collections' AS category, 'tabs_added' AS event_name)] AS events) ] AS funnel), STRUCT( \"collection_flow_saved\" AS funnel_name, [STRUCT( \"started_collection_creation\" AS step_name, [STRUCT('collections' AS category, 'tab_select_opened' AS event_name)] AS events), STRUCT( \"saved_collection\" AS step_name, [STRUCT('collections' AS category, 'saved' AS event_name)] AS events) ] AS funnel) ], -- Event Counts [ STRUCT( \"number_of_collections_created\" AS count_name, [STRUCT('collections' AS category, 'saved' AS event_name)] AS events ), STRUCT( \"number_of_collections_deleted\" AS count_name, [STRUCT('collections' AS category, 'removed' AS event_name)] AS events ) ] ); From there, you can query a few things. For example, the fraction of users who completed each step of the collection flow over time: SELECT submission_date, COUNTIF(collection_flow.started_collection_creation) / COUNT(*) AS started_collection_creation, COUNTIF(collection_flow.completed_collection_creation) / COUNT(*) AS completed_collection_creation, FROM `moz-fx-data-shared-prod`.analysis.fenix_collection_funnels WHERE submission_date >= DATE_SUB(current_date, INTERVAL 28 DAY) GROUP BY submission_date Or you can see the number of collections created and deleted: SELECT submission_date, SUM(number_of_collections_created) AS number_of_collections_created, SUM(number_of_collections_deleted) AS number_of_collections_deleted, FROM `moz-fx-data-shared-prod`.analysis.fenix_collection_funnels WHERE submission_date >= DATE_SUB(current_date, INTERVAL 28 DAY) GROUP BY submission_date Source | Edit","title":"Examples"},{"location":"mozfun/event_analysis/#extract_event_counts-udf","text":"Extract the events and their counts from an events string. This function explicitly ignores event properties, and retrieves just the counts of the top-level events.","title":"extract_event_counts (UDF)"},{"location":"mozfun/event_analysis/#usage_1","text":"extract_event_counts( events STRING ) events - A comma-separated events string, where each event is represented as a string of unicode chars.","title":"Usage"},{"location":"mozfun/event_analysis/#example","text":"See this dashboard for example usage. Source | Edit","title":"Example"},{"location":"mozfun/event_analysis/#extract_event_counts_with_properties-udf","text":"Extract events with event properties and their associated counts. Also extracts raw events and their counts. This allows for querying with and without properties in the same dashboard.","title":"extract_event_counts_with_properties (UDF)"},{"location":"mozfun/event_analysis/#usage_2","text":"extract_event_counts_with_properties( events STRING ) events - A comma-separated events string, where each event is represented as a string of unicode chars.","title":"Usage"},{"location":"mozfun/event_analysis/#example_1","text":"See this query for example usage.","title":"Example"},{"location":"mozfun/event_analysis/#caveats","text":"This function extracts both counts for events with each property, and for all events without their properties. This allows us to include both total counts for an event (with any property value), and events that don't have properties. Source | Edit","title":"Caveats"},{"location":"mozfun/glean/","text":"glean Functions for working with Glean data. timespan_seconds (UDF) Returns the number of seconds represented by a Glean timespan struct, rounded down to full seconds. See https://mozilla.github.io/glean/book/user/metrics/timespan.html Source | Edit timespan_nanos (UDF) Returns the number of nanoseconds represented by a Glean timespan struct. See https://mozilla.github.io/glean/book/user/metrics/timespan.html Source | Edit","title":"glean"},{"location":"mozfun/glean/#glean","text":"Functions for working with Glean data.","title":"glean"},{"location":"mozfun/glean/#timespan_seconds-udf","text":"Returns the number of seconds represented by a Glean timespan struct, rounded down to full seconds. See https://mozilla.github.io/glean/book/user/metrics/timespan.html Source | Edit","title":"timespan_seconds (UDF)"},{"location":"mozfun/glean/#timespan_nanos-udf","text":"Returns the number of nanoseconds represented by a Glean timespan struct. See https://mozilla.github.io/glean/book/user/metrics/timespan.html Source | Edit","title":"timespan_nanos (UDF)"},{"location":"mozfun/hist/","text":"hist Functions for working with string encodings of histograms from desktop telemetry. mean (UDF) Given histogram h, return floor(mean) of the measurements in the bucket. That is, the histogram sum divided by the number of measurements taken. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L292-L307 Source | Edit merge (UDF) Merge an array of histograms into a single histogram. The histogram values will be summed per-bucket The count will be summed Other fields will take the mode_last Source | Edit normalize (UDF) Normalize a histogram. Set sum to 1, and normalize to 1 the histogram bucket counts. Source | Edit percentiles (UDF) Given histogram and list of percentiles,calculate what those percentiles are for the histogram. If the histogram is empty, returns NULL. Source | Edit threshold_count (UDF) Return the number of recorded observations greater than threshold for the histogram. CAUTION: Does not count any buckets that have any values less than the threshold. For example, a bucket with range (1, 10) will not be counted for a threshold of 2. Use threshold that are not bucket boundaries with caution. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L213-L239 Source | Edit extract (UDF) Return a parsed struct from a string-encoded histogram. We support a variety of compact encodings as well as the classic JSON representation as sent in main pings. The built-in BigQuery JSON parsing functions are not powerful enough to handle all the logic here, so we resort to some string processing. This function could behave unexpectedly on poorly-formatted histogram JSON, but we expect that payload validation in the data pipeline should ensure that histograms are well formed, which gives us some flexibility. For more on desktop telemetry histogram structure, see: https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/collection/histograms.html The compact encodings were originally proposed in: https://docs.google.com/document/d/1k_ji_1DB6htgtXnPpMpa7gX0klm-DGV5NMY7KkvVB00/edit# SELECT mozfun.hist.extract( '{\"bucket_count\":3,\"histogram_type\":4,\"sum\":1,\"range\":[1,2],\"values\":{\"0\":1,\"1\":0}}' ).sum -- 1 SELECT mozfun.hist.extract('5').sum -- 5 Source | Edit string_to_json (UDF) Convert a histogram string (in JSON or compact format) to a full histogram JSON blob. Source | Edit","title":"hist"},{"location":"mozfun/hist/#hist","text":"Functions for working with string encodings of histograms from desktop telemetry.","title":"hist"},{"location":"mozfun/hist/#mean-udf","text":"Given histogram h, return floor(mean) of the measurements in the bucket. That is, the histogram sum divided by the number of measurements taken. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L292-L307 Source | Edit","title":"mean (UDF)"},{"location":"mozfun/hist/#merge-udf","text":"Merge an array of histograms into a single histogram. The histogram values will be summed per-bucket The count will be summed Other fields will take the mode_last Source | Edit","title":"merge (UDF)"},{"location":"mozfun/hist/#normalize-udf","text":"Normalize a histogram. Set sum to 1, and normalize to 1 the histogram bucket counts. Source | Edit","title":"normalize (UDF)"},{"location":"mozfun/hist/#percentiles-udf","text":"Given histogram and list of percentiles,calculate what those percentiles are for the histogram. If the histogram is empty, returns NULL. Source | Edit","title":"percentiles (UDF)"},{"location":"mozfun/hist/#threshold_count-udf","text":"Return the number of recorded observations greater than threshold for the histogram. CAUTION: Does not count any buckets that have any values less than the threshold. For example, a bucket with range (1, 10) will not be counted for a threshold of 2. Use threshold that are not bucket boundaries with caution. https://github.com/mozilla/telemetry-batch-view/blob/ea0733c/src/main/scala/com/mozilla/telemetry/utils/MainPing.scala#L213-L239 Source | Edit","title":"threshold_count (UDF)"},{"location":"mozfun/hist/#extract-udf","text":"Return a parsed struct from a string-encoded histogram. We support a variety of compact encodings as well as the classic JSON representation as sent in main pings. The built-in BigQuery JSON parsing functions are not powerful enough to handle all the logic here, so we resort to some string processing. This function could behave unexpectedly on poorly-formatted histogram JSON, but we expect that payload validation in the data pipeline should ensure that histograms are well formed, which gives us some flexibility. For more on desktop telemetry histogram structure, see: https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/collection/histograms.html The compact encodings were originally proposed in: https://docs.google.com/document/d/1k_ji_1DB6htgtXnPpMpa7gX0klm-DGV5NMY7KkvVB00/edit# SELECT mozfun.hist.extract( '{\"bucket_count\":3,\"histogram_type\":4,\"sum\":1,\"range\":[1,2],\"values\":{\"0\":1,\"1\":0}}' ).sum -- 1 SELECT mozfun.hist.extract('5').sum -- 5 Source | Edit","title":"extract (UDF)"},{"location":"mozfun/hist/#string_to_json-udf","text":"Convert a histogram string (in JSON or compact format) to a full histogram JSON blob. Source | Edit","title":"string_to_json (UDF)"},{"location":"mozfun/json/","text":"json Functions for parsing Mozilla-specific JSON data types. mode_last (UDF) Returns the most frequently occuring element in an array of json-compatible elements. In the case of multiple values tied for the highest count, it returns the value that appears latest in the array. Nulls are ignored. Source | Edit extract_int_map (UDF) Returns an array of key/value structs from a string representing a JSON map. Both keys and values are cast to integers. This is the format for the \"values\" field in the desktop telemetry histogram JSON representation. Source | Edit","title":"json"},{"location":"mozfun/json/#json","text":"Functions for parsing Mozilla-specific JSON data types.","title":"json"},{"location":"mozfun/json/#mode_last-udf","text":"Returns the most frequently occuring element in an array of json-compatible elements. In the case of multiple values tied for the highest count, it returns the value that appears latest in the array. Nulls are ignored. Source | Edit","title":"mode_last (UDF)"},{"location":"mozfun/json/#extract_int_map-udf","text":"Returns an array of key/value structs from a string representing a JSON map. Both keys and values are cast to integers. This is the format for the \"values\" field in the desktop telemetry histogram JSON representation. Source | Edit","title":"extract_int_map (UDF)"},{"location":"mozfun/map/","text":"map Functions for working with arrays of key/value structs. get_key_with_null (UDF) Fetch the value associated with a given key from an array of key/value structs. Because map types aren't available in BigQuery, we model maps as arrays of structs instead, and this function provides map-like access to such fields. This version matches NULL keys as well. Source | Edit mode_last (UDF) Combine entries from multiple maps, determine the value for each key using mozfun.stats.mode_last. Source | Edit sum (UDF) Return the sum of values by key in an array of map entries. The expected schema for entries is ARRAY >, where the type for value must be supported by SUM, which allows numeric data types INT64, NUMERIC, and FLOAT64. Source | Edit get_key (UDF) Fetch the value associated with a given key from an array of key/value structs. Because map types aren't available in BigQuery, we model maps as arrays of structs instead, and this function provides map-like access to such fields. Source | Edit","title":"map"},{"location":"mozfun/map/#map","text":"Functions for working with arrays of key/value structs.","title":"map"},{"location":"mozfun/map/#get_key_with_null-udf","text":"Fetch the value associated with a given key from an array of key/value structs. Because map types aren't available in BigQuery, we model maps as arrays of structs instead, and this function provides map-like access to such fields. This version matches NULL keys as well. Source | Edit","title":"get_key_with_null (UDF)"},{"location":"mozfun/map/#mode_last-udf","text":"Combine entries from multiple maps, determine the value for each key using mozfun.stats.mode_last. Source | Edit","title":"mode_last (UDF)"},{"location":"mozfun/map/#sum-udf","text":"Return the sum of values by key in an array of map entries. The expected schema for entries is ARRAY >, where the type for value must be supported by SUM, which allows numeric data types INT64, NUMERIC, and FLOAT64. Source | Edit","title":"sum (UDF)"},{"location":"mozfun/map/#get_key-udf","text":"Fetch the value associated with a given key from an array of key/value structs. Because map types aren't available in BigQuery, we model maps as arrays of structs instead, and this function provides map-like access to such fields. Source | Edit","title":"get_key (UDF)"},{"location":"mozfun/norm/","text":"norm Functions for normalizing data. glean_baseline_client_info (UDF) Accepts a glean client_info struct as input and returns a modified struct that includes a few parsed or normalized variants of the input fields. Source | Edit glean_ping_info (UDF) Accepts a glean ping_info struct as input and returns a modified struct that includes a few parsed or normalized variants of the input fields. Source | Edit product_info (UDF) Returns a normalized product name and a canonical_name for a product based on the raw app_name and normalized_os values that appear in pings. The returned product name is intended to be readable and unambiguous, but short and easy to type. This value is suitable for use as a key in derived tables. The returned canonical_name is more verbose and is suited for displaying in visualizations. The returned struct also contains boolean contributes_to_2020_kpi as the canonical reference for whether the given application is included in KPI reporting. Additional fields may be added for future years. The normalized_os value that's passed in should be the top-level normalized_os value present in any ping table or you may want to wrap a raw value in mozfun.norm.os like mozfun.norm.product_info(app_name, mozfun.norm.os(os)) . For legacy telemetry pings like main ping for desktop and core ping for mobile products, app_name should come from the submission URI (stored as metadata.uri.app_name in BigQuery ping tables). For Glean pings, the concept of an app_name doesn't exist, since pings from different applications are routed to different BigQuery datasets. Instead, the app_name send in for Glean pings should be the same value as what's expected for product . So, a view on top of pings from Fenix should pass in \"Fenix\" for app_name . This function also tolerates passing in a product value as app_name so that this function is still useful for derived tables which have thrown away the raw app_name value. The mappings are as follows: app_name normalized_os product canonical_name 2019 2020 Firefox * Firefox Firefox for Desktop true true Fenix Android Fenix Firefox for Android (Fenix) true true Fennec Android Fennec Firefox for Android (Fennec) true true Firefox Preview Android Firefox Preview Firefox Preview for Android true true Fennec iOS Firefox iOS Firefox for iOS true true FirefoxForFireTV Android Firefox Fire TV Firefox for Fire TV false false FirefoxConnect Android Firefox Echo Firefox for Echo Show true true Zerda Android Firefox Lite Firefox Lite true true Zerda_cn Android Firefox Lite CN Firefox Lite (China) false false Focus Android Focus Android Firefox Focus for Android true true Focus iOS Focus iOS Firefox Focus for iOS true true Klar Android Klar Android Firefox Klar for Android false false Klar iOS Klar iOS Firefox Klar for iOS false false Lockbox Android Lockwise Android Lockwise for Android true true Lockbox iOS Lockwise iOS Lockwise for iOS true true FirefoxReality* Android Firefox Reality Firefox Reality false false Source Edit os (UDF) Normalize an operating system string to one of the three major desktop platforms, one of the two major mobile platforms, or \"Other\". This is a reimplementation of logic used in the data pipeline > to populate normalized_os . Source | Edit metadata (UDF) Accepts a pipeline metadata struct as input and returns a modified struct that includes a few parsed or normalized variants of the input metadata fields. Source | Edit fenix_app_info (UDF) Returns canonical, human-understandable identification info for Fenix sources. The Glean telemetry library for Android by design routes pings based on the Play Store appId value of the published application. As of August 2020, there have been 5 separate Play Store appId values associated with different builds of Fenix, each corresponding to different datasets in BigQuery, and the mapping of appId to logical app names (Firefox vs. Firefox Preview) and channel names (nightly, beta, or release) has changed over time; see the spreadsheet of naming history for Mozilla's mobile browsers .> This function is intended as the source of truth for how to map a specific ping in BigQuery to a logical app names and channel. It should be expected that the output of this function may evolve over time. If we rename a product or channel, we may choose to update the values here so that analyses consistently get the new name. The first argument ( app_id ) can be fairly fuzzy; it is tolerant of actual Google Play Store appId values like 'org.mozilla.firefox_beta' (mix of periods and underscores) as well as BigQuery dataset names with suffixes like 'org_mozilla_firefox_beta_stable'. The second argument ( app_build_id ) should be the value in client_info.app_build. The function returns a STRUCT that contains the logical app_name and channel as well as the Play Store app_id in the canonical form which would appear in Play Store URLs. Note that the naming of Fenix applications changed on 2020-07-03, so to get a continuous view of the pings associated with a logical app channel, you may need to union together tables from multiple BigQuery datasets. To see data for all Fenix channels together, it is necessary to union together tables from all 5 datasets. For basic usage information, consider using telemetry.fenix_clients_last_seen which already handles the union. Otherwise, see the example below as a template for how construct a custom union. Mapping of channels to datasets: release: org_mozilla_firefox beta: org_mozilla_firefox_beta (current) and org_mozilla_fenix nightly: org_mozilla_fenix (current), org_mozilla_fennec_aurora , and org_mozilla_fenix_nightly -- Example of a query over all Fenix builds advertised as \"Firefox Beta\" CREATE TEMP FUNCTION extract_fields(app_id STRING, m ANY TYPE) AS ( ( SELECT AS STRUCT m.submission_timestamp, m.metrics.string.geckoview_version, mozfun.norm.fenix_app_info(app_id, m.client_info.app_build).* ) ); WITH base AS ( SELECT extract_fields('org_mozilla_firefox_beta', m).* FROM org_mozilla_firefox_beta.metrics AS m UNION ALL SELECT extract_fields('org_mozilla_fenix', m).* FROM org_mozilla_fenix.metrics AS m ) SELECT DATE(submission_timestamp) AS submission_date, geckoview_version, COUNT(*) FROM base WHERE app_name = 'Fenix' -- excludes 'Firefox Preview' AND channel = 'beta' AND DATE(submission_timestamp) = '2020-08-01' GROUP BY submission_date, geckoview_version Source | Edit","title":"norm"},{"location":"mozfun/norm/#norm","text":"Functions for normalizing data.","title":"norm"},{"location":"mozfun/norm/#glean_baseline_client_info-udf","text":"Accepts a glean client_info struct as input and returns a modified struct that includes a few parsed or normalized variants of the input fields. Source | Edit","title":"glean_baseline_client_info (UDF)"},{"location":"mozfun/norm/#glean_ping_info-udf","text":"Accepts a glean ping_info struct as input and returns a modified struct that includes a few parsed or normalized variants of the input fields. Source | Edit","title":"glean_ping_info (UDF)"},{"location":"mozfun/norm/#product_info-udf","text":"Returns a normalized product name and a canonical_name for a product based on the raw app_name and normalized_os values that appear in pings. The returned product name is intended to be readable and unambiguous, but short and easy to type. This value is suitable for use as a key in derived tables. The returned canonical_name is more verbose and is suited for displaying in visualizations. The returned struct also contains boolean contributes_to_2020_kpi as the canonical reference for whether the given application is included in KPI reporting. Additional fields may be added for future years. The normalized_os value that's passed in should be the top-level normalized_os value present in any ping table or you may want to wrap a raw value in mozfun.norm.os like mozfun.norm.product_info(app_name, mozfun.norm.os(os)) . For legacy telemetry pings like main ping for desktop and core ping for mobile products, app_name should come from the submission URI (stored as metadata.uri.app_name in BigQuery ping tables). For Glean pings, the concept of an app_name doesn't exist, since pings from different applications are routed to different BigQuery datasets. Instead, the app_name send in for Glean pings should be the same value as what's expected for product . So, a view on top of pings from Fenix should pass in \"Fenix\" for app_name . This function also tolerates passing in a product value as app_name so that this function is still useful for derived tables which have thrown away the raw app_name value. The mappings are as follows: app_name normalized_os product canonical_name 2019 2020 Firefox * Firefox Firefox for Desktop true true Fenix Android Fenix Firefox for Android (Fenix) true true Fennec Android Fennec Firefox for Android (Fennec) true true Firefox Preview Android Firefox Preview Firefox Preview for Android true true Fennec iOS Firefox iOS Firefox for iOS true true FirefoxForFireTV Android Firefox Fire TV Firefox for Fire TV false false FirefoxConnect Android Firefox Echo Firefox for Echo Show true true Zerda Android Firefox Lite Firefox Lite true true Zerda_cn Android Firefox Lite CN Firefox Lite (China) false false Focus Android Focus Android Firefox Focus for Android true true Focus iOS Focus iOS Firefox Focus for iOS true true Klar Android Klar Android Firefox Klar for Android false false Klar iOS Klar iOS Firefox Klar for iOS false false Lockbox Android Lockwise Android Lockwise for Android true true Lockbox iOS Lockwise iOS Lockwise for iOS true true FirefoxReality* Android Firefox Reality Firefox Reality false false Source Edit","title":"product_info (UDF)"},{"location":"mozfun/norm/#os-udf","text":"Normalize an operating system string to one of the three major desktop platforms, one of the two major mobile platforms, or \"Other\". This is a reimplementation of logic used in the data pipeline > to populate normalized_os . Source | Edit","title":"os (UDF)"},{"location":"mozfun/norm/#metadata-udf","text":"Accepts a pipeline metadata struct as input and returns a modified struct that includes a few parsed or normalized variants of the input metadata fields. Source | Edit","title":"metadata (UDF)"},{"location":"mozfun/norm/#fenix_app_info-udf","text":"Returns canonical, human-understandable identification info for Fenix sources. The Glean telemetry library for Android by design routes pings based on the Play Store appId value of the published application. As of August 2020, there have been 5 separate Play Store appId values associated with different builds of Fenix, each corresponding to different datasets in BigQuery, and the mapping of appId to logical app names (Firefox vs. Firefox Preview) and channel names (nightly, beta, or release) has changed over time; see the spreadsheet of naming history for Mozilla's mobile browsers .> This function is intended as the source of truth for how to map a specific ping in BigQuery to a logical app names and channel. It should be expected that the output of this function may evolve over time. If we rename a product or channel, we may choose to update the values here so that analyses consistently get the new name. The first argument ( app_id ) can be fairly fuzzy; it is tolerant of actual Google Play Store appId values like 'org.mozilla.firefox_beta' (mix of periods and underscores) as well as BigQuery dataset names with suffixes like 'org_mozilla_firefox_beta_stable'. The second argument ( app_build_id ) should be the value in client_info.app_build. The function returns a STRUCT that contains the logical app_name and channel as well as the Play Store app_id in the canonical form which would appear in Play Store URLs. Note that the naming of Fenix applications changed on 2020-07-03, so to get a continuous view of the pings associated with a logical app channel, you may need to union together tables from multiple BigQuery datasets. To see data for all Fenix channels together, it is necessary to union together tables from all 5 datasets. For basic usage information, consider using telemetry.fenix_clients_last_seen which already handles the union. Otherwise, see the example below as a template for how construct a custom union. Mapping of channels to datasets: release: org_mozilla_firefox beta: org_mozilla_firefox_beta (current) and org_mozilla_fenix nightly: org_mozilla_fenix (current), org_mozilla_fennec_aurora , and org_mozilla_fenix_nightly -- Example of a query over all Fenix builds advertised as \"Firefox Beta\" CREATE TEMP FUNCTION extract_fields(app_id STRING, m ANY TYPE) AS ( ( SELECT AS STRUCT m.submission_timestamp, m.metrics.string.geckoview_version, mozfun.norm.fenix_app_info(app_id, m.client_info.app_build).* ) ); WITH base AS ( SELECT extract_fields('org_mozilla_firefox_beta', m).* FROM org_mozilla_firefox_beta.metrics AS m UNION ALL SELECT extract_fields('org_mozilla_fenix', m).* FROM org_mozilla_fenix.metrics AS m ) SELECT DATE(submission_timestamp) AS submission_date, geckoview_version, COUNT(*) FROM base WHERE app_name = 'Fenix' -- excludes 'Firefox Preview' AND channel = 'beta' AND DATE(submission_timestamp) = '2020-08-01' GROUP BY submission_date, geckoview_version Source | Edit","title":"fenix_app_info (UDF)"},{"location":"mozfun/stats/","text":"stats Statistics functions. mode_last_retain_nulls (UDF) Returns the most frequently occuring element in an array. In the case of multiple values tied for the highest count, it returns the value that appears latest in the array. Nulls are retained. See also: `stats.mode_last, which ignores nulls. Source | Edit mode_last (UDF) Returns the most frequently occuring element in an array. In the case of multiple values tied for the highest count, it returns the value that appears latest in the array. Nulls are ignored. See also: stats.mode_last_retain_nulls , which retains nulls. Source | Edit","title":"stats"},{"location":"mozfun/stats/#stats","text":"Statistics functions.","title":"stats"},{"location":"mozfun/stats/#mode_last_retain_nulls-udf","text":"Returns the most frequently occuring element in an array. In the case of multiple values tied for the highest count, it returns the value that appears latest in the array. Nulls are retained. See also: `stats.mode_last, which ignores nulls. Source | Edit","title":"mode_last_retain_nulls (UDF)"},{"location":"mozfun/stats/#mode_last-udf","text":"Returns the most frequently occuring element in an array. In the case of multiple values tied for the highest count, it returns the value that appears latest in the array. Nulls are ignored. See also: stats.mode_last_retain_nulls , which retains nulls. Source | Edit","title":"mode_last (UDF)"}]}